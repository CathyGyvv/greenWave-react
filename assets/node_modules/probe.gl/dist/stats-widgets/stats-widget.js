'use strict';var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}var TEXT_SIZE=10,TEXT_START=[7,37],TEXT_SPACING=6,HEADER_SIZE=20,BOTTOM_SPACING=20,HEADER_POS=[3,3],BG='#000',FG='#ccc',WIDTH=160,HEIGHT=function(items){return items.length*TEXT_SIZE+(items.length-1)*TEXT_SPACING+TEXT_START[1]+BOTTOM_SPACING},StatsWidget=function(){function StatsWidget(items){_classCallCheck(this,StatsWidget);for(var prevGpuTimes=[],_i=0;_i<items.length;_i++)prevGpuTimes[_i]=0;var totalFrameTime=[],avgFrameTime=[];for(i=0;i<items.length;++i)totalFrameTime[i]=0,avgFrameTime[i]=0}var _Mathround=Math.round;return _createClass(StatsWidget,[{key:'update',value:function update(deltaTime){for(totalTime+=deltaTime,1<totalTime&&(totalTime=0,_clearTextArea()),frameTimeCount++,i=0;i<drawCalls.length;i++)drawCall=drawCalls[i],frameTime=drawCall[0].stats.gpuTime-prevGpuTimes[i],totalFrameTime[i]+=frameTime,frameTimeCount===N&&(avgFrameTime[i]=totalFrameTime[i]/N,totalFrameTime[i]=0),prevGpuTimes[i]=drawCall[0].stats.gpuTime;frameTimeCount===N&&(frameTimeCount=0)}},{key:'_createDOM',value:function _createDOM(){var pr=_Mathround(window.devicePixelRatio||1),container=document.createElement('div');container.style.cssText='position:fixed;top:20px;left:20px;opacity:0.8;z-index:10000;';var canvas=document.createElement('canvas'),context=canvas.getContext('2d');canvas.width=WIDTH*pr,canvas.height=HEIGHT*pr,canvas.style.cssText='width: '+WIDTH+'px;height: '+HEIGHT+'px',context.fillStyle=BG,context.fillRect(0,0,WIDTH*pr,HEIGHT*pr),container.appendChild(canvas),document.body.appendChild(container),this.context=context}},{key:'_drawHeader',value:function _drawHeader(context){var pr=_Mathround(window.devicePixelRatio||1);context.font='bold '+HEADER_SIZE*pr+'px Helvetica,Arial,sans-serif',context.textBaseline='top',context.fillStyle=FG,context.fillText('Stats',HEADER_POS[0]*pr,HEADER_POS[1]*pr)}},{key:'_clearTextArea',value:function _clearTextArea(context){var pr=_Mathround(window.devicePixelRatio||1);context.fillStyle=BG,context.fillRect(TEXT_START[0]*pr,TEXT_START[1]*pr,(WIDTH-TEXT_START[0])*pr,(HEIGHT-TEXT_START[1])*pr),context.font='bold '+TEXT_SIZE*pr+'px Helvetica,Arial,sans-serif',context.fillStyle=FG}},{key:'_drawTextItem',value:function _drawTextItem(context,i){var pr=_Mathround(window.devicePixelRatio||1),textCursor=[TEXT_START[0],TEXT_START[1]],str=drawCall[1]+' : '+_Mathround(100*avgFrameTime[i])/100+'ms';context.fillText(str,textCursor[0]*pr,textCursor[1]*pr),textCursor[1]+=TEXT_SIZE+TEXT_SPACING}}]),StatsWidget}();
//# sourceMappingURL=stats-widget.js.map