{"version":3,"sources":["../../src/lib/log.js"],"names":["originalConsole","debug","isBrowser","console","log","info","warn","error","DEFAULT_SETTINGS","enabled","priority","noop","cache","getTableHeader","table","key","title","Log","id","VERSION","_startTs","_deltaTs","LOG_THROTTLE_TIMEOUT","_storage","LocalStorage","userData","timeStamp","Object","seal","config","toPrecision","updateConfiguration","level","message","args","_getLogFunction","method","once","oldUsage","newUsage","time","columns","tag","image","scale","getPriority","_logImageInBrowser","_logImageInNode","asciify","module","require","fit","width","Math","round","then","data","img","Image","onload","src","element","nodeName","toLowerCase","toDataURL","timeEnd","opts","collapsed","_normalizeArguments","groupCollapsed","group","assign","groupEnd","func","trace","_normalizePriority","isEnabled","total","getTotal","delta","getDelta","_shouldLog","_parseArguments","_decorateMessage","bind","options","normOpts","_getElapsedTime","resolvedPriority","Number","isFinite","newOpts","unshift","color","background","newPriority"],"mappings":"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","file":"log.js","sourcesContent":["// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/* eslint-disable no-console, no-try-catch */\n/* global console */\nimport {VERSION} from './utils/globals';\nimport LocalStorage from './utils/local-storage';\nimport {getTimestamp} from './utils/timestamp';\nimport {formatImage, formatTime, leftPad} from './utils/formatters';\nimport {addColor} from './utils/color';\nimport {autobind} from './utils/autobind';\nimport {isBrowser} from './utils/globals';\nimport assert from '../lib/utils/assert';\n\n/* eslint-disable no-console */\n/* global console, Image */\n\n// Instrumentation in other packages may override console methods, so preserve them here\nconst originalConsole = {\n  debug: isBrowser ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\n\nconst DEFAULT_SETTINGS = {\n  enabled: false,\n  priority: 0\n};\n\nfunction noop() {}\n\nconst cache = {};\n\n/*\nfunction throttle(tag, timeout) {\n  const prevTime = cache[tag];\n  const time = Date.now();\n  if (!prevTime || (time - prevTime > timeout)) {\n    cache[tag] = time;\n    return true;\n  }\n  return false;\n}\n\n// Assertions don't generate standard exceptions and don't print nicely\nfunction checkForAssertionErrors(args) {\n  const isAssertion =\n    args &&\n    args.length > 0 &&\n    typeof args[0] === 'object' &&\n    args[0] !== null &&\n    args[0].name === 'AssertionError';\n\n  if (isAssertion) {\n    args = Array.prototype.slice.call(args);\n    args.unshift(`assert(${args[0].message})`);\n  }\n  return args;\n}\n*/\n\nfunction getTableHeader(table) {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n  return 'empty';\n}\n\n// A console wrapper\n\nexport default class Log {\n\n  constructor({id} = {}) {\n    this.id = id;\n    this.VERSION = VERSION;\n    this._startTs = getTimestamp();\n    this._deltaTs = getTimestamp();\n    // TODO - fix support from throttling groups\n    this.LOG_THROTTLE_TIMEOUT = 0; // Time before throttled messages are logged again\n    this._storage = new LocalStorage(`__probe-${this.id}__`, DEFAULT_SETTINGS);\n    this.userData = {};\n\n    this.timeStamp(`${this.id} started`);\n\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set priority(newPriority) {\n    this._storage.updateConfiguration({priority: newPriority});\n    return this;\n  }\n\n  get priority() {\n    return this._storage.config.priority;\n  }\n\n  isEnabled() {\n    return this._storage.config.enabled;\n  }\n\n  getPriority() {\n    return this._storage.config.priority;\n  }\n\n  getLevel() {\n    return this._storage.config.priority;\n  }\n\n  // @return {Number} milliseconds, with fractions\n  getTotal() {\n    return Number((getTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  // @return {Number} milliseconds, with fractions\n  getDelta() {\n    return Number((getTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  // Configure\n\n  enable(enabled = true) {\n    this._storage.updateConfiguration({enabled});\n    return this;\n  }\n\n  setLevel(level) {\n    this._storage.updateConfiguration({priority: level});\n    return this;\n  }\n\n  // Unconditional logging\n\n  // Warn, but only once, no console flooding\n  warn(message, ...args) {\n    return this._getLogFunction({\n      message,\n      args,\n      method: originalConsole.warn,\n      once: true\n    });\n  }\n\n  // Print an error\n  error(message, ...args) {\n    return this._getLogFunction({message, args, method: originalConsole.error});\n  }\n\n  deprecated(oldUsage, newUsage) {\n    return this.warn(`\\`${oldUsage}\\` is deprecated and will be removed \\\nin a later version. Use \\`${newUsage}\\` instead`);\n  }\n\n  removed(oldUsage, newUsage) {\n    return this.error(`\\`${oldUsage}\\` has been removed. Use \\`${newUsage}\\` instead`);\n  }\n\n  // Conditional logging\n\n  // Log to a group\n  probe(priority, message, ...args) {\n    return this._getLogFunction({\n      priority,\n      message,\n      args,\n      method: originalConsole.log,\n      time: true,\n      once: true\n    });\n  }\n\n  // Log a debug message\n  log(priority, message, ...args) {\n    return this._getLogFunction({\n      priority,\n      message,\n      args,\n      method: originalConsole.debug\n    });\n  }\n\n  // Log a normal message\n  info(priority, message, ...args) {\n    return this._getLogFunction({\n      priority, message, args,\n      method: console.info\n    });\n  }\n\n  // Log a normal message, but only once, no console flooding\n  once(priority, message, ...args) {\n    return this._getLogFunction({\n      priority,\n      message,\n      args,\n      method: originalConsole.debug || originalConsole.info,\n      once: true\n    });\n  }\n\n  // Logs an object as a table\n  table(priority, table, columns) {\n    if (table) {\n      const tag = getTableHeader(table);\n      return this._getLogFunction({\n        priority,\n        message: table,\n        args: columns && [columns],\n        tag,\n        method: console.table || noop\n      });\n    }\n    return noop;\n  }\n\n  // logs an image under Chrome\n  image({priority, image, message = '', scale = 1}) {\n    if (priority > this.getPriority()) {\n      return noop;\n    }\n    return isBrowser ?\n      this._logImageInBrowser({image, message, scale}) :\n      this._logImageInNode({image, message, scale});\n  }\n\n  // Use the asciify module to log an image under node.js\n  _logImageInNode({image, message = '', scale = 1}) {\n    // Note: Runtime load of the \"asciify-image\" module, avoids including in browser bundles\n    let asciify = null;\n    try {\n      asciify = module.require('asciify-image');\n    } catch (error) {\n      // asciify not installed, silently ignore\n    }\n    if (asciify) {\n      return () =>\n        asciify(image, {fit: 'box', width: `${Math.round(80 * scale)}%`})\n        .then(data => console.log(data));\n    }\n    return noop;\n  }\n\n  _logImageInBrowser({image, message = '', scale = 1}) {\n    if (typeof image === 'string') {\n      const img = new Image();\n      img.onload = () => {\n        const args = formatImage(img, message, scale);\n        console.log(...args);\n      };\n      img.src = image;\n      return noop;\n    }\n    const element = image.nodeName || '';\n    if (element.toLowerCase() === 'img') {\n      console.log(...formatImage(image, message, scale));\n      return noop;\n    }\n    if (element.toLowerCase() === 'canvas') {\n      const img = new Image();\n      img.onload = () => console.log(...formatImage(img, message, scale));\n      img.src = image.toDataURL();\n      return noop;\n    }\n    return noop;\n  }\n\n  time(priority, message) {\n    return this._getLogFunction({\n      priority,\n      message,\n      method: console.time ? console.time : console.info\n    });\n  }\n\n  timeEnd(priority, message) {\n    return this._getLogFunction({\n      priority,\n      message,\n      method: console.timeEnd ? console.timeEnd : console.info\n    });\n  }\n\n  timeStamp(priority, message) {\n    return this._getLogFunction({\n      priority,\n      message,\n      method: console.timeStamp || noop\n    });\n  }\n\n  group(priority, message, opts = {collapsed: false}) {\n    opts = this._normalizeArguments({priority, message, opts});\n    const {collapsed} = opts;\n    return this._getLogFunction({\n      priority,\n      message,\n      opts,\n      method: (collapsed ? console.groupCollapsed : console.group) || console.info\n    });\n  }\n\n  groupCollapsed(priority, message, opts = {}) {\n    return this.group(priority, message, Object.assign({}, opts, {collapsed: true}));\n  }\n\n  groupEnd(priority) {\n    return this._getLogFunction({\n      priority,\n      message: '',\n      method: console.groupEnd || noop\n    });\n  }\n\n  // EXPERIMENTAL\n\n  withGroup(priority, message, func) {\n    const opts = this._normalizeArguments({\n      priority,\n      message\n    });\n\n    this.group(opts);\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(opts.message);\n    }\n  }\n\n  trace() {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  // PRIVATE METHODS\n\n  _shouldLog(priority) {\n    priority = this._normalizePriority(priority);\n    return priority === 0 || (this.isEnabled() && this.getPriority() >= priority);\n  }\n\n  _getElapsedTime() {\n    const total = this.getTotal();\n    const delta = this.getDelta();\n    // reset delta timer\n    this._deltaTs = getTimestamp();\n    return {total, delta};\n  }\n\n  _getLogFunction(opts) {\n    if (this._shouldLog(opts.priority)) {\n      const {method} = opts;\n\n      opts = this._parseArguments(opts);\n\n      assert(method);\n\n      let {message} = opts;\n      const tag = opts.tag || opts.message;\n\n      if (opts.once) {\n        if (!cache[tag]) {\n          cache[tag] = getTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      // TODO - Make throttling work with groups\n      // if (opts.nothrottle || !throttle(tag, this.LOG_THROTTLE_TIMEOUT)) {\n      //   return noop;\n      // }\n\n      message = this._decorateMessage(message, opts);\n\n      // Bind console function so that it can be called after being returned\n      return method.bind(console, message, ...opts.args);\n    }\n\n    return noop;\n  }\n\n  _parseArguments(options) {\n    const normOpts = this._normalizeArguments(options);\n\n    const {delta, total} = this._getElapsedTime();\n\n    // normalized opts + timings\n    return Object.assign(options, normOpts, {\n      delta,\n      total\n    });\n  }\n\n  // Get priority from first argument:\n  // - log(priority, message, args) => priority\n  // - log(message, args) => 0\n  // - log({priority, ...}, message, args) => priority\n  // - log({priority, message, args}) => priority\n  _normalizePriority(priority) {\n    let resolvedPriority;\n\n    switch (typeof priority) {\n    case 'number':\n      resolvedPriority = priority;\n      break;\n\n    case 'object':\n      resolvedPriority = priority.priority || 0;\n      break;\n\n    default:\n      resolvedPriority = 0;\n    }\n    // 'log priority must be a number'\n    assert(Number.isFinite(resolvedPriority) && resolvedPriority >= 0);\n\n    return resolvedPriority;\n  }\n\n  // \"Normalizes\" the various argument patterns into an object with known types\n  // - log(priority, message, args) => {priority, message, args}\n  // - log(message, args) => {priority: 0, message, args}\n  // - log({priority, ...}, message, args) => {priority, message, args}\n  // - log({priority, message, args}) => {priority, message, args}\n  _normalizeArguments({priority, message, args = [], opts}) {\n    const newOpts = {\n      priority: this._normalizePriority(priority),\n      message,\n      args\n    };\n\n    switch (typeof priority) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n      Object.assign(newOpts, {message: priority});\n      break;\n\n    case 'object':\n      Object.assign(newOpts, priority);\n      break;\n\n    default:\n    }\n\n    // Resolve functions into strings by calling them\n    if (typeof newOpts.message === 'function') {\n      newOpts.message = this._shouldLog(newOpts.priority) ? newOpts.message() : '';\n    }\n    // 'log message must be a string' or object\n    assert(typeof newOpts.message === 'string' || typeof newOpts.message === 'object');\n\n    // original opts + normalized opts + opts arg + fixed up message\n    return Object.assign(newOpts, opts);\n  }\n\n  _decorateMessage(message, opts) {\n    if (typeof message === 'string') {\n      let time = '';\n      if (opts.time) {\n        const {total} = this._getElapsedTime();\n        time = leftPad(formatTime(total));\n      }\n      message = opts.time ? `${this.id}: ${time}  ${message}` : `${this.id}: ${message}`;\n      message = addColor(message, opts.color, opts.background);\n    }\n    return message;\n  }\n}\n\nLog.VERSION = VERSION;\n"]}