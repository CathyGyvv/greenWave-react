!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("leaflet"),require("lodash"),require("isomorphic-fetch"),require("d3")):"function"==typeof define&&define.amd?define(["leaflet","lodash","isomorphic-fetch","d3"],e):"object"==typeof exports?exports.geoengine=e(require("leaflet"),require("lodash"),require("isomorphic-fetch"),require("d3")):t.geoengine=e(t.L,t._,t.fetch,t.d3)}(this,function(__WEBPACK_EXTERNAL_MODULE_1__,__WEBPACK_EXTERNAL_MODULE_3__,__WEBPACK_EXTERNAL_MODULE_6__,__WEBPACK_EXTERNAL_MODULE_45__){return function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=38)}([function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){var i=e.domain,r=e.range;if(!M.default.isArray(r)||0===r.length)throw Error("range must be an not empty array");if(void 0==i||0===i.length)return r[0];if(!M.default.isArray(i))throw Error("domain must be an array or void 0");var n=Math.min(i.length,r.length);if(isNaN(t))return r[0];for(var o=0,s=0;n-1>s&&i[s]<t;s++)o=s+1;return r[o]}function o(t,e){return L.point(t.x,t.y).add(e)}function s(t,e){if(void 0==e)throw Error("scaleOpts cannot be empty");return M.default.isObject(e)?n(t,e):e}function a(t,e,i){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=[],s=void 0,a=0,c=t.geometry.coordinates.length;c>a;a++){var l=t.geometry.coordinates[a],u=i.latLngToContainerPoint([l[1],l[0]]),h=u;s||e.contains([h.x,h.y])&&(s=!0),r&&(h=o(h,r));var f=n[n.length-1]||{};f.x===h.x&&f.y===h.y||n.push(h)}return 1===n.length&&n.push({x:n[0].x+.1,y:n[0].y+.1}),s?n:null}function c(t,i,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],s=void 0,a=0,c=t.geometry.coordinates.length;c>a;a++){var l=t.geometry.coordinates[a],u=e.lineToPixels({geometry:{coordinates:l}},i,r,n);if(u&&(u.forEach(function(t){o.push(t)}),!s))for(var h=0,f=u.length;f>h;++h)if(i.contains(u[h])){s=!0;break}}return 1===o.length&&o.push({x:o[0].x+.1,y:o[0].y+.1}),s?o:null}function l(t){return(0,I.default)(t.join("_"))}function u(t,e,i){return i.containerPointToLatLng(L.point(t,e))}function h(t){var e=(0,R.getCoords)(t),i=e.reduce(function(t,e){return t.concat(e)});return i[0][0]===i[i.length-1][0]&&i[0][1]===i[i.length-1][1]||i.push(i[0]),[i]}function f(t){if("object"!==(void 0===t?"undefined":P(t)))return(0,I.default)(t);if(Array.isArray(t))return l(t);var e=[],i=!0,r=!1,n=void 0;try{for(var o,s=Object.keys(t).sort()[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value;e.push(a+"_"+t[a])}}catch(t){r=!0,n=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw n}}return l(e)}function d(t,e,i){return t.split(".").reduce(function(t,e){return t&&null!=t[e]?t[e]:i||null},e)}function p(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=t.geometry.coordinates,s=i.latLngToContainerPoint([n[1],n[0]]),a=s;return e.contains(a)?(r&&(a=o(s,r)),a):null}function g(t,e,i,r){var n=r.latLngToContainerPoint([0,0]);return t=Math.abs(r.latLngToContainerPoint([0,t]).x-n.x),e=Math.abs(r.latLngToContainerPoint([e,0]).y-n.y),{width:i>t?i:t,height:i>e?i:e}}function v(t,e){var i=t.toBounds(2*e);return[(i._southWest.lat+i._northEast.lat)/2,i._northEast.lng]}function y(t,e){var i=t.toBounds(2*e);return[i._southWest.lat,(i._southWest.lng+i._northEast.lng)/2]}function m(t,e,i,r){var n=r.latLngToContainerPoint([0,0]),o=v(L.latLng([0,0]),t),s=y(L.latLng([0,0]),e);return t=Math.abs(r.latLngToContainerPoint(o).x-n.x),e=Math.abs(r.latLngToContainerPoint(s).y-n.y),{width:i>t?i:t,height:i>e?i:e}}function b(t){return 40075016.686*Math.abs(Math.cos(180*t.getCenter().lat/Math.PI))/Math.pow(2,t.getZoom()+8)}function _(t){var e=t.latLngToContainerPoint([0,0]);return t.latLngToContainerPoint([1,1]).x-e.x}function x(t,e,i){for(var r=0,n=i.length;n>r;r++){var o=i[r];if(t[o]&&!M.default.isEqual(t[o],e[o]))return!0}return!1}function w(t,e,i){if(e>i){var r=i;i=e,e=r}return t>=e&&i>=t}function C(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function O(t,e,i){return t+i*(e-t)}function T(t,e,i,r){var n=e.x-t.x,o=e.y-t.y,s=((i-t.x)*n+(r-t.y)*o)/(n*n+o*o);return{x:O(t.x,e.x,s),y:O(t.y,e.y,s)}}function S(t,e,i,r){for(var n=r/2,o={x:t,y:e},s=0,a=i.length;a-1>s;s++){var c=i[s],l=i[s+1];if(c.x!==l.x){if(c.y!==l.y){if(w(t,c.x,l.x)){var u=T(c,l,t,e),h=C(u,o);if(n>=h)return!0}}else if(w(e,c.y+n,c.y-n)&&w(t,c.x,l.x))return!0}else if(w(t,c.x+n,c.x-n)&&w(e,c.y,l.y))return!0}return!1}function j(t){return t.features.map(function(t){if(t.geometry&&"point"===t.geometry.type.toLowerCase()){var e=A(t.geometry.coordinates,2),i=e[0],r=e[1];return k({},t.properties||{},{position:[r,i]})}return null}).filter(function(t){return null!==t})}Object.defineProperty(e,"__esModule",{value:!0});var k=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},A=function(){function t(t,e){var i=[],r=!0,n=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){n=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(n)throw o}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.getScale=s,e.lineToPixels=a,e.polygonToPixels=c,e.pixelToPoint=u,e.getPolygonCoords=h,e.getKey=f,e.getValueByKeys=d,e.pointToPixel=p,e.arcToPixel=g,e.meterToPixel=m,e.meterPerPixel=b,e.arcPerPixel=_,e.isAnyRenderOptionsChange=x,e.between=w,e.distance=C,e.isPointOnLine=S,e.geoJsonToMarkerList=j;var E=i(3),M=r(E),D=i(41),I=r(D);i(1);var R=i(11);e.default={getScale:s,polygonToPixels:c,lineToPixels:a,pointToPixel:p,arcToPixel:g,isAnyRenderOptionsChange:x,isPointOnLine:S,distance:C,between:w,pixelToPoint:u,getPolygonCoords:h}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fabric=fabric||{version:"1.5.0"};exports.fabric=fabric,"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window,window.fabric=fabric):(fabric.document=__webpack_require__(!function(){var t=Error('Cannot find module "jsdom"');throw t.code="MODULE_NOT_FOUND",t}()).jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.window=fabric.document.createWindow?fabric.document.createWindow():fabric.document.parentWindow),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode=!1,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)","object"!==("undefined"==typeof JSON?"undefined":_typeof(JSON))&&(JSON={}),function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var i,r,n,o,s,a=gap,c=e[t];switch(c&&"object"===(void 0===c?"undefined":_typeof(c))&&"function"==typeof c.toJSON&&(c=c.toJSON(t)),"function"==typeof rep&&(c=rep.call(e,t,c)),void 0===c?"undefined":_typeof(c)){case"string":return quote(c);case"number":return isFinite(c)?c+"":"null";case"boolean":case"null":return c+"";case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(o=c.length,i=0;o>i;i+=1)s[i]=str(i,c)||"null";return n=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,n}if(rep&&"object"===(void 0===rep?"undefined":_typeof(rep)))for(o=rep.length,i=0;o>i;i+=1)"string"==typeof rep[i]&&(r=rep[i],(n=str(r,c))&&s.push(quote(r)+(gap?": ":":")+n));else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(n=str(r,c))&&s.push(quote(r)+(gap?": ":":")+n);return n=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,n}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,i){var r;if(gap="",indent="","number"==typeof i)for(r=0;i>r;r+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=e,e&&"function"!=typeof e&&("object"!==(void 0===e?"undefined":_typeof(e))||"number"!=typeof e.length))throw Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(t,e){var i,r,n=t[e];if(n&&"object"===(void 0===n?"undefined":_typeof(n)))for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r=walk(n,i),void 0!==r?n[i]=r:delete n[i]);return reviver.call(t,e,n)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){function t(t,e){this.__eventListeners[t]&&(e?fabric.util.removeFromArray(this.__eventListeners[t],e):this.__eventListeners[t].length=0)}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"===_typeof(arguments[0]))for(var r in e)t.call(this,r,e[r]);else t.call(this,e,i);return this}}function r(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var r=0,n=i.length;n>r;r++)i[r].call(this,e||{});return this}}}fabric.Observable={observe:e,stopObserving:i,fire:r,on:e,off:i,trigger:r}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var t=0,e=arguments.length;e>t;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(t,e,i){var r=this.getObjects();return i?r[e]=t:r.splice(e,0,t),this._onObjectAdded(t),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=0,r=arguments.length;r>i;i++)-1!==(t=e.indexOf(arguments[i]))&&(e.splice(t,1),this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),r=i.length;r--;)t.call(e,i[r],r,i);return this},getObjects:function(t){return void 0===t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){var e=Math.sqrt,i=Math.atan2,r=Math.PI/180;fabric.util={removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*r},radiansToDegrees:function(t){return t/r},rotatePoint:function(t,e,i){var r=Math.sin(i),n=Math.cos(i);return t.subtractEquals(e),new fabric.Point(t.x*n-t.y*r,t.x*r+t.y*n).addEquals(e)},transformPoint:function(t,e,i){return i?new fabric.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new fabric.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},invertTransform:function(t){var e=t.slice(),i=1/(t[0]*t[3]-t[1]*t[2]);e=[i*t[3],-i*t[1],-i*t[2],i*t[0],0,0];var r=fabric.util.transformPoint({x:t[4],y:t[5]},e);return e[4]=-r.x,e[5]=-r.y,e},toFixed:function(t,e){return parseFloat((+t).toFixed(e))},parseUnit:function(t,e){var i=/\D{0,2}$/.exec(t),r=parseFloat(t);switch(e||(e=fabric.Text.DEFAULT_SVG_FONT_SIZE),i[0]){case"mm":return r*fabric.DPI/25.4;case"cm":return r*fabric.DPI/2.54;case"in":return r*fabric.DPI;case"pt":return r*fabric.DPI/72;case"pc":return r*fabric.DPI/72*12;case"em":return r*e;default:return r}},falseFunction:function(){return!1},getKlass:function(t,e){return t=fabric.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),fabric.util.resolveNamespace(e)[t]},resolveNamespace:function(e){if(!e)return fabric;for(var i=e.split("."),r=i.length,n=t||fabric.window,o=0;r>o;++o)n=n[i[o]];return n},loadImage:function(t,e,i,r){if(!t)return void(e&&e.call(i,t));var n=fabric.util.createImage();n.onload=function(){e&&e.call(i,n),n=n.onload=n.onerror=null},n.onerror=function(){fabric.log("Error loading "+n.src),e&&e.call(i,null,!0),n=n.onload=n.onerror=null},0!==t.indexOf("data")&&void 0!==r&&(n.crossOrigin=r),n.src=t},enlivenObjects:function(t,e,i,r){function n(){++s===a&&e&&e(o)}t=t||[];var o=[],s=0,a=t.length;if(!a)return void(e&&e(o));t.forEach(function(t,e){if(!t||!t.type)return void n();var s=fabric.util.getKlass(t.type,i);s.async?s.fromObject(t,function(i,s){s||(o[e]=i,r&&r(t,o[e])),n()}):(o[e]=s.fromObject(t),r&&r(t,o[e]),n())})},groupSVGElements:function(t,e,i){var r;return r=new fabric.PathGroup(t,e),void 0!==i&&r.setSourcePath(i),r},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var r=0,n=i.length;n>r;r++)i[r]in t&&(e[i[r]]=t[i[r]])},drawDashedLine:function(t,r,n,o,s,a){var c=o-r,l=s-n,u=e(c*c+l*l),h=i(l,c),f=a.length,d=0,p=!0;for(t.save(),t.translate(r,n),t.moveTo(0,0),t.rotate(h),r=0;u>r;)r+=a[d++%f],r>u&&(r=u),t[p?"lineTo":"moveTo"](r,0),p=!p;t.restore()},createCanvasElement:function(t){return t||(t=fabric.document.createElement("canvas")),t.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(t),t},createImage:function(){return fabric.isLikelyNode?new(__webpack_require__(!function(){var t=Error('Cannot find module "canvas"');throw t.code="MODULE_NOT_FOUND",t}()).Image):fabric.document.createElement("img")},createAccessors:function(t){for(var e=t.prototype,i=e.stateProperties.length;i--;){var r=e.stateProperties[i],n=r.charAt(0).toUpperCase()+r.slice(1),o="set"+n,s="get"+n;e[s]||(e[s]=function(t){return Function('return this.get("'+t+'")')}(r)),e[o]||(e[o]=function(t){return Function("value",'return this.set("'+t+'", value)')}(r))}},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},getFunctionBody:function(t){return((t+"").match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,r){r>0&&(e>r?e-=r:e=0,i>r?i-=r:i=0);for(var n=!0,o=t.getImageData(e,i,2*r||1,2*r||1),s=3,a=o.data.length;a>s;s+=4){if(!1===(n=0>=o.data[s]))break}return o=null,n}}}(exports),function(){function t(t,r,o,s,c,l,u){var h=a.call(arguments);if(n[h])return n[h];var f=Math.PI,d=u*f/180,p=Math.sin(d),g=Math.cos(d),v=0,y=0;o=Math.abs(o),s=Math.abs(s);var m=-g*t*.5-p*r*.5,b=-g*r*.5+p*t*.5,_=o*o,x=s*s,w=b*b,C=m*m,O=_*x-_*w-x*C,T=0;if(0>O){var S=Math.sqrt(1-O/(_*x));o*=S,s*=S}else T=(c===l?-1:1)*Math.sqrt(O/(_*w+x*C));var j=T*o*b/s,k=-T*s*m/o,A=g*j-p*k+.5*t,P=p*j+g*k+.5*r,E=i(1,0,(m-j)/o,(b-k)/s),L=i((m-j)/o,(b-k)/s,(-m-j)/o,(-b-k)/s);0===l&&L>0?L-=2*f:1===l&&0>L&&(L+=2*f);for(var M=Math.ceil(Math.abs(L/f*2)),D=[],I=L/M,R=8/3*Math.sin(I/4)*Math.sin(I/4)/Math.sin(I/2),B=E+I,F=0;M>F;F++)D[F]=e(E,B,g,p,o,s,A,P,R,v,y),v=D[F][4],y=D[F][5],E=B,B+=I;return n[h]=D,D}function e(t,e,i,r,n,s,c,l,u,h,f){var d=a.call(arguments);if(o[d])return o[d];var p=Math.cos(t),g=Math.sin(t),v=Math.cos(e),y=Math.sin(e),m=i*n*v-r*s*y+c,b=r*n*v+i*s*y+l;return o[d]=[h+u*(-i*n*g-r*s*p),f+u*(-r*n*g+i*s*p),m+u*(i*n*y+r*s*v),b+u*(r*n*y-i*s*v),m,b]}function i(t,e,i,r){var n=Math.atan2(e,t),o=Math.atan2(r,i);return n>o?2*Math.PI-(n-o):o-n}function r(t,e,i,r,n,o,c,l){var u=a.call(arguments);if(s[u])return s[u];var h,f,d,p,g,v,y,m,b=Math.sqrt,_=Math.min,x=Math.max,w=Math.abs,C=[],O=[[],[]];f=6*t-12*i+6*n,h=-3*t+9*i-9*n+3*c,d=3*i-3*t;for(var T=0;2>T;++T)if(T>0&&(f=6*e-12*r+6*o,h=-3*e+9*r-9*o+3*l,d=3*r-3*e),1e-12>w(h)){if(1e-12>w(f))continue;(p=-d/f)>0&&1>p&&C.push(p)}else 0>(y=f*f-4*d*h)||(m=b(y),g=(-f+m)/(2*h),g>0&&1>g&&C.push(g),(v=(-f-m)/(2*h))>0&&1>v&&C.push(v));for(var S,j,k,A=C.length,P=A;A--;)p=C[A],k=1-p,S=k*k*k*t+3*k*k*p*i+3*k*p*p*n+p*p*p*c,O[0][A]=S,j=k*k*k*e+3*k*k*p*r+3*k*p*p*o+p*p*p*l,O[1][A]=j;O[0][P]=t,O[1][P]=e,O[0][P+1]=c,O[1][P+1]=l;var E=[{x:_.apply(null,O[0]),y:_.apply(null,O[1])},{x:x.apply(null,O[0]),y:x.apply(null,O[1])}];return s[u]=E,E}var n={},o={},s={},a=Array.prototype.join;fabric.util.drawArc=function(e,i,r,n){for(var o=n[0],s=n[1],a=n[2],c=n[3],l=n[4],u=n[5],h=n[6],f=[[],[],[],[]],d=t(u-i,h-r,o,s,c,l,a),p=0,g=d.length;g>p;p++)f[p][0]=d[p][0]+i,f[p][1]=d[p][1]+r,f[p][2]=d[p][2]+i,f[p][3]=d[p][3]+r,f[p][4]=d[p][4]+i,f[p][5]=d[p][5]+r,e.bezierCurveTo.apply(e,f[p])},fabric.util.getBoundsOfArc=function(e,i,n,o,s,a,c,l,u){for(var h=0,f=0,d=[],p=[],g=t(l-e,u-i,n,o,a,c,s),v=[[],[]],y=0,m=g.length;m>y;y++)d=r(h,f,g[y][0],g[y][1],g[y][2],g[y][3],g[y][4],g[y][5]),v[0].x=d[0].x+e,v[0].y=d[0].y+i,v[1].x=d[1].x+e,v[1].y=d[1].y+i,p.push(v[0]),p.push(v[1]),h=g[y][4],f=g[y][5];return p},fabric.util.getBoundsOfCurve=r}(),function(){function t(t,e){for(var i=n.call(arguments,2),r=[],o=0,s=t.length;s>o;o++)r[o]=i.length?t[o][e].apply(t[o],i):t[o][e].call(t[o]);return r}function e(t,e){return r(t,e,function(t,e){return t>=e})}function i(t,e){return r(t,e,function(t,e){return e>t})}function r(t,e,i){if(t&&0!==t.length){var r=t.length-1,n=e?t[r][e]:t[r];if(e)for(;r--;)i(t[r][e],n)&&(n=t[r][e]);else for(;r--;)i(t[r],n)&&(n=t[r]);return n}}var n=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var r=0;if(arguments.length>0&&(r=+arguments[1],r!==r?r=0:0!==r&&r!==Number.POSITIVE_INFINITY&&r!==Number.NEGATIVE_INFINITY&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=i)return-1;for(var n=0>r?Math.max(i-Math.abs(r),0):r;i>n;n++)if(n in e&&e[n]===t)return n;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){for(var i=[],r=0,n=this.length>>>0;n>r;r++)r in this&&(i[r]=t.call(e,this[r],r,this));return i}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){for(var i=0,r=this.length>>>0;r>i;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var i,r=[],n=0,o=this.length>>>0;o>n;n++)n in this&&(i=this[n],t.call(e,i,n,this)&&r.push(i));return r}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e,i=this.length>>>0,r=0;if(arguments.length>1)e=arguments[1];else for(;;){if(r in this){e=this[r++];break}if(++r>=i)throw new TypeError}for(;i>r;r++)r in this&&(e=t.call(null,e,this[r],r,this));return e}),fabric.util.array={invoke:t,min:i,max:e}}(),function(){function t(t,e){for(var i in e)t[i]=e[i];return t}function e(e){return t({},e)}fabric.util.object={extend:t,clone:e}}(),function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function i(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:t,capitalize:e,escapeXml:i}}(),function(){var t=Array.prototype.slice,e=Function.prototype.apply,i=function(){};Function.prototype.bind||(Function.prototype.bind=function(r){var n,o=this,s=t.call(arguments,1);return n=s.length?function(){return e.call(o,this instanceof i?this:r,s.concat(t.call(arguments)))}:function(){return e.call(o,this instanceof i?this:r,arguments)},i.prototype=this.prototype,n.prototype=new i,n})}(),function(){function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,r.call(arguments,1)):e.call(this)}function i(){function i(){this.initialize.apply(this,arguments)}var o=null,a=r.call(arguments,0);"function"==typeof a[0]&&(o=a.shift()),i.superclass=o,i.subclasses=[],o&&(t.prototype=o.prototype,i.prototype=new t,o.subclasses.push(i));for(var c=0,l=a.length;l>c;c++)s(i,a[c],o);return i.prototype.initialize||(i.prototype.initialize=n),i.prototype.constructor=i,i.prototype.callSuper=e,i}var r=Array.prototype.slice,n=function(){},o=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),s=function(t,e,i){for(var r in e)t.prototype[r]=r in t.prototype&&"function"==typeof t.prototype[r]&&(e[r]+"").indexOf("callSuper")>-1?function(t){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var n=e[t].apply(this,arguments);if(this.constructor.superclass=r,"initialize"!==t)return n}}(r):e[r],o&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=i}(),function(){function t(t){var e,i,r=Array.prototype.slice.call(arguments,1),n=r.length;for(i=0;n>i;i++)if(e=_typeof(t[r[i]]),!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:i(t,e)}}function i(t,e){return function(i){e.call(s(t),i||fabric.window.event)}}function r(t,e){return function(i){if(g[t]&&g[t][e])for(var r=g[t][e],n=0,o=r.length;o>n;n++)r[n].call(this,i||fabric.window.event)}}function n(t,e){t||(t=fabric.window.event);var i=t.target||(_typeof(t.srcElement)!==c?t.srcElement:null),r=fabric.util.getScrollLeftTop(i,e);return{x:v(t)+r.left,y:y(t)+r.top}}function o(t,e,i){var r="touchend"===t.type?"changedTouches":"touches";return t[r]&&t[r][0]?t[r][0][e]-(t[r][0][e]-t[r][0][i])||t[i]:t[i]}var s,a,c="unknown",l=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};s=function(e){return t[e]},a=function(e,i){t[e]=i}}();var u,h,f=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),p={},g={};f?(u=function(t,e,i){t.addEventListener(e,i,!1)},h=function(t,e,i){t.removeEventListener(e,i,!1)}):d?(u=function(t,i,r){var n=l(t);a(n,t),p[n]||(p[n]={}),p[n][i]||(p[n][i]=[]);var o=e(n,r);p[n][i].push(o),t.attachEvent("on"+i,o.wrappedHandler)},h=function(t,e,i){var r,n=l(t);if(p[n]&&p[n][e])for(var o=0,s=p[n][e].length;s>o;o++)(r=p[n][e][o])&&r.handler===i&&(t.detachEvent("on"+e,r.wrappedHandler),p[n][e][o]=null)}):(u=function(t,e,i){var n=l(t);if(g[n]||(g[n]={}),!g[n][e]){g[n][e]=[];var o=t["on"+e];o&&g[n][e].push(o),t["on"+e]=r(n,e)}g[n][e].push(i)},h=function(t,e,i){var r=l(t);if(g[r]&&g[r][e])for(var n=g[r][e],o=0,s=n.length;s>o;o++)n[o]===i&&n.splice(o,1)}),fabric.util.addListener=u,fabric.util.removeListener=h;var v=function(t){return _typeof(t.clientX)!==c?t.clientX:0},y=function(t){return _typeof(t.clientY)!==c?t.clientY:0};fabric.isTouchSupported&&(v=function(t){return o(t,"pageX","clientX")},y=function(t){return o(t,"pageY","clientY")}),fabric.util.getPointer=n,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function t(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?o(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var r in e)if("opacity"===r)o(t,e[r]);else{var n="float"===r||"cssFloat"===r?void 0===i.styleFloat?"cssFloat":"styleFloat":r;i[n]=e[r]}return t}var e=fabric.document.createElement("div"),i="string"==typeof e.style.opacity,r="string"==typeof e.style.filter,n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,o=function(t){return t};i?o=function(t,e){return t.style.opacity=e,t}:r&&(o=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),n.test(i.filter)?(e=.9999>e?"alpha(opacity="+100*e+")":"",i.filter=i.filter.replace(n,e)):i.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}(),function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var i=fabric.document.createElement(t);for(var r in e)"class"===r?i.className=e[r]:"for"===r?i.htmlFor=e[r]:i.setAttribute(r,e[r]);return i}function i(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function r(t,i,r){return"string"==typeof i&&(i=e(i,r)),t.parentNode&&t.parentNode.replaceChild(i,t),i.appendChild(t),i}function n(t,e){var i,r,n=0,o=0,s=fabric.document.documentElement,a=fabric.document.body||{scrollLeft:0,scrollTop:0};for(r=t;t&&t.parentNode&&!i;)t=t.parentNode,1===t.nodeType&&"fixed"===fabric.util.getElementStyle(t,"position")&&(i=t),1===t.nodeType&&r!==e&&"absolute"===fabric.util.getElementStyle(t,"position")?(n=0,o=0):t===fabric.document?(n=a.scrollLeft||s.scrollLeft||0,o=a.scrollTop||s.scrollTop||0):(n+=t.scrollLeft||0,o+=t.scrollTop||0);return{left:n,top:o}}function o(t){var e,i,r=t&&t.ownerDocument,n={left:0,top:0},o={left:0,top:0},s={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return{left:0,top:0};for(var a in s)o[s[a]]+=parseInt(l(t,a),10)||0;return e=r.documentElement,void 0!==t.getBoundingClientRect&&(n=t.getBoundingClientRect()),i=fabric.util.getScrollLeftTop(t,null),{left:n.left+i.left-(e.clientLeft||0)+o.left,top:n.top+i.top-(e.clientTop||0)+o.top}}var s,a=Array.prototype.slice,c=function(t){return a.call(t,0)};try{s=c(fabric.document.childNodes)instanceof Array}catch(t){}s||(c=function(t){for(var e=Array(t.length),i=t.length;i--;)e[i]=t[i];return e});var l;l=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){var i=fabric.document.defaultView.getComputedStyle(t,null);return i?i[e]:void 0}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){function t(t){return void 0!==t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),r?t.style[r]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return void 0!==t.onselectstart&&(t.onselectstart=null),r?t.style[r]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var i=fabric.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var i=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),n=!0;r.onload=r.onreadystatechange=function(t){if(n){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;n=!1,e(t||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=t,i.appendChild(r)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=c,fabric.util.makeElement=e,fabric.util.addClass=i,fabric.util.wrapElement=r,fabric.util.getScrollLeftTop=n,fabric.util.getElementOffset=o,fabric.util.getElementStyle=l}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function i(i,n){n||(n={});var o,s=n.method?n.method.toUpperCase():"GET",a=n.onComplete||function(){},c=r();return c.onreadystatechange=function(){4===c.readyState&&(a(c),c.onreadystatechange=e)},"GET"===s&&(o=null,"string"==typeof n.parameters&&(i=t(i,n.parameters))),c.open(s,i,!0),"POST"!==s&&"PUT"!==s||c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(o),c}var r=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{if(t[e]())return t[e]}catch(t){}}();fabric.util.request=i}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){void 0!==console[t]&&"function"==typeof console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(t,e,i,r){return t<Math.abs(e)?(t=e,r=i/4):r=i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:r}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*i-t.s)*(2*Math.PI)/t.p)}function i(t,e,i,r){return i*((t=t/r-1)*t*t+1)+e}function r(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function n(t,e,i,r){return i*(t/=r)*t*t*t+e}function o(t,e,i,r){return-i*((t=t/r-1)*t*t*t-1)+e}function s(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}function a(t,e,i,r){return i*(t/=r)*t*t*t*t+e}function c(t,e,i,r){return i*((t=t/r-1)*t*t*t*t+1)+e}function l(t,e,i,r){return t/=r/2,1>t?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function u(t,e,i,r){return-i*Math.cos(t/r*(Math.PI/2))+i+e}function h(t,e,i,r){return i*Math.sin(t/r*(Math.PI/2))+e}function f(t,e,i,r){return-i/2*(Math.cos(Math.PI*t/r)-1)+e}function d(t,e,i,r){return 0===t?e:i*Math.pow(2,10*(t/r-1))+e}function p(t,e,i,r){return t===r?e+i:i*(1-Math.pow(2,-10*t/r))+e}function g(t,e,i,r){return 0===t?e:t===r?e+i:(t/=r/2,1>t?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e)}function v(t,e,i,r){return-i*(Math.sqrt(1-(t/=r)*t)-1)+e}function y(t,e,i,r){return i*Math.sqrt(1-(t=t/r-1)*t)+e}function m(t,e,i,r){return t/=r/2,1>t?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function b(i,r,n,o){var s=0,a=n;return 0===i?r:1===(i/=o)?r+n:(s||(s=.3*o),-e(t(a,n,s,1.70158),i,o)+r)}function _(e,i,r,n){var o=0,s=r;if(0===e)return i;if(1===(e/=n))return i+r;o||(o=.3*n);var a=t(s,r,o,1.70158);return a.a*Math.pow(2,-10*e)*Math.sin((e*n-a.s)*(2*Math.PI)/a.p)+a.c+i}function x(i,r,n,o){var s=0,a=n;if(0===i)return r;if(2===(i/=o/2))return r+n;s||(s=o*(.3*1.5));var c=t(a,n,s,1.70158);return 1>i?-.5*e(c,i,o)+r:c.a*Math.pow(2,-10*(i-=1))*Math.sin((i*o-c.s)*(2*Math.PI)/c.p)*.5+c.c+r}function w(t,e,i,r,n){return void 0===n&&(n=1.70158),i*(t/=r)*t*((n+1)*t-n)+e}function C(t,e,i,r,n){return void 0===n&&(n=1.70158),i*((t=t/r-1)*t*((n+1)*t+n)+1)+e}function O(t,e,i,r,n){return void 0===n&&(n=1.70158),t/=r/2,1>t?i/2*(t*t*((1+(n*=1.525))*t-n))+e:i/2*((t-=2)*t*((1+(n*=1.525))*t+n)+2)+e}function T(t,e,i,r){return i-S(r-t,0,i,r)+e}function S(t,e,i,r){return(t/=r)<1/2.75?i*(7.5625*t*t)+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function j(t,e,i,r){return r/2>t?.5*T(2*t,0,i,r)+e:.5*S(2*t-r,0,i,r)+.5*i+e}fabric.util.ease={easeInQuad:function(t,e,i,r){return i*(t/=r)*t+e},easeOutQuad:function(t,e,i,r){return-i*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,i,r){return t/=r/2,1>t?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,r){return i*(t/=r)*t*t+e},easeOutCubic:i,easeInOutCubic:r,easeInQuart:n,easeOutQuart:o,easeInOutQuart:s,easeInQuint:a,easeOutQuint:c,easeInOutQuint:l,easeInSine:u,easeOutSine:h,easeInOutSine:f,easeInExpo:d,easeOutExpo:p,easeInOutExpo:g,easeInCirc:v,easeOutCirc:y,easeInOutCirc:m,easeInElastic:b,easeOutElastic:_,easeInOutElastic:x,easeInBack:w,easeOutBack:C,easeInOutBack:O,easeInBounce:T,easeOutBounce:S,easeInOutBounce:j}}(),function(t){function e(t){return t in x?x[t]:t}function i(t,e,i,r){var n,o="[object Array]"===Object.prototype.toString.call(e);return"fill"!==t&&"stroke"!==t||"none"!==e?"strokeDashArray"===t?e=e.replace(/,/g," ").split(/\s+/).map(function(t){return parseFloat(t)}):"transformMatrix"===t?e=i&&i.transformMatrix?_(i.transformMatrix,p.parseTransformAttribute(e)):p.parseTransformAttribute(e):"visible"===t?(e="none"!==e&&"hidden"!==e,i&&!1===i.visible&&(e=!1)):"originX"===t?e="start"===e?"left":"end"===e?"right":"center":n=o?e.map(b):b(e,r):e="",!o&&isNaN(n)?e:n}function r(t){for(var e in w)if(t[e]&&void 0!==t[w[e]]&&0!==t[e].indexOf("url(")){var i=new p.Color(t[e]);t[e]=i.setAlpha(m(i.getAlpha()*t[w[e]],2)).toRgba()}return t}function n(t,r){var n,o;t.replace(/;$/,"").split(";").forEach(function(t){var s=t.split(":");n=e(s[0].trim().toLowerCase()),o=i(n,s[1].trim()),r[n]=o})}function o(t,r){var n,o;for(var s in t)void 0!==t[s]&&(n=e(s.toLowerCase()),o=i(n,t[s]),r[n]=o)}function s(t,e){var i={};for(var r in p.cssRules[e])if(a(t,r.split(" ")))for(var n in p.cssRules[e][r])i[n]=p.cssRules[e][r][n];return i}function a(t,e){var i,r=!0;return i=l(t,e.pop()),i&&e.length&&(r=c(t,e)),i&&r&&0===e.length}function c(t,e){for(var i,r=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)r&&(i=e.pop()),t=t.parentNode,r=l(t,i);return 0===e.length}function l(t,e){var i,r=t.nodeName,n=t.getAttribute("class"),o=t.getAttribute("id");if(i=RegExp("^"+r,"i"),e=e.replace(i,""),o&&e.length&&(i=RegExp("#"+o+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),n&&e.length){n=n.split(" ");for(var s=n.length;s--;)i=RegExp("\\."+n[s]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")}return 0===e.length}function u(t){for(var e=t.getElementsByTagName("use");e.length;){for(var i,r=e[0],n=r.getAttribute("xlink:href").substr(1),o=r.getAttribute("x")||0,s=r.getAttribute("y")||0,a=t.getElementById(n).cloneNode(!0),c=(a.getAttribute("transform")||"")+" translate("+o+", "+s+")",l=0,u=r.attributes,h=u.length;h>l;l++){var f=u.item(l);"x"!==f.nodeName&&"y"!==f.nodeName&&"xlink:href"!==f.nodeName&&("transform"===f.nodeName?c=f.nodeValue+" "+c:a.setAttribute(f.nodeName,f.nodeValue))}a.setAttribute("transform",c),a.setAttribute("instantiated_by_use","1"),a.removeAttribute("id"),i=r.parentNode,i.replaceChild(a,r)}}function h(t,e,i){var r,n,o,s,a=t.getAttribute("viewBox"),c=1,l=1,u=0,h=0;if(a&&(a=a.match(C))&&(u=-parseFloat(a[1]),h=-parseFloat(a[2]),r=parseFloat(a[3]),n=parseFloat(a[4]),e&&e!==r&&(c=e/r),i&&i!==n&&(l=i/n),l=c=c>l?l:c,1!==c||1!==l||0!==u||0!==h)){if(o=" matrix("+c+" 0 0 "+l+" "+u*c+" "+h*l+") ","svg"===t.tagName){for(s=t.ownerDocument.createElement("g");null!=t.firstChild;)s.appendChild(t.firstChild);t.appendChild(s)}else s=t,o=s.getAttribute("transform")+o;s.setAttribute("transform",o)}}function f(t){var e=t.objects,i=t.options;return e=e.map(function(t){return p[v(t.type)].fromObject(t)}),{objects:e,options:i}}function d(t,e,i){e[i]&&e[i].toSVG&&t.push('<pattern x="0" y="0" id="',i,'Pattern" ','width="',e[i].source.width,'" height="',e[i].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',e[i].source.width,'" height="',e[i].source.height,'" xlink:href="',e[i].source.src,'"></image></pattern>')}var p=t.fabric||(t.fabric={}),g=p.util.object.extend,v=p.util.string.capitalize,y=p.util.object.clone,m=p.util.toFixed,b=p.util.parseUnit,_=p.util.multiplyTransformMatrices,x={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},w={stroke:"strokeOpacity",fill:"fillOpacity"};p.cssRules={},p.gradientDefs={},p.parseTransformAttribute=function(){function t(t,e){var i=e[0];t[0]=Math.cos(i),t[1]=Math.sin(i),t[2]=-Math.sin(i),t[3]=Math.cos(i)}function e(t,e){var i=e[0],r=2===e.length?e[1]:e[0];t[0]=i,t[3]=r}function i(t,e){t[2]=Math.tan(p.util.degreesToRadians(e[0]))}function r(t,e){t[1]=Math.tan(p.util.degreesToRadians(e[0]))}function n(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var o=[1,0,0,1,0,0],s=p.reNum,a="(?:\\s+,?\\s*|,\\s*)",c="(?:(skewX)\\s*\\(\\s*("+s+")\\s*\\))",l="(?:(skewY)\\s*\\(\\s*("+s+")\\s*\\))",u="(?:(rotate)\\s*\\(\\s*("+s+")(?:"+a+"("+s+")"+a+"("+s+"))?\\s*\\))",h="(?:(scale)\\s*\\(\\s*("+s+")(?:"+a+"("+s+"))?\\s*\\))",f="(?:(translate)\\s*\\(\\s*("+s+")(?:"+a+"("+s+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+s+")"+a+"("+s+")"+a+"("+s+")"+a+"("+s+")"+a+"("+s+")"+a+"("+s+")\\s*\\))",g="(?:"+d+"|"+f+"|"+h+"|"+u+"|"+c+"|"+l+")",v="(?:"+g+"(?:"+a+g+")*)",y="^\\s*(?:"+v+"?)\\s*$",m=RegExp(y),b=RegExp(g,"g");return function(s){var a=o.concat(),c=[];if(!s||s&&!m.test(s))return a;s.replace(b,function(s){var l=RegExp(g).exec(s).filter(function(t){return""!==t&&null!=t}),u=l[1],h=l.slice(2).map(parseFloat);switch(u){case"translate":n(a,h);break;case"rotate":h[0]=p.util.degreesToRadians(h[0]),t(a,h);break;case"scale":e(a,h);break;case"skewX":i(a,h);break;case"skewY":r(a,h);break;case"matrix":a=h}c.push(a.concat()),a=o.concat()});for(var l=c[0];c.length>1;)c.shift(),l=p.util.multiplyTransformMatrices(l,c[0]);return l}}();var C=RegExp("^\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*,?\\s*("+p.reNum+"+)\\s*$");p.parseSVGDocument=function(){function t(t,e){for(;t&&(t=t.parentNode);)if(e.test(t.nodeName)&&!t.getAttribute("instantiated_by_use"))return!0;return!1}var e=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,i=/^(symbol|image|marker|pattern|view)$/;return function(r,n,o){if(r){u(r);var s,a,c=new Date,l=p.Object.__uid++,f=!1;if(r.getAttribute("width")&&"100%"!==r.getAttribute("width")&&(s=b(r.getAttribute("width"))),r.getAttribute("height")&&"100%"!==r.getAttribute("height")&&(a=b(r.getAttribute("height"))),!s||!a){var d=r.getAttribute("viewBox");d&&(d=d.match(C))?(s=parseFloat(d[3]),a=parseFloat(d[4])):f=!0}h(r,s,a);var g=p.util.toArray(r.getElementsByTagName("*"));if(0===g.length&&p.isLikelyNode){g=r.selectNodes('//*[name(.)!="svg"]');for(var v=[],m=0,_=g.length;_>m;m++)v[m]=g[m];g=v}var x=g.filter(function(r){return i.test(r.tagName)&&h(r,0,0),e.test(r.tagName)&&!t(r,/^(?:pattern|defs|symbol)$/)});if(!x||x&&!x.length)return void(n&&n([],{}));var w={width:s,height:a,svgUid:l,toBeParsed:f};p.gradientDefs[l]=p.getGradientDefs(r),p.cssRules[l]=p.getCSSRules(r),p.parseElements(x,function(t){p.documentParsingTime=new Date-c,n&&n(t,w)},y(w),o)}}}();var O={has:function(t,e){e(!1)},get:function(){},set:function(){}},T=RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+p.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+p.reNum+"))?\\s+(.*)");g(p,{parseFontDeclaration:function(t,e){var i=t.match(T);if(i){var r=i[1],n=i[3],o=i[4],s=i[5],a=i[6];r&&(e.fontStyle=r),n&&(e.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),o&&(e.fontSize=b(o)),a&&(e.fontFamily=a),s&&(e.lineHeight="normal"===s?1:s)}},getGradientDefs:function(t){var e,i,r,n,o=t.getElementsByTagName("linearGradient"),s=t.getElementsByTagName("radialGradient"),a=0,c=[],l={},u={};for(c.length=o.length+s.length,i=o.length;i--;)c[a++]=o[i];for(i=s.length;i--;)c[a++]=s[i];for(;a--;)e=c[a],n=e.getAttribute("xlink:href"),r=e.getAttribute("id"),n&&(u[r]=n.substr(1)),l[r]=e;for(r in u){var h=l[u[r]].cloneNode(!0);for(e=l[r];h.firstChild;)e.appendChild(h.firstChild)}return l},parseAttributes:function(t,n,o){if(t){var a,c,l={};void 0===o&&(o=t.getAttribute("svgUid")),t.parentNode&&/^symbol|[g|a]$/i.test(t.parentNode.nodeName)&&(l=p.parseAttributes(t.parentNode,n,o)),c=l&&l.fontSize||t.getAttribute("font-size")||p.Text.DEFAULT_SVG_FONT_SIZE;var u=n.reduce(function(r,n){return a=t.getAttribute(n),a&&(n=e(n),a=i(n,a,l,c),r[n]=a),r},{});return u=g(u,g(s(t,o),p.parseStyleAttribute(t))),u.font&&p.parseFontDeclaration(u.font,u),r(g(l,u))}},parseElements:function(t,e,i,r){new p.ElementsParser(t,e,i,r).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?n(i,e):o(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,i,r=[];for(e=0,i=t.length;i>e;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r},getCSSRules:function(t){for(var r,n=t.getElementsByTagName("style"),o={},s=0,a=n.length;a>s;s++){var c=n[s].textContent;c=c.replace(/\/\*[\s\S]*?\*\//g,""),""!==c.trim()&&(r=c.match(/[^{]*\{[\s\S]*?\}/g),r=r.map(function(t){return t.trim()}),r.forEach(function(t){for(var r=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),n={},s=r[2].trim(),a=s.replace(/;$/,"").split(/\s*;\s*/),c=0,l=a.length;l>c;c++){var u=a[c].split(/\s*:\s*/),h=e(u[0]),f=i(h,u[1],u[0]);n[h]=f}t=r[1],t.split(",").forEach(function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(o[t]=p.util.object.clone(n))})}))}return o},loadSVGFromURL:function(t,e,i){function r(r){var n=r.responseXML;n&&!n.documentElement&&p.window.ActiveXObject&&r.responseText&&(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(r.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),n&&n.documentElement&&p.parseSVGDocument(n.documentElement,function(i,r){O.set(t,{objects:p.util.array.invoke(i,"toObject"),options:r}),e(i,r)},i)}t=t.replace(/^\n\s*/,"").trim(),O.has(t,function(i){i?O.get(t,function(t){var i=f(t);e(i.objects,i.options)}):new p.util.request(t,{method:"get",onComplete:r})})},loadSVGFromString:function(t,e,i){t=t.trim();var r;if("undefined"!=typeof DOMParser){var n=new DOMParser;n&&n.parseFromString&&(r=n.parseFromString(t,"text/xml"))}else p.window.ActiveXObject&&(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));p.parseSVGDocument(r.documentElement,function(t,i){e(t,i)},i)},createSVGFontFacesMarkup:function(t){for(var e="",i=0,r=t.length;r>i;i++)"text"===t[i].type&&t[i].path&&(e+="@font-face {font-family: "+t[i].fontFamily+"; src: url('"+t[i].path+"')}");return e&&(e='<style type="text/css"><![CDATA['+e+"]]></style>"),e},createSVGRefElementsMarkup:function(t){var e=[];return d(e,t,"backgroundColor"),d(e,t,"overlayColor"),e.join("")}})}(exports),fabric.ElementsParser=function(t,e,i,r){this.elements=t,this.callback=e,this.options=i,this.reviver=r,this.svgUid=i&&i.svgUid||0},fabric.ElementsParser.prototype.parse=function(){this.instances=Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;e>t;t++)this.elements[t].setAttribute("svgUid",this.svgUid),function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var i=fabric[fabric.util.string.capitalize(t.tagName)];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(t){fabric.log(t)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,i){if(t.async)t.fromElement(e,this.createCallback(i,e),this.options);else{var r=t.fromElement(e,this.options);this.resolveGradient(r,"fill"),this.resolveGradient(r,"stroke"),this.reviver&&this.reviver(e,r),this.instances[i]=r,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(r){i.resolveGradient(r,"fill"),i.resolveGradient(r,"stroke"),i.reviver&&i.reviver(e,r),i.instances[t]=r,i.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var i=t.get(e);if(/^url\(/.test(i)){var r=i.slice(5,i.length-1);fabric.gradientDefs[this.svgUid][r]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances))},function(t){function e(t,e){this.x=t,this.y=e}var i=t.fabric||(t.fabric={});if(i.Point)return void i.warn("fabric.Point is already defined");i.Point=e,e.prototype={constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return t.x>this.x&&t.y>this.y},lte:function(t){return t.x>=this.x&&t.y>=this.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return new e(this.x+(t.x-this.x)/2,this.y+(t.y-this.y)/2)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){this.x=t,this.y=e},setFromPoint:function(t){this.x=t.x,this.y=t.y},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}}}(exports),function(t){function e(t){this.status=t,this.points=[]}var i=t.fabric||(t.fabric={});if(i.Intersection)return void i.warn("fabric.Intersection is already defined");i.Intersection=e,i.Intersection.prototype={appendPoint:function(t){this.points.push(t)},appendPoints:function(t){this.points=this.points.concat(t)}},i.Intersection.intersectLineLine=function(t,r,n,o){var s,a=(o.x-n.x)*(t.y-n.y)-(o.y-n.y)*(t.x-n.x),c=(r.x-t.x)*(t.y-n.y)-(r.y-t.y)*(t.x-n.x),l=(o.y-n.y)*(r.x-t.x)-(o.x-n.x)*(r.y-t.y);if(0!==l){var u=a/l,h=c/l;0>u||u>1||0>h||h>1?s=new e:(s=new e("Intersection"),s.points.push(new i.Point(t.x+u*(r.x-t.x),t.y+u*(r.y-t.y))))}else s=new e(0===a||0===c?"Coincident":"Parallel");return s},i.Intersection.intersectLinePolygon=function(t,i,r){for(var n=new e,o=r.length,s=0;o>s;s++){n.appendPoints(e.intersectLineLine(t,i,r[s],r[(s+1)%o]).points)}return n.points.length>0&&(n.status="Intersection"),n},i.Intersection.intersectPolygonPolygon=function(t,i){for(var r=new e,n=t.length,o=0;n>o;o++){r.appendPoints(e.intersectLinePolygon(t[o],t[(o+1)%n],i).points)}return r.points.length>0&&(r.status="Intersection"),r},i.Intersection.intersectPolygonRectangle=function(t,r,n){var o=r.min(n),s=r.max(n),a=new i.Point(s.x,o.y),c=new i.Point(o.x,s.y),l=e.intersectLinePolygon(o,a,t),u=e.intersectLinePolygon(a,s,t),h=e.intersectLinePolygon(s,c,t),f=e.intersectLinePolygon(c,o,t),d=new e;return d.appendPoints(l.points),d.appendPoints(u.points),d.appendPoints(h.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d}}(exports),function(t){function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var r=t.fabric||(t.fabric={});if(r.Color)return void r.warn("fabric.Color is already defined.");r.Color=e,r.Color.prototype={_tryParsingColor:function(t){var i;if(t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t)return void this.setSource([255,255,255,0]);i=e.sourceFromHex(t),i||(i=e.sourceFromRgb(t)),i||(i=e.sourceFromHsl(t)),i&&this.setSource(i)},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var n,o,s,a=r.util.array.max([t,e,i]),c=r.util.array.min([t,e,i]);if(s=(a+c)/2,a===c)n=o=0;else{var l=a-c;switch(o=s>.5?l/(2-a-c):l/(a+c),a){case t:n=(e-i)/l+(i>e?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return[Math.round(360*n),Math.round(100*o),Math.round(100*s)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,r=this.getSource();return t=r[0].toString(16),t=1===t.length?"0"+t:t,e=r[1].toString(16),e=1===e.length?"0"+e:e,i=r[2].toString(16),i=1===i.length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10);return this.setSource([e,e,e,t[3]]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),r=e[3];return t=t||127,i=+t>+i?0:255,this.setSource([i,i,i,r]),this},overlayWith:function(t){t instanceof e||(t=new e(t));for(var i=[],r=this.getAlpha(),n=this.getSource(),o=t.getSource(),s=0;3>s;s++)i.push(Math.round(.5*n[s]+.5*o[s]));return i[3]=r,this.setSource(i),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,r.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},r.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},r.Color.sourceFromRgb=function(t){var i=t.match(e.reRGBa);if(i){var r=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),n=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),o=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(r,10),parseInt(n,10),parseInt(o,10),i[4]?parseFloat(i[4]):1]}},r.Color.fromRgba=e.fromRgb,r.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},r.Color.sourceFromHsl=function(t){var r=t.match(e.reHSLa);if(r){var n,o,s,a=(parseFloat(r[1])%360+360)%360/360,c=parseFloat(r[2])/(/%$/.test(r[2])?100:1),l=parseFloat(r[3])/(/%$/.test(r[3])?100:1);if(0===c)n=o=s=l;else{var u=l>.5?l+c-l*c:l*(c+1),h=2*l-u;n=i(h,u,a+1/3),o=i(h,u,a),s=i(h,u,a-1/3)}return[Math.round(255*n),Math.round(255*o),Math.round(255*s),r[4]?parseFloat(r[4]):1]}},r.Color.fromHsla=e.fromHsl,r.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},r.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var i=t.slice(t.indexOf("#")+1),r=3===i.length,n=r?i.charAt(0)+i.charAt(0):i.substring(0,2),o=r?i.charAt(1)+i.charAt(1):i.substring(2,4),s=r?i.charAt(2)+i.charAt(2):i.substring(4,6);return[parseInt(n,16),parseInt(o,16),parseInt(s,16),1]}},r.Color.fromSource=function(t){var i=new e;return i.setSource(t),i}}(exports),function(){function t(t){var e,i,r,n=t.getAttribute("style"),o=t.getAttribute("offset");if(o=parseFloat(o)/(/%$/.test(o)?100:1),o=0>o?0:o>1?1:o,n){var s=n.split(/\s*;\s*/);""===s[s.length-1]&&s.pop();for(var a=s.length;a--;){var c=s[a].split(/\s*:\s*/),l=c[0].trim(),u=c[1].trim();"stop-color"===l?e=u:"stop-opacity"===l&&(r=u)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=t.getAttribute("stop-opacity")),e=new fabric.Color(e),i=e.getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i,{offset:o,color:e.toRgb(),opacity:r}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function i(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function r(t,e,i){var r,n=0,o=1,s="";for(var a in e)r=parseFloat(e[a],10),o="string"==typeof e[a]&&/^\d+%$/.test(e[a])?.01:1,"x1"===a||"x2"===a||"r2"===a?(o*="objectBoundingBox"===i?t.width:1,n="objectBoundingBox"===i?t.left||0:0):"y1"!==a&&"y2"!==a||(o*="objectBoundingBox"===i?t.height:1,n="objectBoundingBox"===i?t.top||0:0),e[a]=r*o+n;if("ellipse"===t.type&&null!==e.r2&&"objectBoundingBox"===i&&t.rx!==t.ry){var c=t.ry/t.rx;s=" scale(1, "+c+")",e.y1&&(e.y1/=c),e.y2&&(e.y2/=c)}return s}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.offsetX=t.offsetX||this.offsetX,this.offsetY=t.offsetY||this.offsetY},addColorStop:function(t){for(var e in t){var i=new fabric.Color(t[e]);this.colorStops.push({offset:e,color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e,i,r=fabric.util.object.clone(this.coords);if(this.colorStops.sort(function(t,e){return t.offset-e.offset}),!t.group||"path-group"!==t.group.type)for(var n in r)"x1"===n||"x2"===n||"r2"===n?r[n]+=this.offsetX-t.width/2:"y1"!==n&&"y2"!==n||(r[n]+=this.offsetY-t.height/2);i='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(i+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?e=["<linearGradient ",i,' x1="',r.x1,'" y1="',r.y1,'" x2="',r.x2,'" y2="',r.y2,'">\n']:"radial"===this.type&&(e=["<radialGradient ",i,' cx="',r.x2,'" cy="',r.y2,'" r="',r.r2,'" fx="',r.x1,'" fy="',r.y1,'">\n']);for(var o=0;this.colorStops.length>o;o++)e.push("<stop ",'offset="',100*this.colorStops[o].offset+"%",'" style="stop-color:',this.colorStops[o].color,null!=this.colorStops[o].opacity?";stop-opacity: "+this.colorStops[o].opacity:";",'"/>\n');return e.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),e.join("")},toLive:function(t,e){var i,r,n=fabric.util.object.clone(this.coords);if(this.type){if(e.group&&"path-group"===e.group.type)for(r in n)"x1"===r||"x2"===r?n[r]+=e.width/2-this.offsetX:"y1"!==r&&"y2"!==r||(n[r]+=e.height/2-this.offsetY);if("text"===e.type||"i-text"===e.type)for(r in n)"x1"===r||"x2"===r?n[r]-=e.width/2:"y1"!==r&&"y2"!==r||(n[r]-=e.height/2);"linear"===this.type?i=t.createLinearGradient(n.x1,n.y1,n.x2,n.y2):"radial"===this.type&&(i=t.createRadialGradient(n.x1,n.y1,n.r1,n.x2,n.y2,n.r2));for(var o=0,s=this.colorStops.length;s>o;o++){var a=this.colorStops[o].color,c=this.colorStops[o].opacity,l=this.colorStops[o].offset;void 0!==c&&(a=new fabric.Color(a).setAlpha(c).toRgba()),i.addColorStop(parseFloat(l),a)}return i}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(n,o){var s,a=n.getElementsByTagName("stop"),c="linearGradient"===n.nodeName?"linear":"radial",l=n.getAttribute("gradientUnits")||"objectBoundingBox",u=n.getAttribute("gradientTransform"),h=[],f={};"linear"===c?f=e(n):"radial"===c&&(f=i(n));for(var d=a.length;d--;)h.push(t(a[d]));s=r(o,f,l);var p=new fabric.Gradient({type:c,coords:f,colorStops:h,offsetX:-o.left,offsetY:-o.top});return(u||""!==s)&&(p.gradientTransform=fabric.parseTransformAttribute((u||"")+s)),p},forObject:function(t,e){return e||(e={}),r(t,e.coords,"userSpaceOnUse"),new fabric.Gradient(e)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),this.id=fabric.Object.__uid++,t.source)if("string"==typeof t.source)if(void 0!==fabric.util.getFunctionBody(t.source))this.source=Function(fabric.util.getFunctionBody(t.source));else{var e=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toObject:function(){var t;return"function"==typeof this.source?t=this.source+"":"string"==typeof this.source.src&&(t=this.source.src),{source:t,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.getWidth(),r=e.height/t.getHeight(),n=this.offsetX/t.getWidth(),o=this.offsetY/t.getHeight(),s="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(r=1),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(i=1),e.src?s=e.src:e.toDataURL&&(s=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+o+'" width="'+i+'" height="'+r+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+s+'"></image>\n</pattern>\n'},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}}),function(t){var e=t.fabric||(t.fabric={}),i=e.util.toFixed;if(e.Shadow)return void e.warn("fabric.Shadow is already defined.");e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var i in t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),r=e.Shadow.reOffsetsAndBlur.exec(i)||[];return{color:(i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var e="SourceAlpha",r=40,n=40;return!t||t.fill!==this.color&&t.stroke!==this.color||(e="SourceGraphic"),t.width&&t.height&&(r=100*i(Math.abs(this.offsetX/t.getWidth()),2)+20,n=100*i(Math.abs(this.offsetY/t.getHeight()),2)+20),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+r+'%" width="'+(100+2*r)+'%" >\n\t<feGaussianBlur in="'+e+'" stdDeviation="'+i(this.blur?this.blur/2:0,3)+'" result="blurOut"></feGaussianBlur>\n\t<feColorMatrix result="matrixOut" in="blurOut" type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.30 0" ></feColorMatrix >\n\t<feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset>\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var t={},i=e.Shadow.prototype;return this.color!==i.color&&(t.color=this.color),this.blur!==i.blur&&(t.blur=this.blur),this.offsetX!==i.offsetX&&(t.offsetX=this.offsetX),this.offsetY!==i.offsetY&&(t.offsetY=this.offsetY),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/}(exports),function(){if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,i=fabric.util.removeFromArray,r=Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(t,e){e||(e={}),this._initStatic(t,e),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(t,e){this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),e.overlayImage&&this.setOverlayImage(e.overlayImage,this.renderAll.bind(this)),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,this.renderAll.bind(this)),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,this.renderAll.bind(this)),e.overlayColor&&this.setOverlayColor(e.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.webkitImageSmoothingEnabled=this.imageSmoothingEnabled,t.mozImageSmoothingEnabled=this.imageSmoothingEnabled,t.msImageSmoothingEnabled=this.imageSmoothingEnabled,t.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,r){return"string"==typeof e?fabric.util.loadImage(e,function(e){this[t]=new fabric.Image(e,r),i&&i()},this,r&&r.crossOrigin):(r&&e.setOptions(r),this[t]=e,i&&i()),this},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var r=this;fabric.util.loadImage(e.source,function(n){r[t]=new fabric.Pattern({source:n,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY}),i&&i()})}else this[t]=e,i&&i();return this},_createCanvasElement:function(){var t=fabric.document.createElement("canvas");if(t.style||(t.style={}),!t)throw r;return this._initCanvasElement(t),t},_initCanvasElement:function(t){if(fabric.util.createCanvasElement(t),void 0===t.getContext)throw r},_initOptions:function(t){for(var e in t)this[e]=t[e];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=fabric.util.getById(t)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;e=e||{};for(var r in t)i=t[r],e.cssOnly||(this._setBackstoreDimension(r,t[r]),i+="px"),e.backstoreOnly||this._setCssDimension(r,i);return e.cssOnly||this.renderAll(),this.calcOffset(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(t){var e=this.getActiveGroup();this.viewportTransform=t,this.renderAll();for(var i=0,r=this._objects.length;r>i;i++)this._objects[i].setCoords();return e&&e.setCoords(),this},zoomToPoint:function(t,e){var i=t;t=fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform)),this.viewportTransform[0]=e,this.viewportTransform[3]=e;var r=fabric.util.transformPoint(t,this.viewportTransform);this.viewportTransform[4]+=i.x-r.x,this.viewportTransform[5]+=i.y-r.y,this.renderAll();for(var n=0,o=this._objects.length;o>n;n++)this._objects[n].setCoords();return this},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){this.viewportTransform[4]=-t.x,this.viewportTransform[5]=-t.y,this.renderAll();for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].setCoords();return this},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(t,e){if(e){t.save();var i=this.viewportTransform;t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._shouldRenderObject(e)&&e.render(t),t.restore(),this.controlsAboveOverlay||e._renderControls(t)}},_shouldRenderObject:function(t){return!!t&&(t!==this.getActiveGroup()||!this.preserveObjectStacking)},_onObjectAdded:function(t){this.stateful&&t.setupState(),t.canvas=this,t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.getActiveObject()===t&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:t}),t.fire("removed")},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(t){var e=this[!0===t&&this.interactive?"contextTop":"contextContainer"],i=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),t||this.clearContext(e),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,e),this._renderBackground(e),this._renderObjects(e,i),this._renderActiveGroup(e,i),this.clipTo&&e.restore(),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render"),this},_renderObjects:function(t,e){var i,r;if(!e||this.preserveObjectStacking)for(i=0,r=this._objects.length;r>i;++i)this._draw(t,this._objects[i]);else for(i=0,r=this._objects.length;r>i;++i)this._objects[i]&&!e.contains(this._objects[i])&&this._draw(t,this._objects[i])},_renderActiveGroup:function(t,e){if(e){var i=[];this.forEachObject(function(t){e.contains(t)&&i.push(t)}),e._set("objects",i),this._draw(t,e)}},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(t):this.backgroundColor,t.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this._draw(t,this.backgroundImage)},_renderOverlay:function(t){this.overlayColor&&(t.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(t):this.overlayColor,t.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this._draw(t,this.overlayImage)},renderTop:function(){var t=this.contextTop||this.contextContainer;this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection();var e=this.getActiveGroup();return e&&e.render(t),this._renderOverlay(t),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top)),this.renderAll(),this},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var r={objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,r,i),r},_toObjects:function(t,e){return this.getObjects().map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var r;this.includeDefaultValues||(r=t.includeDefaultValues,t.includeDefaultValues=!1);var n=this._realizeGroupTransformOnObject(t),o=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=r),this._unwindGroupTransformOnObject(t,n),o},_realizeGroupTransformOnObject:function(t){var e=["angle","flipX","flipY","height","left","scaleX","scaleY","top","width"];if(t.group&&t.group===this.getActiveGroup()){var i={};return e.forEach(function(e){i[e]=t[e]}),this.getActiveGroup().realizeTransform(t),i}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},__serializeBgOverlay:function(){var t={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(t.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(t.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(t.overlayImage=this.overlayImage.toObject()),t},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage"),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage"),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var i,r,n;e.viewBox?(i=e.viewBox.width,r=e.viewBox.height):(i=this.width,r=this.height,this.svgViewportTransformation||(n=this.viewportTransform,i/=n[0],r/=n[3])),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',r,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,e.viewBox?'viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(t,e){for(var i=0,r=this.getObjects(),n=r.length;n>i;i++){var o=r[i],s=this._realizeGroupTransformOnObject(o);t.push(o.toSVG(e)),this._unwindGroupTransformOnObject(o,s)}},_setSVGBgOverlayImage:function(t,e){this[e]&&this[e].toSVG&&t.push(this[e].toSVG())},_setSVGBgOverlayColor:function(t,e){this[e]&&this[e].source?t.push('<rect x="',this[e].offsetX,'" y="',this[e].offsetY,'" ','width="',"repeat-y"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.width:this.width,'" height="',"repeat-x"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.height:this.height,'" fill="url(#'+e+'Pattern)"',"></rect>"):this[e]&&"overlayColor"===e&&t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>")},sendToBack:function(t){return i(this._objects,t),this._objects.unshift(t),this.renderAll&&this.renderAll()},bringToFront:function(t){return i(this._objects,t),this._objects.push(t),this.renderAll&&this.renderAll()},sendBackwards:function(t,e){var r=this._objects.indexOf(t);if(0!==r){var n=this._findNewLowerIndex(t,r,e);i(this._objects,t),this._objects.splice(n,0,t),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(t,e,i){var r;if(i){r=e;for(var n=e-1;n>=0;--n){if(t.intersectsWithObject(this._objects[n])||t.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(t)){r=n;break}}}else r=e-1;return r},bringForward:function(t,e){var r=this._objects.indexOf(t);if(r!==this._objects.length-1){var n=this._findNewUpperIndex(t,r,e);i(this._objects,t),this._objects.splice(n,0,t),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(t,e,i){var r;if(i){r=e;for(var n=e+1;this._objects.length>n;++n){if(t.intersectsWithObject(this._objects[n])||t.isContainedWithinObject(this._objects[n])||this._objects[n].isContainedWithinObject(t)){r=n;break}}}else r=e+1;return r},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return void 0!==i.getImageData;case"setLineDash":return void 0!==i.setLineDash;case"toDataURL":return void 0!==e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(t){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&t.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){this._addPoint(new fabric.Point(t.x,t.y))},_render:function(){var t=this.canvas.contextTop,e=this.canvas.viewportTransform,i=this._points[0],r=this._points[1];t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y&&(i.x-=.5,r.x+=.5),t.moveTo(i.x,i.y);for(var n=1,o=this._points.length;o>n;n++){var s=i.midPointFrom(r);t.quadraticCurveTo(i.x,i.y,s.x,s.y),i=this._points[n],r=this._points[n+1]}t.lineTo(i.x,i.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=[],i=new fabric.Point(t[0].x,t[0].y),r=new fabric.Point(t[1].x,t[1].y);e.push("M ",t[0].x," ",t[0].y," ");for(var n=1,o=t.length;o>n;n++){var s=i.midPointFrom(r);e.push("Q ",i.x," ",i.y," ",s.x," ",s.y," "),i=new fabric.Point(t[n].x,t[n].y),t.length>n+1&&(r=new fabric.Point(t[n+1].x,t[n+1].y))}return e.push("L ",i.x," ",i.y," "),e},createPath:function(t){var e=new fabric.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath();var t=this.convertPointsToSVGPath(this._points).join("");if("M 0 0 Q 0 0 0 0 L 0 0"===t)return void this.canvas.renderAll();var e=this.createPath(t);this.canvas.add(e),e.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:e})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop,r=this.canvas.viewportTransform;i.save(),i.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.points.length;r>i;i++){var n=this.points[i],o=new fabric.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&o.setShadow(this.shadow),e.push(o)}var s=new fabric.Group(e,{originX:"center",originY:"center"});s.canvas=this.canvas,this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),i=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=r,this.points.push(e),e}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,r=this.sprayChunks.length;r>i;i++)for(var n=this.sprayChunks[i],o=0,s=n.length;s>o;o++){var a=new fabric.Rect({width:n[o].width,height:n[o].width,left:n[o].x+1,top:n[o].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&a.setShadow(this.shadow),e.push(a)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var c=new fabric.Group(e,{originX:"center",originY:"center"});c.canvas=this.canvas,this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},_getOptimizedRects:function(t){for(var e,i={},r=0,n=t.length;n>r;r++)e=t[r].left+""+t[r].top,i[e]||(i[e]=t[r]);var o=[];for(e in i)o.push(i[e]);return o},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]);for(var i=0,r=this.sprayChunkPoints.length;r>i;i++){var n=this.sprayChunkPoints[i];void 0!==n.opacity&&(t.globalAlpha=n.opacity),t.fillRect(n.x,n.y,n.width,n.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e,i,r,n=this.width/2,o=0;this.density>o;o++){e=fabric.util.getRandomInt(t.x-n,t.x+n),i=fabric.util.getRandomInt(t.y-n,t.y+n),r=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var s=new fabric.Point(e,i);s.width=r,this.randomOpacity&&(s.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(s)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=fabric.document.createElement("canvas"),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return(this.getPatternSrc+"").replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),e}}),function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,r=Math.atan2,n=Math.abs;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(t){var e=this._currentTransform;e.target.set({scaleX:e.original.scaleX,scaleY:e.original.scaleY,left:e.original.left,top:e.original.top}),this._shouldCenterTransform(t,e.target)?"rotate"===e.action?this._setOriginToCenter(e.target):("center"!==e.originX&&(e.mouseXSign="right"===e.originX?-1:1),"center"!==e.originY&&(e.mouseYSign="bottom"===e.originY?-1:1),e.originX="center",e.originY="center"):(e.originX=e.original.originX,e.originY=e.original.originY)},containsPoint:function(t,e){var i=this.getPointer(t,!0);return e.containsPoint(this._normalizePointer(e,i))||e._findTargetCorner(i)},_normalizePointer:function(t,e){var i,r=this.getActiveGroup(),n=e.x,o=e.y,s=r&&"group"!==t.type&&r.contains(t);return s&&(i=new fabric.Point(r.left,r.top),i=fabric.util.transformPoint(i,this.viewportTransform,!0),n-=i.x,o-=i.y),{x:n,y:o}},isTargetTransparent:function(t,e,i){var r=t.hasBorders,n=t.transparentCorners;t.hasBorders=t.transparentCorners=!1,this._draw(this.contextCache,t),t.hasBorders=r,t.transparentCorners=n;var o=fabric.util.isTransparent(this.contextCache,e,i,this.targetFindTolerance);return this.clearContext(this.contextCache),o},_shouldClearSelection:function(t,e){var i=this.getActiveGroup(),r=this.getActiveObject();return!e||e&&i&&!i.contains(e)&&i!==e&&!t.shiftKey||e&&!e.evented||e&&!e.selectable&&r&&r!==e},_shouldCenterTransform:function(t,e){if(e){var i,r=this._currentTransform;return"scale"===r.action||"scaleX"===r.action||"scaleY"===r.action?i=this.centeredScaling||e.centeredScaling:"rotate"===r.action&&(i=this.centeredRotation||e.centeredRotation),i?!t.altKey:t.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(i.y="top"),i},_getActionFromCorner:function(t,e){var i="drag";return e&&(i="ml"===e||"mr"===e?"scaleX":"mt"===e||"mb"===e?"scaleY":"mtr"===e?"rotate":"scale"),i},_setupCurrentTransform:function(t,i){if(i){var r=this.getPointer(t),n=i._findTargetCorner(this.getPointer(t,!0)),o=this._getActionFromCorner(i,n),s=this._getOriginFromCorner(i,n);this._currentTransform={target:i,action:o,scaleX:i.scaleX,scaleY:i.scaleY,offsetX:r.x-i.left,offsetY:r.y-i.top,originX:s.x,originY:s.y,ex:r.x,ey:r.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,originX:s.x,originY:s.y},this._resetCurrentTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform.target;i.get("lockMovementX")||i.set("left",t-this._currentTransform.offsetX),i.get("lockMovementY")||i.set("top",e-this._currentTransform.offsetY)},_scaleObject:function(t,e,i){var r=this._currentTransform,n=r.target,o=n.get("lockScalingX"),s=n.get("lockScalingY"),a=n.get("lockScalingFlip");if(!o||!s){var c=n.translateToOriginPoint(n.getCenterPoint(),r.originX,r.originY),l=n.toLocalPoint(new fabric.Point(t,e),r.originX,r.originY);this._setLocalMouse(l,r),this._setObjectScale(l,r,o,s,i,a),n.setPositionByOrigin(c,r.originX,r.originY)}},_setObjectScale:function(t,e,i,r,n,o){var s=e.target,a=!1,c=!1,l=s.stroke?s.strokeWidth:0;e.newScaleX=t.x/(s.width+l/2),e.newScaleY=t.y/(s.height+l/2),o&&0>=e.newScaleX&&s.scaleX>e.newScaleX&&(a=!0),o&&0>=e.newScaleY&&s.scaleY>e.newScaleY&&(c=!0),"equally"!==n||i||r?n?"x"!==n||s.get("lockUniScaling")?"y"!==n||s.get("lockUniScaling")||c||r||s.set("scaleY",e.newScaleY):a||i||s.set("scaleX",e.newScaleX):(a||i||s.set("scaleX",e.newScaleX),c||r||s.set("scaleY",e.newScaleY)):a||c||this._scaleObjectEqually(t,s,e),a||c||this._flipObject(e,n)},_scaleObjectEqually:function(t,e,i){var r=t.y+t.x,n=e.stroke?e.strokeWidth:0,o=(e.height+n/2)*i.original.scaleY+(e.width+n/2)*i.original.scaleX;i.newScaleX=i.original.scaleX*r/o,i.newScaleY=i.original.scaleY*r/o,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY)},_flipObject:function(t,e){0>t.newScaleX&&"y"!==e&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),0>t.newScaleY&&"x"!==e&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&0>(t.x*=2*e.mouseXSign)&&(e.mouseXSign=-e.mouseXSign),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&0>(t.y*=2*e.mouseYSign)&&(e.mouseYSign=-e.mouseYSign),n(t.x)>i.padding?0>t.x?t.x+=i.padding:t.x-=i.padding:t.x=0,n(t.y)>i.padding?0>t.y?t.y+=i.padding:t.y-=i.padding:t.y=0},_rotateObject:function(t,e){var n=this._currentTransform;if(!n.target.get("lockRotation")){var o=r(n.ey-n.top,n.ex-n.left),s=r(e-n.top,t-n.left),a=i(s-o+n.theta);0>a&&(a=360+a),n.target.angle=a%360}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.setAngle(0)},_drawSelection:function(){var t=this.contextTop,e=this._groupSelector,i=e.left,r=e.top,o=n(i),s=n(r);if(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(r>0?0:-r),o,s),t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1){var a=e.ex+.5-(i>0?0:o),c=e.ey+.5-(r>0?0:s);t.beginPath(),fabric.util.drawDashedLine(t,a,c,a+o,c,this.selectionDashArray),fabric.util.drawDashedLine(t,a,c+s-1,a+o,c+s-1,this.selectionDashArray),fabric.util.drawDashedLine(t,a,c,a,c+s,this.selectionDashArray),fabric.util.drawDashedLine(t,a+o-1,c,a+o-1,c+s,this.selectionDashArray),t.closePath(),t.stroke()}else t.strokeRect(e.ex+.5-(i>0?0:o),e.ey+.5-(r>0?0:s),o,s)},_isLastRenderedObject:function(t){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(t,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(t,!0))},findTarget:function(t,e){if(!this.skipTargetFind){if(this._isLastRenderedObject(t))return this.lastRenderedObjectWithControlsAboveOverlay;var i=this.getActiveGroup();if(i&&!e&&this.containsPoint(t,i))return i;var r=this._searchPossibleTargets(t);return this._fireOverOutEvents(r),r}},_fireOverOutEvents:function(t){t?this._hoveredTarget!==t&&(this.fire("mouse:over",{target:t}),t.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=t):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&this.containsPoint(t,e)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,i.x,i.y))return!0}},_searchPossibleTargets:function(t){for(var e,i=this.getPointer(t,!0),r=this._objects.length;r--;)if(!this._objects[r].group&&this._checkTarget(t,this._objects[r],i)){this.relatedTarget=this._objects[r],e=this._objects[r];break}return e},getPointer:function(e,i,r){r||(r=this.upperCanvasEl);var n,o=t(e,r),s=r.getBoundingClientRect(),a=s.width||0,c=s.height||0;return a&&c||("top"in s&&"bottom"in s&&(c=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(a=Math.abs(s.right-s.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,i||(o=fabric.util.transformPoint(o,fabric.util.invertTransform(this.viewportTransform))),n=0===a||0===c?{width:1,height:1}:{width:r.width/a,height:r.height/c},{x:o.x*n.width,y:o.y*n.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.getWidth()||t.width,i=this.getHeight()||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(t){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=t,t.set("active",!0)},setActiveObject:function(t,e){return this._setActiveObject(t),this.renderAll(),this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(t){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:t}),this},_setActiveGroup:function(t){this._activeGroup=t,t&&t.set("active",!0)},setActiveGroup:function(t,e){return this._setActiveGroup(t),t&&(this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var t=this.getActiveGroup();t&&t.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(t){return this._discardActiveGroup(),this.fire("selection:cleared",{e:t}),this},deactivateAll:function(){for(var t=this.getObjects(),e=0,i=t.length;i>e;e++)t[e].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(t){var e=this.getActiveGroup()||this.getActiveObject();return e&&this.fire("before:selection:cleared",{target:e,e:t}),this.deactivateAll(),e&&this.fire("selection:cleared",{e:t}),this},drawControls:function(t){var e=this.getActiveGroup();e?this._drawGroupControls(t,e):this._drawObjectsControls(t)},_drawGroupControls:function(t,e){e._renderControls(t)},_drawObjectsControls:function(t){for(var e=0,i=this._objects.length;i>e;++e)this._objects[e]&&this._objects[e].active&&(this._objects[e]._renderControls(t),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[e])}});for(var o in fabric.StaticCanvas)"prototype"!==o&&(fabric.Canvas[o]=fabric.StaticCanvas[o]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=fabric.util.addListener,i=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),e(fabric.window,"resize",this._onResize),e(this.upperCanvasEl,"mousedown",this._onMouseDown),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"mousewheel",this._onMouseWheel),e(this.upperCanvasEl,"touchstart",this._onMouseDown),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mousewheel",this._onMouseWheel),i(this.upperCanvasEl,"touchstart",this._onMouseDown),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t,e){this.__onMouseWheel&&this.__onMouseWheel(t,e)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onMouseDown:function(t){this.__onMouseDown(t),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"touchend",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove),i(fabric.document,"touchmove",this._onMouseMove),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===t.type){var r=this;setTimeout(function(){e(r.upperCanvasEl,"mousedown",r._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this.getActiveGroup()||this.getActiveObject();return!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);this._currentTransform?(this._finalizeCurrentTransform(),e=this._currentTransform.target):e=this.findTarget(t,!0);var i=this._shouldRender(e,this.getPointer(t));this._maybeGroupObjects(t),e&&(e.isMoving=!1),i&&this.renderAll(),this._handleCursorAndEvent(t,e)},_handleCursorAndEvent:function(t,e){this._setCursorFromEvent(t,e);var i=this;setTimeout(function(){i._setCursorFromEvent(t,e)},50),this.fire("mouse:up",{target:e,e:t}),e&&e.fire("mouseup",{e:t})},_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.setCoords(),this.stateful&&e.hasStateChanged()&&(this.fire("object:modified",{target:e}),e.fire("modified")),this._restoreOriginXY(e)},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=fabric.util.invertTransform(this.viewportTransform);this.freeDrawingBrush.onMouseDown(fabric.util.transformPoint(this.getPointer(t,!0),e)),this.fire("mouse:down",{e:t});var i=this.findTarget(t);void 0!==i&&i.fire("mousedown",{e:t,target:i})},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=fabric.util.invertTransform(this.viewportTransform);this.freeDrawingBrush.onMouseMove(fabric.util.transformPoint(this.getPointer(t,!0),e))}this.setCursor(this.freeDrawingCursor),this.fire("mouse:move",{e:t});var i=this.findTarget(t);void 0!==i&&i.fire("mousemove",{e:t,target:i})},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:t});var e=this.findTarget(t);void 0!==e&&e.fire("mouseup",{e:t,target:e})},__onMouseDown:function(t){if(("which"in t?1===t.which:1===t.button)||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._currentTransform){var e=this.findTarget(t),i=this.getPointer(t,!0);this._previousPointer=i;var r=this._shouldRender(e,i),n=this._shouldGroup(t,e);this._shouldClearSelection(t,e)?this._clearSelection(t,e,i):n&&(this._handleGrouping(t,e),e=this.getActiveGroup()),e&&e.selectable&&!n&&(this._beforeTransform(t,e),this._setupCurrentTransform(t,e)),r&&this.renderAll(),this.fire("mouse:down",{target:e,e:t}),e&&e.fire("mousedown",{e:t})}}},_beforeTransform:function(t,e){this.stateful&&e.saveState(),e._findTargetCorner(this.getPointer(t))&&this.onBeforeScaleRotate(e),e!==this.getActiveGroup()&&e!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(e,t))},_clearSelection:function(t,e,i){this.deactivateAllWithDispatch(t),e&&e.selectable?this.setActiveObject(e,t):this.selection&&(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0})},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(void 0===t.touches||1>=t.touches.length){var r=this._groupSelector;r?(i=this.getPointer(t,!0),r.left=i.x-r.ex,r.top=i.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),!e||e&&!e.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(t,e)),this.fire("mouse:move",{target:e,e:t}),e&&e.fire("mousemove",{e:t})}},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),this.renderAll()},_performTransformAction:function(t,e,i){var r=i.x,n=i.y,o=e.target,s=e.action;"rotate"===s?(this._rotateObject(r,n),this._fire("rotating",o,t)):"scale"===s?(this._onScale(t,e,r,n),this._fire("scaling",o,t)):"scaleX"===s?(this._scaleObject(r,n,"x"),this._fire("scaling",o,t)):"scaleY"===s?(this._scaleObject(r,n,"y"),this._fire("scaling",o,t)):(this._translateObject(r,n),this._fire("moving",o,t),this.setCursor(this.moveCursor))},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(t,e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(t),e.reset=!0)}},_onScale:function(t,e,i,r){!t.shiftKey&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(t,e.target),e.currentAction="scaleEqually",this._scaleObject(i,r,"equally")):(e.currentAction="scale",this._scaleObject(i,r))},_setCursorFromEvent:function(t,e){if(!e||!e.selectable)return this.setCursor(this.defaultCursor),!1;var i=this.getActiveGroup(),r=e._findTargetCorner&&(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));return r?this._setCornerCursor(r,e):this.setCursor(e.hoverCursor||this.hoverCursor),!0},_setCornerCursor:function(e,i){if(e in t)this.setCursor(this._getRotatedCornerCursor(e,i));else{if("mtr"!==e||!i.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(e,i){var r=Math.round(i.getAngle()%360/45);return 0>r&&(r+=8),r+=t[e],r%=8,this.cursorMap[r]}})}(),function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this.getActiveObject();return t.shiftKey&&(this.getActiveGroup()||i&&i!==e)&&this.selection},_handleGrouping:function(t,e){(e!==this.getActiveGroup()||(e=this.findTarget(t,!0))&&!e.isType("group"))&&(this.getActiveGroup()?this._updateActiveGroup(e,t):this._createActiveGroup(e,t),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(t,e){var i=this.getActiveGroup();if(i.contains(t)){if(i.removeWithUpdate(t),this._resetObjectTransform(i),t.set("active",!1),1===i.size())return this.discardActiveGroup(e),void this.setActiveObject(i.item(0))}else i.addWithUpdate(t),this._resetObjectTransform(i);this.fire("selection:created",{target:i,e:e}),i.set("active",!0)},_createActiveGroup:function(t,e){if(this._activeObject&&t!==this._activeObject){var i=this._createGroup(t);i.addWithUpdate(),this.setActiveGroup(i),this._activeObject=null,this.fire("selection:created",{target:i,e:e})}t.set("active",!0)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t);return new fabric.Group(i?[this._activeObject,t]:[t,this._activeObject],{canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects();1===e.length?this.setActiveObject(e[0],t):e.length>1&&(e=new fabric.Group(e.reverse(),{canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,t),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){for(var i,r=[],n=this._groupSelector.ex,o=this._groupSelector.ey,s=n+this._groupSelector.left,a=o+this._groupSelector.top,c=new fabric.Point(t(n,s),t(o,a)),l=new fabric.Point(e(n,s),e(o,a)),u=n===s&&o===a,h=this._objects.length;h--&&!((i=this._objects[h])&&i.selectable&&i.visible&&(i.intersectsWithRect(c,l)||i.isContainedWithinRect(c,l)||i.containsPoint(c)||i.containsPoint(l))&&(i.set("active",!0),r.push(i),u)););return r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t);var e=this.getActiveGroup();e&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,r=t.multiplier||1,n={left:t.left,top:t.top,width:t.width,height:t.height};return 1!==r?this.__toDataURLWithMultiplier(e,i,n,r):this.__toDataURL(e,i,n)},__toDataURL:function(t,e,i){this.renderAll(!0);var r=this.upperCanvasEl||this.lowerCanvasEl,n=this.__getCroppedCanvas(r,i);"jpg"===t&&(t="jpeg");var o=fabric.StaticCanvas.supports("toDataURLWithQuality")?(n||r).toDataURL("image/"+t,e):(n||r).toDataURL("image/"+t);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),n&&(n=null),o},__getCroppedCanvas:function(t,e){var i,r;return("left"in e||"top"in e||"width"in e||"height"in e)&&(i=fabric.util.createCanvasElement(),r=i.getContext("2d"),i.width=e.width||this.width,i.height=e.height||this.height,r.drawImage(t,-e.left||0,-e.top||0)),i},__toDataURLWithMultiplier:function(t,e,i,r){var n=this.getWidth(),o=this.getHeight(),s=n*r,a=o*r,c=this.getActiveObject(),l=this.getActiveGroup(),u=this.contextTop||this.contextContainer;r>1&&this.setWidth(s).setHeight(a),u.scale(r,r),i.left&&(i.left*=r),i.top&&(i.top*=r),i.width?i.width*=r:1>r&&(i.width=s),i.height?i.height*=r:1>r&&(i.height=a),l?this._tempRemoveBordersControlsFromGroup(l):c&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var h=this.__toDataURL(t,e,i);return this.width=n,this.height=o,u.scale(1/r,1/r),this.setWidth(n).setHeight(o),l?this._restoreBordersControlsOnGroup(l):c&&this.setActiveObject&&this.setActiveObject(c),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),h},toDataURLWithMultiplier:function(t,e,i){return this.toDataURL({format:t,multiplier:e,quality:i})},_tempRemoveBordersControlsFromGroup:function(t){t.origHasControls=t.hasControls,t.origBorderColor=t.borderColor,t.hasControls=!0,t.borderColor="rgba(0,0,0,0)",t.forEachObject(function(t){t.origBorderColor=t.borderColor,t.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(t){t.hideControls=t.origHideControls,t.borderColor=t.origBorderColor,t.forEachObject(function(t){t.borderColor=t.origBorderColor,delete t.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var r="string"==typeof t?JSON.parse(t):t;this.clear();var n=this;return this._enlivenObjects(r.objects,function(){n._setBgOverlay(r,e)},i),this}},_setBgOverlay:function(t,e){var i=this,r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var n=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&(i.renderAll(),e&&e())};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,n),this.__setBgOverlay("overlayImage",t.overlayImage,r,n),this.__setBgOverlay("backgroundColor",t.background,r,n),this.__setBgOverlay("overlayColor",t.overlay,r,n),n()},__setBgOverlay:function(t,e,i,r){var n=this;if(!e)return void(i[t]=!0);"backgroundImage"===t||"overlayImage"===t?fabric.Image.fromObject(e,function(e){n[t]=e,i[t]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,r&&r()})},_enlivenObjects:function(t,e,i){var r=this;if(!t||0===t.length)return void(e&&e());var n=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(t,function(t){t.forEach(function(t,e){r.insertAt(t,e,!0)}),r.renderOnAddRemove=n,e&&e()},null,i)},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(r){i(r.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.getWidth(),e.height=this.getHeight();var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.toFixed,n=e.util.string.capitalize,o=e.util.degreesToRadians,s=e.StaticCanvas.supports("setLineDash");e.Object||(e.Object=e.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof e.Gradient||this.set("fill",new e.Gradient(t.fill))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof e.Pattern||this.set("fill",new e.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof e.Pattern||this.set("stroke",new e.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var i=e.util.getFunctionBody(t.clipTo);void 0!==i&&(this.clipTo=Function("ctx",i))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},transform:function(t,e){var i=e?this._getLeftTopCoords():this.getCenterPoint();t.translate(i.x,i.y),t.rotate(o(this.angle)),t.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,n={type:this.type,originX:this.originX,originY:this.originY,left:r(this.left,i),top:r(this.top,i),width:r(this.width,i),height:r(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,i),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,i),scaleX:r(this.scaleX,i),scaleY:r(this.scaleY,i),angle:r(this.getAngle(),i),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&this.clipTo+"",backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};return this.includeDefaultValues||(n=this._removeDefaultValues(n)),e.util.populateWithProperties(this,n,t),n},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype;return i.stateProperties.forEach(function(e){t[e]===i[e]&&delete t[e]}),t},toString:function(){return"#<fabric."+n(this.type)+">"},get:function(t){return this[t]},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"===(void 0===t?"undefined":_typeof(t))?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,i){return("scaleX"===t||"scaleY"===t)&&(i=this._constrainScale(i)),"scaleX"===t&&0>i?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&0>i?(this.flipY=!this.flipY,i*=-1):"width"===t||"height"===t?this.minScaleLimit=r(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==t||!i||i instanceof e.Shadow||(i=new e.Shadow(i)),this[t]=i,this},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(t,i){0===this.width&&0===this.height||!this.visible||(t.save(),this._setupCompositeOperation(t),i||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this._setOpacity(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),this._render(t,i),this.clipTo&&t.restore(),this._removeShadow(t),this._restoreCompositeOperation(t),t.restore())},_setOpacity:function(t){this.group&&this.group._setOpacity(t),t.globalAlpha*=this.opacity},_setStrokeStyles:function(t){this.stroke&&(t.lineWidth=this.strokeWidth,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t,this):this.stroke)},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t,this):this.fill)},_renderControls:function(t,i){if(this.active&&!i){var r=this.getViewportTransform();t.save();var n;this.group&&(n=e.util.transformPoint(this.group.getCenterPoint(),r),t.translate(n.x,n.y),t.rotate(o(this.group.angle))),n=e.util.transformPoint(this.getCenterPoint(),r,null!=this.group),this.group&&(n.x*=this.group.scaleX,n.y*=this.group.scaleY),t.translate(n.x,n.y),t.rotate(o(this.angle)),this.drawBorders(t),this.drawControls(t),t.restore()}},_setShadow:function(t){if(this.shadow){var e=this.canvas&&this.canvas.viewportTransform[0]||1,i=this.canvas&&this.canvas.viewportTransform[3]||1;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur*(e+i)*(this.scaleX+this.scaleY)/4,t.shadowOffsetX=this.shadow.offsetX*e*this.scaleX,t.shadowOffsetY=this.shadow.offsetY*i*this.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.gradientTransform){t.transform.apply(t,this.fill.gradientTransform)}this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t)}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(t.save(),this.strokeDashArray)1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),s?(t.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(t)):this._renderDashedStroke&&this._renderDashedStroke(t),t.stroke();else{if(this.stroke.gradientTransform){t.transform.apply(t,this.stroke.gradientTransform)}this._stroke?this._stroke(t):t.stroke()}this._removeShadow(t),t.restore()}},clone:function(t,i){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(i),t):new e.Object(this.toObject(i))},cloneAsImage:function(t){var i=this.toDataURL();return e.util.loadImage(i,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),r=this.getBoundingRect();i.width=r.width,i.height=r.height,e.util.wrapElement(i,"div");var n=new e.StaticCanvas(i);"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(n.backgroundColor="#fff");var o={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new e.Point(i.width/2,i.height/2),"center","center");var s=this.canvas;n.add(this);var a=n.toDataURL(t);return this.set(o).setCoords(),this.canvas=s,n.dispose(),n=null,a},isType:function(t){return this.type===t},complexity:function(){return 0},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var r={colorStops:[]};r.type=i.type||(i.r1||i.r2?"radial":"linear"),r.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(r.coords.r1=i.r1,r.coords.r2=i.r2);for(var n in i.colorStops){var o=new e.Color(i.colorStops[n]);r.colorStops.push({offset:n,color:o.toRgb(),opacity:o.getAlpha()})}return this.set(t,e.Gradient.forObject(this,r))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);var i=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:e.x-i.x,y:e.y-i.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(this._prevGlobalCompositeOperation=t.globalCompositeOperation,t.globalCompositeOperation=this.globalCompositeOperation)},_restoreCompositeOperation:function(t){this.globalCompositeOperation&&this._prevGlobalCompositeOperation&&(t.globalCompositeOperation=this._prevGlobalCompositeOperation)}}),e.util.createAccessors(e.Object),e.Object.prototype.rotate=e.Object.prototype.setAngle,i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.__uid=0)}(exports),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(e,i,r){var n=e.x,o=e.y,s=this.stroke?this.strokeWidth:0;return"left"===i?n=e.x+(this.getWidth()+s*this.scaleX)/2:"right"===i&&(n=e.x-(this.getWidth()+s*this.scaleX)/2),"top"===r?o=e.y+(this.getHeight()+s*this.scaleY)/2:"bottom"===r&&(o=e.y-(this.getHeight()+s*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(n,o),e,t(this.angle))},translateToOriginPoint:function(e,i,r){var n=e.x,o=e.y,s=this.stroke?this.strokeWidth:0;return"left"===i?n=e.x-(this.getWidth()+s*this.scaleX)/2:"right"===i&&(n=e.x+(this.getWidth()+s*this.scaleX)/2),"top"===r?o=e.y-(this.getHeight()+s*this.scaleY)/2:"bottom"===r&&(o=e.y+(this.getHeight()+s*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(n,o),e,t(this.angle))},getCenterPoint:function(){return this.translateToCenterPoint(new fabric.Point(this.left,this.top),this.originX,this.originY)},getPointByOrigin:function(t,e){return this.translateToOriginPoint(this.getCenterPoint(),t,e)},toLocalPoint:function(e,i,r){var n,o,s=this.getCenterPoint(),a=this.stroke?this.strokeWidth:0;return i&&r?(n="left"===i?s.x-(this.getWidth()+a*this.scaleX)/2:"right"===i?s.x+(this.getWidth()+a*this.scaleX)/2:s.x,o="top"===r?s.y-(this.getHeight()+a*this.scaleY)/2:"bottom"===r?s.y+(this.getHeight()+a*this.scaleY)/2:s.y):(n=this.left,o=this.top),fabric.util.rotatePoint(new fabric.Point(e.x,e.y),s,-t(this.angle)).subtractEquals(new fabric.Point(n,o))},setPositionByOrigin:function(t,e,i){var r=this.translateToCenterPoint(t,e,i),n=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(e){var i=t(this.angle),r=this.getWidth()/2,n=Math.cos(i)*r,o=Math.sin(i)*r,s=this.getWidth(),a=Math.cos(i)*s,c=Math.sin(i)*s;"center"===this.originX&&"left"===e||"right"===this.originX&&"center"===e?(this.left-=n,this.top-=o):"left"===this.originX&&"center"===e||"center"===this.originX&&"right"===e?(this.left+=n,this.top+=o):"left"===this.originX&&"right"===e?(this.left+=a,this.top+=c):"right"===this.originX&&"left"===e&&(this.left-=a,this.top-=c),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})}(),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(t,e){var i=this.oCoords,r=new fabric.Point(i.tl.x,i.tl.y),n=new fabric.Point(i.tr.x,i.tr.y),o=new fabric.Point(i.bl.x,i.bl.y),s=new fabric.Point(i.br.x,i.br.y);return"Intersection"===fabric.Intersection.intersectPolygonRectangle([r,n,s,o],t,e).status},intersectsWithObject:function(t){function e(t){return{tl:new fabric.Point(t.tl.x,t.tl.y),tr:new fabric.Point(t.tr.x,t.tr.y),bl:new fabric.Point(t.bl.x,t.bl.y),br:new fabric.Point(t.br.x,t.br.y)}}var i=e(this.oCoords),r=e(t.oCoords);return"Intersection"===fabric.Intersection.intersectPolygonPolygon([i.tl,i.tr,i.br,i.bl],[r.tl,r.tr,r.br,r.bl]).status},isContainedWithinObject:function(t){var e=t.getBoundingRect();return this.isContainedWithinRect(new fabric.Point(e.left,e.top),new fabric.Point(e.left+e.width,e.top+e.height))},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return!(t.x>i.left||i.left+i.width>e.x||t.y>i.top||i.top+i.height>e.y)},containsPoint:function(t){var e=this._getImageLines(this.oCoords),i=this._findCrossPoints(t,e);return 0!==i&&i%2==1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,r,n,o,s,a,c=0;for(var l in e)if(a=e[l],!(t.y>a.o.y&&t.y>a.d.y||a.o.y>=t.y&&a.d.y>=t.y||(a.o.x!==a.d.x||t.x>a.o.x?(i=0,r=(a.d.y-a.o.y)/(a.d.x-a.o.x),n=t.y-i*t.x,o=a.o.y-r*a.o.x,s=-(n-o)/(i-r),n+i*s):(s=a.o.x,t.y),t.x>s||(c+=1),2!==c)))break;return c},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var t=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],e=fabric.util.array.min(t),i=fabric.util.array.max(t),r=Math.abs(e-i),n=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],o=fabric.util.array.min(n),s=fabric.util.array.max(n);return{left:e,top:o,width:r,height:Math.abs(o-s)}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?0>t?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return t=this._constrainScale(t),0>t&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){return this.scale(t/this.width/(this.getBoundingRectWidth()/this.getWidth()))},scaleToHeight:function(t){return this.scale(t/this.height/(this.getBoundingRectHeight()/this.getHeight()))},setCoords:function(){var e=t(this.angle),i=this.getViewportTransform(),r=function(t){return fabric.util.transformPoint(t,i)},n=this._calculateCurrentDimensions(!1),o=n.x,s=n.y;0>o&&(o=Math.abs(o));var a=Math.sqrt(Math.pow(o/2,2)+Math.pow(s/2,2)),c=Math.atan(isFinite(s/o)?s/o:0),l=Math.cos(c+e)*a,u=Math.sin(c+e)*a,h=Math.sin(e),f=Math.cos(e),d=this.getCenterPoint(),p=new fabric.Point(o,s),g=new fabric.Point(d.x-l,d.y-u),v=new fabric.Point(g.x+p.x*f,g.y+p.x*h),y=r(new fabric.Point(g.x-p.y*h,g.y+p.y*f)),m=r(new fabric.Point(v.x-p.y*h,v.y+p.y*f)),b=r(g),_=r(v),x=new fabric.Point((b.x+y.x)/2,(b.y+y.y)/2),w=new fabric.Point((_.x+b.x)/2,(_.y+b.y)/2);return this.oCoords={tl:b,tr:_,br:m,bl:y,ml:x,mt:w,mr:new fabric.Point((m.x+_.x)/2,(m.y+_.y)/2),mb:new fabric.Point((m.x+y.x)/2,(m.y+y.y)/2),mtr:new fabric.Point(w.x+h*this.rotatingPointOffset,w.y-f*this.rotatingPointOffset)},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var t=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",e=this.fillRule,i=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",r=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"",o=this.strokeLineCap?this.strokeLineCap:"butt",s=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",l=this.visible?"":" visibility: hidden;";return"stroke: "+i+"; stroke-width: "+r+"; stroke-dasharray: "+n+"; stroke-linecap: "+o+"; stroke-linejoin: "+s+"; stroke-miterlimit: "+a+"; fill: "+t+"; fill-rule: "+e+"; opacity: "+c+";"+(this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":"")+l},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var t=fabric.util.toFixed,e=this.getAngle(),i=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],r=fabric.util.transformPoint(this.getCenterPoint(),i),n=fabric.Object.NUM_FRACTION_DIGITS,o="path-group"===this.type?"":"translate("+t(r.x,n)+" "+t(r.y,n)+")",s=0!==e?" rotate("+t(e,n)+")":"",a=1===this.scaleX&&1===this.scaleY&&1===i[0]&&1===i[3]?"":" scale("+t(this.scaleX*i[0],n)+" "+t(this.scaleY*i[3],n)+")",c="path-group"===this.type?this.width*i[0]:0,l=this.flipX?" matrix(-1 0 0 1 "+c+" 0) ":"",u="path-group"===this.type?this.height*i[3]:0;return""+o+s+a+l+(this.flipY?" matrix(1 0 0 -1 0 "+u+")":"")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(t){return this.get(t)!==this.originalState[t]},this)},saveState:function(t){return this.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),t&&t.stateProperties&&t.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var t=fabric.util.degreesToRadians,e=function(){return"undefined"!=typeof G_vmlCanvasManager};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e,i,r=t.x,n=t.y;for(var o in this.oCoords)if(this.isControlVisible(o)&&("mtr"!==o||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==o&&"mr"!==o&&"mb"!==o&&"ml"!==o)&&(i=this._getImageLines(this.oCoords[o].corner),0!==(e=this._findCrossPoints({x:r,y:n},i))&&e%2==1))return this.__corner=o,o;return!1},_setCornerCoords:function(){var e,i,r=this.oCoords,n=t(45-this.angle),o=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,s=o*Math.cos(n),a=o*Math.sin(n);for(var c in r)e=r[c].x,i=r[c].y,r[c].corner={tl:{x:e-a,y:i-s},tr:{x:e+s,y:i-a},bl:{x:e-s,y:i+a},br:{x:e+a,y:i+s}}},_calculateCurrentDimensions:function(t){var e=this.getViewportTransform(),i=this.strokeWidth,r=this.width,n=this.height,o="round"===this.strokeLineCap||"square"===this.strokeLineCap,s="line"===this.type&&0===this.width,a="line"===this.type&&0===this.height,c=s||a,l=o&&a||!c,u=o&&s||!c;return s?r=i:a&&(n=i),l&&(r+=0>r?-i:i),u&&(n+=0>n?-i:i),r=r*this.scaleX+2*this.padding,n=n*this.scaleY+2*this.padding,t?fabric.util.transformPoint(new fabric.Point(r,n),e,!0):{x:r,y:n}},drawBorders:function(t){if(!this.hasBorders)return this;t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=this.borderColor,t.lineWidth=1/this.borderScaleFactor;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y;if(this.group&&(i*=this.group.scaleX,r*=this.group.scaleY),t.strokeRect(~~(-i/2)-.5,~~(-r/2)-.5,1+~~i,1+~~r),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var n=-r/2;t.beginPath(),t.moveTo(0,n),t.lineTo(0,n-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this._calculateCurrentDimensions(!0),i=e.x,r=e.y,n=-i/2,o=-r/2,s=this.cornerSize/2,a=this.transparentCorners?"strokeRect":"fillRect";return t.save(),t.lineWidth=1,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=t.fillStyle=this.cornerColor,this._drawControl("tl",t,a,n-s,o-s),this._drawControl("tr",t,a,n+i-s,o-s),this._drawControl("bl",t,a,n-s,o+r-s),this._drawControl("br",t,a,n+i-s,o+r-s),this.get("lockUniScaling")||(this._drawControl("mt",t,a,n+i/2-s,o-s),this._drawControl("mb",t,a,n+i/2-s,o+r-s),this._drawControl("mr",t,a,n+i-s,o+r/2-s),this._drawControl("ml",t,a,n-s,o+r/2-s)),this.hasRotatingPoint&&this._drawControl("mtr",t,a,n+i/2-s,o-this.rotatingPointOffset-s),t.restore(),this},_drawControl:function(t,i,r,n,o){if(this.isControlVisible(t)){var s=this.cornerSize;e()||this.transparentCorners||i.clearRect(n,o,s,s),i[r](n,o,s,s)}},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),function(t){function e(t,e){var i=t.origin,r=t.axis1,n=t.axis2,o=t.dimension,s=e.nearest,a=e.center,c=e.farthest;return function(){switch(this.get(i)){case s:return Math.min(this.get(r),this.get(n));case a:return Math.min(this.get(r),this.get(n))+.5*this.get(o);case c:return Math.max(this.get(r),this.get(n))}}}var i=t.fabric||(t.fabric={}),r=i.util.object.extend,n={x1:1,x2:1,y1:1,y2:1},o=i.StaticCanvas.supports("setLineDash");if(i.Line)return void i.warn("fabric.Line is already defined");i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(t,e){e=e||{},t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==n[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t,e){if(t.beginPath(),e){var i=this.getCenterPoint();t.translate(i.x-this.strokeWidth/2,i.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&o){var r=this.calcLinePoints();t.moveTo(r.x1,r.y1),t.lineTo(r.x2,r.y2)}t.lineWidth=this.strokeWidth;var n=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=n},_renderDashedStroke:function(t){var e=this.calcLinePoints();t.beginPath(),i.util.drawDashedLine(t,e.x1,e.y1,e.x2,e.y2,this.strokeDashArray),t.closePath()},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},calcLinePoints:function(){var t=this.x1>this.x2?1:-1,e=this.y1>this.y2?1:-1;return{x1:t*this.width*.5,x2:t*this.width*-.5,y1:e*this.height*.5,y2:e*this.height*-.5}},toSVG:function(t){var e=this._createBaseSVGMarkup(),i={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};return this.group&&"path-group"===this.group.type||(i=this.calcLinePoints()),e.push("<line ",'x1="',i.x1,'" y1="',i.y1,'" x2="',i.x2,'" y2="',i.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e){var n=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES);return new i.Line([n.x1||0,n.y1||0,n.x2||0,n.y2||0],r(n,e))},i.Line.fromObject=function(t){return new i.Line([t.x1,t.y1,t.x2,t.y2],t)}}(exports),function(t){function e(t){return"radius"in t&&t.radius>=0}var i=t.fabric||(t.fabric={}),r=Math.PI,n=i.util.object.extend;if(i.Circle)return void i.warn("fabric.Circle is already defined.");i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("radius",t.radius||0),this.startAngle=t.startAngle||this.startAngle,this.endAngle=t.endAngle||this.endAngle},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return n(this.callSuper("toObject",t),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,n=0,o=(this.endAngle-this.startAngle)%(2*r);if(0===o)this.group&&"path-group"===this.group.type&&(i=this.left+this.radius,n=this.top+this.radius),e.push("<circle ",'cx="'+i+'" cy="'+n+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');else{var s=Math.cos(this.startAngle)*this.radius,a=Math.sin(this.startAngle)*this.radius,c=Math.cos(this.endAngle)*this.radius,l=Math.sin(this.endAngle)*this.radius;e.push('<path d="M '+s+" "+a," A "+this.radius+" "+this.radius," 0 ",+(o>r?"1":"0")+" 1"," "+c+" "+l,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.arc(e?this.left+this.radius:0,e?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1),this._renderFill(t),this._renderStroke(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){this.radius=t,this.set("width",2*t).set("height",2*t)},complexity:function(){return 1}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,r){r||(r={});var o=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(o))throw Error("value of `r` attribute is required and can not be negative");o.left=o.left||0,o.top=o.top||0;var s=new i.Circle(n(o,r));return s.left-=s.radius,s.top-=s.radius,s},i.Circle.fromObject=function(t){return new i.Circle(t)}}(exports),function(t){var e=t.fabric||(t.fabric={});if(e.Triangle)return void e.warn("fabric.Triangle is already defined");e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("width",t.width||100).set("height",t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=this.width/2,r=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,r,0,-r,this.strokeDashArray),e.util.drawDashedLine(t,0,-r,i,r,this.strokeDashArray),e.util.drawDashedLine(t,i,r,-i,r,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,r=this.height/2;return e.push("<polygon ",'points="',[-i+" "+r,"0 "+-r,i+" "+r].join(","),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Triangle.fromObject=function(t){return new e.Triangle(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=2*Math.PI,r=e.util.object.extend;if(e.Ellipse)return void e.warn("fabric.Ellipse is already defined.");e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("rx",t.rx||0),this.set("ry",t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return r(this.callSuper("toObject",t),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,r=0;return this.group&&"path-group"===this.group.type&&(i=this.left+this.rx,r=this.top+this.ry),e.push("<ellipse ",'cx="',i,'" cy="',r,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(e?this.left+this.rx:0,e?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,i,!1),t.restore(),this._renderFill(t),this._renderStroke(t)},complexity:function(){return 1}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){i||(i={});var n=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);n.left=n.left||0,n.top=n.top||0;var o=new e.Ellipse(r(n,i));return o.top-=o.ry,o.left-=o.rx,o},e.Ellipse.fromObject=function(t){return new e.Ellipse(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;if(e.Rect)return void console.warn("fabric.Rect is already defined");var r=e.Object.prototype.stateProperties.concat();r.push("rx","ry","x","y"),e.Rect=e.util.createClass(e.Object,{stateProperties:r,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1===this.width&&1===this.height)return void t.fillRect(0,0,1,1);var i=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,n=this.width,o=this.height,s=e?this.left:-this.width/2,a=e?this.top:-this.height/2,c=0!==i||0!==r,l=.4477152502;t.beginPath(),t.moveTo(s+i,a),t.lineTo(s+n-i,a),c&&t.bezierCurveTo(s+n-l*i,a,s+n,a+l*r,s+n,a+r),t.lineTo(s+n,a+o-r),c&&t.bezierCurveTo(s+n,a+o-l*r,s+n-l*i,a+o,s+n-i,a+o),t.lineTo(s+i,a+o),c&&t.bezierCurveTo(s+l*i,a+o,s,a+o-l*r,s,a+o-r),t.lineTo(s,a+r),c&&t.bezierCurveTo(s,a+l*r,s+l*i,a,s+i,a),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=-this.width/2,r=-this.height/2,n=this.width,o=this.height;t.beginPath(),e.util.drawDashedLine(t,i,r,i+n,r,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r,i+n,r+o,this.strokeDashArray),e.util.drawDashedLine(t,i+n,r+o,i,r+o,this.strokeDashArray),e.util.drawDashedLine(t,i,r+o,i,r,this.strokeDashArray),t.closePath()},toObject:function(t){var e=i(this.callSuper("toObject",t),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.left,r=this.top;return this.group&&"path-group"===this.group.type||(i=-this.width/2,r=-this.height/2),e.push("<rect ",'x="',i,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,r){if(!t)return null;r=r||{};var n=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);n.left=n.left||0,n.top=n.top||0;var o=new e.Rect(i(r?e.util.object.clone(r):{},n));return o.visible=o.width>0&&o.height>0,o},e.Rect.fromObject=function(t){return new e.Rect(t)}}(exports),function(t){var e=t.fabric||(t.fabric={});if(e.Polyline)return void e.warn("fabric.Polyline is already defined");e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(t,i){return e.Polygon.prototype.initialize.call(this,t,i)},_calcDimensions:function(){return e.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return e.Polygon.prototype._applyPointOffset.call(this)},toObject:function(t){return e.Polygon.prototype.toObject.call(this,t)},toSVG:function(t){return e.Polygon.prototype.toSVG.call(this,t)},_render:function(t){e.Polygon.prototype.commonRender.call(this,t)&&(this._renderFill(t),this._renderStroke(t))},_renderDashedStroke:function(t){var i,r;t.beginPath();for(var n=0,o=this.points.length;o>n;n++)i=this.points[n],r=this.points[n+1]||i,e.util.drawDashedLine(t,i.x,i.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i){if(!t)return null;i||(i={});var r=e.parsePointsAttribute(t.getAttribute("points")),n=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);return new e.Polyline(r,e.util.object.extend(n,i))},e.Polyline.fromObject=function(t){return new e.Polyline(t.points,t,!0)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max,o=e.util.toFixed;if(e.Polygon)return void e.warn("fabric.Polygon is already defined");e.Polygon=e.util.createClass(e.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._calcDimensions(),"top"in e||(this.top=this.minY),"left"in e||(this.left=this.minX)},_calcDimensions:function(){var t=this.points,e=r(t,"x"),i=r(t,"y"),o=n(t,"x"),s=n(t,"y");this.width=o-e||0,this.height=s-i||0,this.minX=e||0,this.minY=i||0},_applyPointOffset:function(){this.points.forEach(function(t){t.x-=this.minX+this.width/2,t.y-=this.minY+this.height/2},this)},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r=0,n=this.points.length;n>r;r++)e.push(o(this.points[r].x,2),",",o(this.points[r].y,2)," ");return i.push("<",this.type," ",'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(i.join("")):i.join("")},_render:function(t){this.commonRender(t)&&(this._renderFill(t),(this.stroke||this.strokeDashArray)&&(t.closePath(),this._renderStroke(t)))},commonRender:function(t){var e,i=this.points.length;if(!i||isNaN(this.points[i-1].y))return!1;t.beginPath(),this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=null),t.moveTo(this.points[0].x,this.points[0].y);for(var r=0;i>r;r++)e=this.points[r],t.lineTo(e.x,e.y);return!0},_renderDashedStroke:function(t){e.Polyline.prototype._renderDashedStroke.call(this,t),t.closePath()},complexity:function(){return this.points.length}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,r){if(!t)return null;r||(r={});var n=e.parsePointsAttribute(t.getAttribute("points")),o=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);return new e.Polygon(n,i(o,r))},e.Polygon.fromObject=function(t){return new e.Polygon(t.points,t,!0)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.array.min,r=e.util.array.max,n=e.util.object.extend,o=Object.prototype.toString,s=e.util.drawArc,a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};if(e.Path)return void e.warn("fabric.Path is already defined");e.Path=e.util.createClass(e.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(t,e){if(e=e||{},this.setOptions(e),!t)throw Error("`path` argument is required");var i="[object Array]"===o.call(t);(this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi))&&(i||(this.path=this._parsePath()),this._setPositionDimensions(),e.sourcePath&&this.setSourcePath(e.sourcePath))},_setPositionDimensions:function(){var t=this._parseDimensions();this.minX=t.left,this.minY=t.top,this.width=t.width,this.height=t.height,t.left+="center"===this.originX?this.width/2:"right"===this.originX?this.width:0,t.top+="center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0,this.top=this.top||t.top,this.left=this.left||t.left,this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2}},_render:function(t){var e,i,r,n=null,o=0,a=0,c=0,l=0,u=0,h=0,f=-this.pathOffset.x,d=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(f=0,d=0),t.beginPath();for(var p=0,g=this.path.length;g>p;++p){switch(e=this.path[p],e[0]){case"l":c+=e[1],l+=e[2],t.lineTo(c+f,l+d);break;case"L":c=e[1],l=e[2],t.lineTo(c+f,l+d);break;case"h":c+=e[1],t.lineTo(c+f,l+d);break;case"H":c=e[1],t.lineTo(c+f,l+d);break;case"v":l+=e[1],t.lineTo(c+f,l+d);break;case"V":l=e[1],t.lineTo(c+f,l+d);break;case"m":c+=e[1],l+=e[2],o=c,a=l,t.moveTo(c+f,l+d);break;case"M":c=e[1],l=e[2],o=c,a=l,t.moveTo(c+f,l+d);break;case"c":i=c+e[5],r=l+e[6],u=c+e[3],h=l+e[4],t.bezierCurveTo(c+e[1]+f,l+e[2]+d,u+f,h+d,i+f,r+d),c=i,l=r;break;case"C":c=e[5],l=e[6],u=e[3],h=e[4],t.bezierCurveTo(e[1]+f,e[2]+d,u+f,h+d,c+f,l+d);break;case"s":i=c+e[3],r=l+e[4],null===n[0].match(/[CcSs]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.bezierCurveTo(u+f,h+d,c+e[1]+f,l+e[2]+d,i+f,r+d),u=c+e[1],h=l+e[2],c=i,l=r;break;case"S":i=e[3],r=e[4],null===n[0].match(/[CcSs]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.bezierCurveTo(u+f,h+d,e[1]+f,e[2]+d,i+f,r+d),c=i,l=r,u=e[1],h=e[2];break;case"q":i=c+e[3],r=l+e[4],u=c+e[1],h=l+e[2],t.quadraticCurveTo(u+f,h+d,i+f,r+d),c=i,l=r;break;case"Q":i=e[3],r=e[4],t.quadraticCurveTo(e[1]+f,e[2]+d,i+f,r+d),c=i,l=r,u=e[1],h=e[2];break;case"t":i=c+e[1],r=l+e[2],null===n[0].match(/[QqTt]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.quadraticCurveTo(u+f,h+d,i+f,r+d),c=i,l=r;break;case"T":i=e[1],r=e[2],null===n[0].match(/[QqTt]/)?(u=c,h=l):(u=2*c-u,h=2*l-h),t.quadraticCurveTo(u+f,h+d,i+f,r+d),c=i,l=r;break;case"a":s(t,c+f,l+d,[e[1],e[2],e[3],e[4],e[5],e[6]+c+f,e[7]+l+d]),c+=e[6],l+=e[7];break;case"A":s(t,c+f,l+d,[e[1],e[2],e[3],e[4],e[5],e[6]+f,e[7]+d]),c=e[6],l=e[7];break;case"z":case"Z":c=o,l=a,t.closePath()}n=e}this._renderFill(t),this._renderStroke(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=n(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(e.sourcePath=this.sourcePath),this.transformMatrix&&(e.transformMatrix=this.transformMatrix),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.path=this.sourcePath),delete e.sourcePath,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),r="",n=0,o=this.path.length;o>n;n++)e.push(this.path[n].join(" "));var s=e.join(" ");return this.group&&"path-group"===this.group.type||(r=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") "),i.push("<path ",'d="',s,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,r,n,o=[],s=[],l=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,u=0,h=this.path.length;h>u;u++){for(t=this.path[u],r=t.slice(1).trim(),s.length=0;i=l.exec(r);)s.push(i[0]);n=[t.charAt(0)];for(var f=0,d=s.length;d>f;f++)e=parseFloat(s[f]),isNaN(e)||n.push(e);var p=n[0],g=a[p.toLowerCase()],v=c[p]||p;if(n.length-1>g)for(var y=1,m=n.length;m>y;y+=g)o.push([p].concat(n.slice(y,y+g))),p=v;else o.push(n)}return o},_parseDimensions:function(){for(var t,n,o,s,a=[],c=[],l=null,u=0,h=0,f=0,d=0,p=0,g=0,v=0,y=this.path.length;y>v;++v){switch(t=this.path[v],t[0]){case"l":f+=t[1],d+=t[2],s=[];break;case"L":f=t[1],d=t[2],s=[];break;case"h":f+=t[1],s=[];break;case"H":f=t[1],s=[];break;case"v":d+=t[1],s=[];break;case"V":d=t[1],s=[];break;case"m":f+=t[1],d+=t[2],u=f,h=d,s=[];break;case"M":f=t[1],d=t[2],u=f,h=d,s=[];break;case"c":n=f+t[5],o=d+t[6],p=f+t[3],g=d+t[4],s=e.util.getBoundsOfCurve(f,d,f+t[1],d+t[2],p,g,n,o),f=n,d=o;break;case"C":f=t[5],d=t[6],p=t[3],g=t[4],s=e.util.getBoundsOfCurve(f,d,t[1],t[2],p,g,f,d);break;case"s":n=f+t[3],o=d+t[4],null===l[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,f+t[1],d+t[2],n,o),p=f+t[1],g=d+t[2],f=n,d=o;break;case"S":n=t[3],o=t[4],null===l[0].match(/[CcSs]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,t[1],t[2],n,o),f=n,d=o,p=t[1],g=t[2];break;case"q":n=f+t[3],o=d+t[4],p=f+t[1],g=d+t[2],s=e.util.getBoundsOfCurve(f,d,p,g,p,g,n,o),f=n,d=o;break;case"Q":p=t[1],g=t[2],s=e.util.getBoundsOfCurve(f,d,p,g,p,g,t[3],t[4]),f=t[3],d=t[4];break;case"t":n=f+t[1],o=d+t[2],null===l[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,p,g,n,o),f=n,d=o;break;case"T":n=t[1],o=t[2],null===l[0].match(/[QqTt]/)?(p=f,g=d):(p=2*f-p,g=2*d-g),s=e.util.getBoundsOfCurve(f,d,p,g,p,g,n,o),f=n,d=o;break;case"a":s=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6]+f,t[7]+d),f+=t[6],d+=t[7];break;case"A":s=e.util.getBoundsOfArc(f,d,t[1],t[2],t[3],t[4],t[5],t[6],t[7]),f=t[6],d=t[7];break;case"z":case"Z":f=u,d=h}l=t,s.forEach(function(t){a.push(t.x),c.push(t.y)}),a.push(f),c.push(d)}var m=i(a),b=i(c);return{left:m,top:b,width:r(a)-m,height:r(c)-b}}}),e.Path.fromObject=function(t,i){"string"==typeof t.path?e.loadSVGFromURL(t.path,function(r){var n=r[0],o=t.path;delete t.path,e.util.object.extend(n,t),n.setSourcePath(o),i(n)}):i(new e.Path(t.path,t))},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,i,r){var o=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);i&&i(new e.Path(o.d,n(o,r)))},e.Path.async=!0}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.invoke,n=e.Object.prototype.toObject;if(e.PathGroup)return void e.warn("fabric.PathGroup is already defined");e.PathGroup=e.util.createClass(e.Path,{type:"path-group",fill:"",initialize:function(t,e){e=e||{},this.paths=t||[];for(var i=this.paths.length;i--;)this.paths[i].group=this;e.toBeParsed&&(this.parseDimensionsFromPaths(e),delete e.toBeParsed),this.setOptions(e),this.setCoords(),e.sourcePath&&this.setSourcePath(e.sourcePath)},parseDimensionsFromPaths:function(t){for(var i,r,n,o,s,a=[],c=[],l=this.transformMatrix,u=this.paths.length;u--;){n=this.paths[u],o=n.height+n.strokeWidth,s=n.width+n.strokeWidth,i=[{x:n.left,y:n.top},{x:n.left+s,y:n.top},{x:n.left,y:n.top+o},{x:n.left+s,y:n.top+o}];for(var h=0;i.length>h;h++)r=i[h],l&&(r=e.util.transformPoint(r,l,!1)),a.push(r.x),c.push(r.y)}t.width=Math.max.apply(null,a),t.height=Math.max.apply(null,c)},render:function(t){if(this.visible){t.save(),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),t.translate(-this.width/2,-this.height/2);for(var i=0,r=this.paths.length;r>i;++i)this.paths[i].render(t,!0);this.clipTo&&t.restore(),this._removeShadow(t),t.restore()}},_set:function(t,e){if("fill"===t&&e&&this.isSameColor())for(var i=this.paths.length;i--;)this.paths[i]._set(t,e);return this.callSuper("_set",t,e)},toObject:function(t){var e=i(n.call(this,t),{paths:r(this.getObjects(),"toObject",t)});return this.sourcePath&&(e.sourcePath=this.sourcePath),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.paths=this.sourcePath),e},toSVG:function(t){for(var e=this.getObjects(),i=this.getPointByOrigin("left","top"),r="translate("+i.x+" "+i.y+")",n=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),r,this.getSvgTransform(),'" ',">\n"],o=0,s=e.length;s>o;o++)n.push(e[o].toSVG(t));return n.push("</g>\n"),t?t(n.join("")):n.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var t=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(e){return(e.get("fill")||"").toLowerCase()===t})},complexity:function(){return this.paths.reduce(function(t,e){return t+(e&&e.complexity?e.complexity():0)},0)},getObjects:function(){return this.paths}}),e.PathGroup.fromObject=function(t,i){"string"==typeof t.paths?e.loadSVGFromURL(t.paths,function(r){var n=t.paths;delete t.paths;var o=e.util.groupSVGElements(r,t,n);i(o)}):e.util.enlivenObjects(t.paths,function(r){delete t.paths,i(new e.PathGroup(r,t))})},e.PathGroup.async=!0}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.array.min,n=e.util.array.max,o=e.util.array.invoke;if(!e.Group){var s={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",initialize:function(t,e){e=e||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;this.originalState={},this.callSuper("initialize"),e.originX&&(this.originX=e.originX),e.originY&&(this.originY=e.originY),this._calcBounds(),this._updateObjectsCoords(),this.callSuper("initialize",e),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(t){var e=t.getLeft(),i=t.getTop(),r=this.getCenterPoint();t.set({originalLeft:e,originalTop:i,left:e-r.x,top:i-r.y}),t.setCoords(),t.__origHasControls=t.hasControls,t.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),t&&(this._objects.push(t),t.group=this),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(t){t.set("active",!0),t.group=this},removeWithUpdate:function(t){return this._moveFlippedObject(t),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(t){t.group=this},_onObjectRemoved:function(t){delete t.group,t.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(t,e){if(t in this.delegatedProperties)for(var i=this._objects.length;i--;)this._objects[i].set(t,e);this.callSuper("_set",t,e)},toObject:function(t){return i(this.callSuper("toObject",t),{objects:o(this._objects,"toObject",t)})},render:function(t){if(this.visible){t.save(),this.clipTo&&e.util.clipContext(this,t),this.transform(t);for(var i=0,r=this._objects.length;r>i;i++)this._renderObject(this._objects[i],t);this.clipTo&&t.restore(),t.restore()}},_renderControls:function(t,e){this.callSuper("_renderControls",t,e);for(var i=0,r=this._objects.length;r>i;i++)this._objects[i]._renderControls(t)},_renderObject:function(t,e){var i=t.hasRotatingPoint;t.visible&&(t.hasRotatingPoint=!1,t.render(e),t.hasRotatingPoint=i)},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},realizeTransform:function(t){return this._moveFlippedObject(t),this._setObjectPosition(t),t},_moveFlippedObject:function(t){var e=t.get("originX"),i=t.get("originY"),r=t.getCenterPoint();t.set({originX:"center",originY:"center",left:r.x,top:r.y}),this._toggleFlipping(t);var n=t.getPointByOrigin(e,i);return t.set({originX:e,originY:i,left:n.x,top:n.y}),this},_toggleFlipping:function(t){this.flipX&&(t.toggle("flipX"),t.set("left",-t.get("left")),t.setAngle(-t.getAngle())),this.flipY&&(t.toggle("flipY"),t.set("top",-t.get("top")),t.setAngle(-t.getAngle()))},_restoreObjectState:function(t){return this._setObjectPosition(t),t.setCoords(),t.hasControls=t.__origHasControls,delete t.__origHasControls,t.set("active",!1),t.setCoords(),delete t.group,this},_setObjectPosition:function(t){var e=this.getCenterPoint(),i=this._getRotatedLeftTop(t);t.set({angle:t.getAngle()+this.getAngle(),left:e.x+i.left,top:e.y+i.top,scaleX:t.get("scaleX")*this.get("scaleX"),scaleY:t.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(t){var e=this.getAngle()*(Math.PI/180);return{left:-Math.sin(e)*t.getTop()*this.get("scaleY")+Math.cos(e)*t.getLeft()*this.get("scaleX"),top:Math.cos(e)*t.getTop()*this.get("scaleY")+Math.sin(e)*t.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords()}),this},_calcBounds:function(t){for(var e,i,r=[],n=[],o=["tr","br","bl","tl"],s=0,a=this._objects.length;a>s;++s){e=this._objects[s],e.setCoords();for(var c=0;4>c;c++)i=o[c],r.push(e.oCoords[i].x),n.push(e.oCoords[i].y)}this.set(this._getBounds(r,n,t))},_getBounds:function(t,i,o){var s=e.util.invertTransform(this.getViewportTransform()),a=e.util.transformPoint(new e.Point(r(t),r(i)),s),c=e.util.transformPoint(new e.Point(n(t),n(i)),s),l={width:c.x-a.x||0,height:c.y-a.y||0};return o||(l.left=a.x||0,l.top=a.y||0,"center"===this.originX&&(l.left+=l.width/2),"right"===this.originX&&(l.left+=l.width),"center"===this.originY&&(l.top+=l.height/2),"bottom"===this.originY&&(l.top+=l.height)),l},toSVG:function(t){for(var e=["<g ",'transform="',this.getSvgTransform(),'">\n'],i=0,r=this._objects.length;r>i;i++)e.push(this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")},get:function(t){if(t in s){if(this[t])return this[t];for(var e=0,i=this._objects.length;i>e;e++)if(this._objects[e][t])return!0;return!1}return t in this.delegatedProperties?this._objects[0]&&this._objects[0].get(t):this[t]}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(r){delete t.objects,i&&i(new e.Group(r,t))})},e.Group.async=!0}}(exports),function(t){var e=fabric.util.object.extend;if(t.fabric||(t.fabric={}),t.fabric.Image)return void fabric.warn("fabric.Image is already defined.");fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(t,e){e||(e={}),this.filters=[],this.resizeFilters=[],this.callSuper("initialize",e),this._initElement(t,e),this._initConfig(e),e.filters&&(this.filters=e.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(t,e,i){return this._element=t,this._originalElement=t,this._initConfig(i),0!==this.filters.length?this.applyFilters(e):e&&e(),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){t.save(),this._setStrokeStyles(t),t.beginPath(),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.closePath(),t.restore()},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,r=this.width,n=this.height;t.save(),this._setStrokeStyles(t),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+r,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i,e+r,i+n,this.strokeDashArray),fabric.util.drawDashedLine(t,e+r,i+n,e,i+n,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+n,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){return e(this.callSuper("toObject",t),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(t){return t&&t.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice})},toSVG:function(t){var e=[],i=-this.width/2,r=-this.height/2,n="none";if(this.group&&"path-group"===this.group.type&&(i=this.left,r=this.top),"none"!==this.alignX&&"none"!==this.alignY&&(n="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',i,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',n,'"',"></image>\n"),this.stroke||this.strokeDashArray){var o=this.fill;this.fill=null,e.push("<rect ",'x="',i,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=o}return e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},setSrc:function(t,e,i){fabric.util.loadImage(t,function(t){return this.setElement(t,e,i)},this,i&&i.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(t,e){this.constructor.fromObject(this.toObject(e),t)},applyFilters:function(t,e,i,r){if(e=e||this.filters,i=i||this._originalElement){var n=i,o=fabric.util.createCanvasElement(),s=fabric.util.createImage(),a=this;return o.width=n.width,(o.height=n.height,o.getContext("2d").drawImage(n,0,0,n.width,n.height),0===e.length)?(this._element=i,t&&t(),o):(e.forEach(function(t){t&&t.applyTo(o,t.scaleX||a.scaleX,t.scaleY||a.scaleY),!r&&t&&"Resize"===t.type&&(a.width*=t.scaleX,a.height*=t.scaleY)}),s.width=o.width,s.height=o.height,fabric.isLikelyNode?(s.src=o.toBuffer(void 0,fabric.Image.pngCompression),a._element=s,!r&&(a._filteredEl=s),t&&t()):(s.onload=function(){a._element=s,!r&&(a._filteredEl=s),t&&t(),s.onload=o=n=null},s.src=o.toDataURL("image/png")),o)}},_render:function(t,e){var i,r,n,o=this._findMargins();i=e?this.left:-this.width/2,r=e?this.top:-this.height/2,"slice"===this.meetOrSlice&&(t.beginPath(),t.rect(i,r,this.width,this.height),t.clip()),!1===this.isMoving&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,n=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):n=this._element,n&&t.drawImage(n,i+o.marginX,r+o.marginY,o.width,o.height),this._renderStroke(t)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var t,e,i=this.width,r=this.height,n=0,o=0;return"none"===this.alignX&&"none"===this.alignY||(t=[this.width/this._element.width,this.height/this._element.height],e="meet"===this.meetOrSlice?Math.min.apply(null,t):Math.max.apply(null,t),i=this._element.width*e,r=this._element.height*e,"Mid"===this.alignX&&(n=(this.width-i)/2),"Max"===this.alignX&&(n=this.width-i),"Mid"===this.alignY&&(o=(this.height-r)/2),"Max"===this.alignY&&(o=this.height-r)),{width:i,height:r,marginX:n,marginY:o}},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t){this.setElement(fabric.util.getById(t)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t.filters&&t.filters.length?fabric.util.enlivenObjects(t.filters,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){fabric.Image.prototype._initFilters.call(t,t,function(r){t.filters=r||[];var n=new fabric.Image(i,t);e&&e(n)})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e&&e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(t,i,r){var n,o,s,a=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES),c="xMidYMid",l="meet";a.preserveAspectRatio&&(s=a.preserveAspectRatio.split(" ")),s&&s.length&&(l=s.pop(),"meet"!==l&&"slice"!==l?(c=l,l="meet"):s.length&&(c=s.pop())),n="none"!==c?c.slice(1,4):"none",o="none"!==c?c.slice(5,8):"none",a.alignX=n,a.alignY=o,a.meetOrSlice=l,fabric.Image.fromURL(a["xlink:href"],i,e(r?fabric.util.object.clone(r):{},a))},fabric.Image.async=!0,fabric.Image.pngCompression=1}(exports),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Brightness=e.util.createClass(e.Image.filters.BaseFilter,{type:"Brightness",initialize:function(t){t=t||{},this.brightness=t.brightness||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,n=this.brightness,o=0,s=r.length;s>o;o+=4)r[o]+=n,r[o+1]+=n,r[o+2]+=n;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{brightness:this.brightness})}}),e.Image.filters.Brightness.fromObject=function(t){return new e.Image.filters.Brightness(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Convolute=e.util.createClass(e.Image.filters.BaseFilter,{type:"Convolute",initialize:function(t){t=t||{},this.opaque=t.opaque,this.matrix=t.matrix||[0,0,0,0,1,0,0,0,0],this.tmpCtx=e.util.createCanvasElement().getContext("2d")},_createImageData:function(t,e){return this.tmpCtx.createImageData(t,e)},applyTo:function(t){for(var e=this.matrix,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=Math.round(Math.sqrt(e.length)),o=Math.floor(n/2),s=r.data,a=r.width,c=r.height,l=a,u=c,h=this._createImageData(l,u),f=h.data,d=this.opaque?1:0,p=0;u>p;p++)for(var g=0;l>g;g++){for(var v=p,y=g,m=4*(p*l+g),b=0,_=0,x=0,w=0,C=0;n>C;C++)for(var O=0;n>O;O++){var T=v+C-o,S=y+O-o;if(!(0>T||T>c||0>S||S>a)){var j=4*(T*a+S),k=e[C*n+O];b+=s[j]*k,_+=s[j+1]*k,x+=s[j+2]*k,w+=s[j+3]*k}}f[m]=b,f[m+1]=_,f[m+2]=x,f[m+3]=w+d*(255-w)}i.putImageData(h,0,0)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=function(t){return new e.Image.filters.Convolute(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.GradientTransparency=e.util.createClass(e.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(t){t=t||{},this.threshold=t.threshold||100},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),r=i.data,n=this.threshold,o=r.length,s=0,a=r.length;a>s;s+=4)r[s+3]=n+255*(o-s)/o;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold})}}),e.Image.filters.GradientTransparency.fromObject=function(t){return new e.Image.filters.GradientTransparency(t)}}(exports),function(t){var e=t.fabric||(t.fabric={});e.Image.filters.Grayscale=e.util.createClass(e.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,o=r.width*r.height*4,s=0;o>s;)e=(n[s]+n[s+1]+n[s+2])/3,n[s]=e,n[s+1]=e,n[s+2]=e,s+=4;i.putImageData(r,0,0)}}),e.Image.filters.Grayscale.fromObject=function(){return new e.Image.filters.Grayscale}}(exports),function(t){var e=t.fabric||(t.fabric={});e.Image.filters.Invert=e.util.createClass(e.Image.filters.BaseFilter,{type:"Invert",applyTo:function(t){var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,o=n.length;for(e=0;o>e;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2];i.putImageData(r,0,0)}}),e.Image.filters.Invert.fromObject=function(){return new e.Image.filters.Invert}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Mask=e.util.createClass(e.Image.filters.BaseFilter,{type:"Mask",initialize:function(t){t=t||{},this.mask=t.mask,this.channel=[0,1,2,3].indexOf(t.channel)>-1?t.channel:0},applyTo:function(t){if(this.mask){var i,r=t.getContext("2d"),n=r.getImageData(0,0,t.width,t.height),o=n.data,s=this.mask.getElement(),a=e.util.createCanvasElement(),c=this.channel,l=n.width*n.height*4;a.width=s.width,a.height=s.height,a.getContext("2d").drawImage(s,0,0,s.width,s.height);var u=a.getContext("2d").getImageData(0,0,s.width,s.height),h=u.data;for(i=0;l>i;i+=4)o[i+3]=h[i+c];r.putImageData(n,0,0)}},toObject:function(){return i(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),e.Image.filters.Mask.fromObject=function(t,i){e.util.loadImage(t.mask.src,function(r){t.mask=new e.Image(r,t.mask),i&&i(new e.Image.filters.Mask(t))})},e.Image.filters.Mask.async=!0}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Noise=e.util.createClass(e.Image.filters.BaseFilter,{type:"Noise",initialize:function(t){t=t||{},this.noise=t.noise||0},applyTo:function(t){for(var e,i=t.getContext("2d"),r=i.getImageData(0,0,t.width,t.height),n=r.data,o=this.noise,s=0,a=n.length;a>s;s+=4)e=(.5-Math.random())*o,n[s]+=e,n[s+1]+=e,n[s+2]+=e;i.putImageData(r,0,0)},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=function(t){return new e.Image.filters.Noise(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Pixelate=e.util.createClass(e.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(t){t=t||{},this.blocksize=t.blocksize||4},applyTo:function(t){var e,i,r,n,o,s,a,c=t.getContext("2d"),l=c.getImageData(0,0,t.width,t.height),u=l.data,h=l.height,f=l.width;for(i=0;h>i;i+=this.blocksize)for(r=0;f>r;r+=this.blocksize){e=4*i*f+4*r,n=u[e],o=u[e+1],s=u[e+2],a=u[e+3];for(var d=i,p=i+this.blocksize;p>d;d++)for(var g=r,v=r+this.blocksize;v>g;g++)e=4*d*f+4*g,u[e]=n,u[e+1]=o,u[e+2]=s,u[e+3]=a}c.putImageData(l,0,0)},toObject:function(){return i(this.callSuper("toObject"),{blocksize:this.blocksize})}}),e.Image.filters.Pixelate.fromObject=function(t){return new e.Image.filters.Pixelate(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.RemoveWhite=e.util.createClass(e.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(t){t=t||{},this.threshold=t.threshold||30,this.distance=t.distance||20},applyTo:function(t){for(var e,i,r,n=t.getContext("2d"),o=n.getImageData(0,0,t.width,t.height),s=o.data,a=this.threshold,c=this.distance,l=255-a,u=Math.abs,h=0,f=s.length;f>h;h+=4)e=s[h],i=s[h+1],r=s[h+2],e>l&&i>l&&r>l&&u(e-i)<c&&u(e-r)<c&&u(i-r)<c&&(s[h+3]=1);n.putImageData(o,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),e.Image.filters.RemoveWhite.fromObject=function(t){return new e.Image.filters.RemoveWhite(t)}}(exports),function(t){var e=t.fabric||(t.fabric={});e.Image.filters.Sepia=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(t){var e,i,r=t.getContext("2d"),n=r.getImageData(0,0,t.width,t.height),o=n.data,s=o.length;for(e=0;s>e;e+=4)i=.3*o[e]+.59*o[e+1]+.11*o[e+2],o[e]=i+100,o[e+1]=i+50,o[e+2]=i+255;r.putImageData(n,0,0)}}),e.Image.filters.Sepia.fromObject=function(){return new e.Image.filters.Sepia}}(exports),function(t){var e=t.fabric||(t.fabric={});e.Image.filters.Sepia2=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(t){var e,i,r,n,o=t.getContext("2d"),s=o.getImageData(0,0,t.width,t.height),a=s.data,c=a.length;for(e=0;c>e;e+=4)i=a[e],r=a[e+1],n=a[e+2],a[e]=(.393*i+.769*r+.189*n)/1.351,a[e+1]=(.349*i+.686*r+.168*n)/1.203,a[e+2]=(.272*i+.534*r+.131*n)/2.14;o.putImageData(s,0,0)}}),e.Image.filters.Sepia2.fromObject=function(){return new e.Image.filters.Sepia2}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Tint=e.util.createClass(e.Image.filters.BaseFilter,{type:"Tint",initialize:function(t){t=t||{},this.color=t.color||"#000000",this.opacity=void 0!==t.opacity?t.opacity:new e.Color(this.color).getAlpha()},applyTo:function(t){var i,r,n,o,s,a,c,l,u,h=t.getContext("2d"),f=h.getImageData(0,0,t.width,t.height),d=f.data,p=d.length;for(u=new e.Color(this.color).getSource(),r=u[0]*this.opacity,n=u[1]*this.opacity,o=u[2]*this.opacity,l=1-this.opacity,i=0;p>i;i+=4)s=d[i],a=d[i+1],c=d[i+2],d[i]=r+s*l,d[i+1]=n+a*l,d[i+2]=o+c*l;h.putImageData(f,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),e.Image.filters.Tint.fromObject=function(t){return new e.Image.filters.Tint(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Multiply=e.util.createClass(e.Image.filters.BaseFilter,{type:"Multiply",initialize:function(t){t=t||{},this.color=t.color||"#000000"},applyTo:function(t){var i,r,n=t.getContext("2d"),o=n.getImageData(0,0,t.width,t.height),s=o.data,a=s.length;for(r=new e.Color(this.color).getSource(),i=0;a>i;i+=4)s[i]*=r[0]/255,s[i+1]*=r[1]/255,s[i+2]*=r[2]/255;n.putImageData(o,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color})}}),e.Image.filters.Multiply.fromObject=function(t){return new e.Image.filters.Multiply(t)}}(exports),function(t){var e=t.fabric;e.Image.filters.Blend=e.util.createClass({type:"Blend",initialize:function(t){t=t||{},this.color=t.color||"#000",this.image=t.image||!1,this.mode=t.mode||"multiply",this.alpha=t.alpha||1},applyTo:function(t){var i,r,n,o,s,a,c,l,u,h,f=t.getContext("2d"),d=f.getImageData(0,0,t.width,t.height),p=d.data,g=!1;if(this.image){g=!0;var v=e.util.createCanvasElement();v.width=this.image.width,v.height=this.image.height;var y=new e.StaticCanvas(v);y.add(this.image);h=y.getContext("2d").getImageData(0,0,y.width,y.height).data}else h=new e.Color(this.color).getSource(),i=h[0]*this.alpha,r=h[1]*this.alpha,n=h[2]*this.alpha;for(var m=0,b=p.length;b>m;m+=4)switch(o=p[m],s=p[m+1],a=p[m+2],g&&(i=h[m]*this.alpha,r=h[m+1]*this.alpha,n=h[m+2]*this.alpha),this.mode){case"multiply":p[m]=o*i/255,p[m+1]=s*r/255,p[m+2]=a*n/255;break;case"screen":p[m]=1-(1-o)*(1-i),p[m+1]=1-(1-s)*(1-r),p[m+2]=1-(1-a)*(1-n);break;case"add":p[m]=Math.min(255,o+i),p[m+1]=Math.min(255,s+r),p[m+2]=Math.min(255,a+n);break;case"diff":case"difference":p[m]=Math.abs(o-i),p[m+1]=Math.abs(s-r),p[m+2]=Math.abs(a-n);break;case"subtract":c=o-i,l=s-r,u=a-n,p[m]=0>c?0:c,p[m+1]=0>l?0:l,p[m+2]=0>u?0:u;break;case"darken":p[m]=Math.min(o,i),p[m+1]=Math.min(s,r),p[m+2]=Math.min(a,n);break;case"lighten":p[m]=Math.max(o,i),p[m+1]=Math.max(s,r),p[m+2]=Math.max(a,n)}f.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.Blend.fromObject=function(t){return new e.Image.filters.Blend(t)}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=Math.pow,r=Math.floor,n=Math.sqrt,o=Math.abs,s=Math.max,a=Math.round,c=Math.sin,l=Math.ceil;e.Image.filters.Resize=e.util.createClass(e.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(t,e,i){this.rcpScaleX=1/e,this.rcpScaleY=1/i;var r,n=t.width,o=t.height,s=a(n*e),c=a(o*i);"sliceHack"===this.resizeType&&(r=this.sliceByTwo(t,n,o,s,c)),"hermite"===this.resizeType&&(r=this.hermiteFastResize(t,n,o,s,c)),"bilinear"===this.resizeType&&(r=this.bilinearFiltering(t,n,o,s,c)),"lanczos"===this.resizeType&&(r=this.lanczosResize(t,n,o,s,c)),t.width=s,t.height=c,t.getContext("2d").putImageData(r,0,0)},sliceByTwo:function(t,i,n,o,a){var c,l=t.getContext("2d"),u=.5,h=.5,f=1,d=1,p=!1,g=!1,v=i,y=n,m=e.util.createCanvasElement(),b=m.getContext("2d");for(o=r(o),a=r(a),m.width=s(o,i),m.height=s(a,n),o>i&&(u=2,f=-1),a>n&&(h=2,d=-1),c=l.getImageData(0,0,i,n),t.width=s(o,i),t.height=s(a,n),l.putImageData(c,0,0);!p||!g;)i=v,n=y,o*f<r(v*u*f)?v=r(v*u):(v=o,p=!0),a*d<r(y*h*d)?y=r(y*h):(y=a,g=!0),c=l.getImageData(0,0,i,n),b.putImageData(c,0,0),l.clearRect(0,0,v,y),l.drawImage(m,0,0,i,n,0,0,v,y);return l.getImageData(0,0,o,a)},lanczosResize:function(t,e,s,a,u){function h(t){var c,l,f,d,j,k,A,P,E,L,M;for(T.x=(t+.5)*m,S.x=r(T.x),c=0;u>c;c++){for(T.y=(c+.5)*b,S.y=r(T.y),j=0,k=0,A=0,P=0,E=0,l=S.x-w;S.x+w>=l;l++)if(l>=0&&e>l){L=r(1e3*o(l-T.x)),O[L]||(O[L]={});for(var D=S.y-C;S.y+C>=D;D++)D>=0&&s>D&&(M=r(1e3*o(D-T.y)),O[L][M]||(O[L][M]=y(n(i(L*_,2)+i(M*x,2))/1e3)),(f=O[L][M])>0&&(d=4*(D*e+l),j+=f,k+=f*g[d],A+=f*g[d+1],P+=f*g[d+2],E+=f*g[d+3]))}d=4*(c*a+t),v[d]=k/j,v[d+1]=A/j,v[d+2]=P/j,v[d+3]=E/j}return++t<a?h(t):p}var f=t.getContext("2d"),d=f.getImageData(0,0,e,s),p=f.getImageData(0,0,a,u),g=d.data,v=p.data,y=function(t){return function(e){if(e>t)return 0;if(e*=Math.PI,1e-16>o(e))return 1;var i=e/t;return c(e)*c(i)/e/i}}(this.lanczosLobes),m=this.rcpScaleX,b=this.rcpScaleY,_=2/this.rcpScaleX,x=2/this.rcpScaleY,w=l(m*this.lanczosLobes/2),C=l(b*this.lanczosLobes/2),O={},T={},S={};return h(0)},bilinearFiltering:function(t,e,i,n,o){var s,a,c,l,u,h,f,d,p,g,v,y,m,b=0,_=this.rcpScaleX,x=this.rcpScaleY,w=t.getContext("2d"),C=4*(e-1),O=w.getImageData(0,0,e,i),T=O.data,S=w.getImageData(0,0,n,o),j=S.data;for(f=0;o>f;f++)for(d=0;n>d;d++)for(u=r(_*d),h=r(x*f),p=_*d-u,g=x*f-h,m=4*(h*e+u),v=0;4>v;v++)s=T[m+v],a=T[m+4+v],c=T[m+C+v],l=T[m+C+4+v],y=s*(1-p)*(1-g)+a*p*(1-g)+c*g*(1-p)+l*p*g,j[b++]=y;return S},hermiteFastResize:function(t,e,i,s,a){for(var c=this.rcpScaleX,u=this.rcpScaleY,h=l(c/2),f=l(u/2),d=t.getContext("2d"),p=d.getImageData(0,0,e,i),g=p.data,v=d.getImageData(0,0,s,a),y=v.data,m=0;a>m;m++)for(var b=0;s>b;b++){for(var _=4*(b+m*s),x=0,w=0,C=0,O=0,T=0,S=0,j=0,k=(m+.5)*u,A=r(m*u);(m+1)*u>A;A++)for(var P=o(k-(A+.5))/f,E=(b+.5)*c,L=P*P,M=r(b*c);(b+1)*c>M;M++){var D=o(E-(M+.5))/h,I=n(L+D*D);1<I&&I<-1||(x=2*I*I*I-3*I*I+1)>0&&(D=4*(M+A*e),j+=x*g[D+3],C+=x,255>g[D+3]&&(x=x*g[D+3]/250),O+=x*g[D],T+=x*g[D+1],S+=x*g[D+2],w+=x)}y[_]=O/w,y[_+1]=T/w,y[_+2]=S/w,y[_+3]=j/C}return v},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaley:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=function(){return new e.Image.filters.Resize}}(exports),function(t){var e=t.fabric||(t.fabric={}),i=e.util.object.extend,r=e.util.object.clone,n=e.util.toFixed,o=e.StaticCanvas.supports("setLineDash");if(e.Text)return void e.warn("fabric.Text is already defined");var s=e.Object.prototype.stateProperties.concat();s.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:s,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(t,e){e=e||{},this.text=t,this.__skipDimension=!0,this.setOptions(e),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(t){if(!this.__skipDimension){t||(t=e.util.createCanvasElement().getContext("2d"),this._setTextStyles(t)),this._textLines=this.text.split(this._reNewline),this._clearCache();var i=this.textAlign;this.textAlign="left",this.width=this._getTextWidth(t),this.textAlign=i,this.height=this._getTextHeight(t)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(t){this.clipTo&&e.util.clipContext(this,t),this._renderTextBackground(t),this._renderText(t),this._renderTextDecoration(t),this.clipTo&&t.restore()},_renderText:function(t){t.save(),this._translateForTextAlign(t),this._setOpacity(t),this._setShadow(t),this._setupCompositeOperation(t),this._renderTextFill(t),this._renderTextStroke(t),this._restoreCompositeOperation(t),this._removeShadow(t),t.restore()},_translateForTextAlign:function(t){"left"!==this.textAlign&&"justify"!==this.textAlign&&t.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(t){t.textBaseline="alphabetic",this.skipTextAlign||(t.textAlign=this.textAlign),t.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(t){for(var e=this._getLineWidth(t,0),i=1,r=this._textLines.length;r>i;i++){var n=this._getLineWidth(t,i);n>e&&(e=n)}return e},_renderChars:function(t,e,i,r,n){e[t](i,r,n)},_renderTextLine:function(t,e,i,r,n,o){if(n-=this.fontSize*this._fontSizeFraction,"justify"!==this.textAlign)return void this._renderChars(t,e,i,r,n,o);var s=this._getLineWidth(e,o),a=this.width;if(a<s)this._renderChars(t,e,i,r,n,o);else for(var c=i.split(/\s+/),l=this._getWidthOfWords(e,i,o),u=a-l,h=c.length-1,f=u/h,d=0,p=0,g=c.length;g>p;p++)this._renderChars(t,e,c[p],r+d,n,o),d+=e.measureText(c[p]).width+f},_getWidthOfWords:function(t,e){return t.measureText(e.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(t){if(this.fill||this._skipFillStrokeCheck){for(var e=0,i=0,r=this._textLines.length;r>i;i++){var n=this._getHeightOfLine(t,i),o=n/this.lineHeight;this._renderTextLine("fillText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+o,i),e+=n}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t)}},_renderTextStroke:function(t){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var e=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),o&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,r=this._textLines.length;r>i;i++){var n=this._getHeightOfLine(t,i),s=n/this.lineHeight;this._renderTextLine("strokeText",t,this._textLines[i],this._getLeftOffset(),this._getTopOffset()+e+s,i),e+=n}t.closePath(),t.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(t){this._renderTextBoxBackground(t),this._renderTextLinesBackground(t)},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},_renderTextLinesBackground:function(t){var e=0,i=this._getHeightOfLine();if(this.textBackgroundColor){t.save(),t.fillStyle=this.textBackgroundColor;for(var r=0,n=this._textLines.length;n>r;r++){if(""!==this._textLines[r]){var o=this._getLineWidth(t,r),s=this._getLineLeftOffset(o);t.fillRect(this._getLeftOffset()+s,this._getTopOffset()+e,o,this.fontSize*this._fontSizeMult)}e+=i}t.restore()}},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__lineOffsets=[]},_shouldClearCache:function(){var t=!1;for(var e in this._dimensionAffectingProps)this["__"+e]!==this[e]&&(this["__"+e]=this[e],t=!0);return t},_getLineWidth:function(t,e){return this.__lineWidths[e]?this.__lineWidths[e]:this.__lineWidths[e]=t.measureText(this._textLines[e]).width},_renderTextDecoration:function(t){if(this.textDecoration){var e=this.height/2,i=this,r=[];this.textDecoration.indexOf("underline")>-1&&r.push(.85),this.textDecoration.indexOf("line-through")>-1&&r.push(.43),this.textDecoration.indexOf("overline")>-1&&r.push(-.12),r.length>0&&function(r){var n,o,s,a,c=0;for(n=0,o=i._textLines.length;o>n;n++){var l=i._getLineWidth(t,n),u=i._getLineLeftOffset(l),h=i._getHeightOfLine(t,n);for(s=0,a=r.length;a>s;s++)t.fillRect(i._getLeftOffset()+u,c+(i._fontSizeMult-1+r[s])*i.fontSize-e,l,i.fontSize/15);c+=h}}(r)}},_getFontDeclaration:function(){return[e.isLikelyNode?this.fontWeight:this.fontStyle,e.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",e.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(t,e){this.visible&&(t.save(),this._setTextStyles(t),this._shouldClearCache()&&this._initDimensions(t),e||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this.transformMatrix&&t.transform.apply(t,this.transformMatrix),this.group&&"path-group"===this.group.type&&t.translate(this.left,this.top),this._render(t),t.restore())},toObject:function(t){var e=i(this.callSuper("toObject",t),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this._getSVGLeftTopOffsets(this.ctx);return this._wrapSVGTextAndBg(e,this._getSVGTextAndBg(i.textTop,i.textLeft)),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(t){var e=this._getHeightOfLine(t,0);return{textLeft:-this.width/2+(this.group&&"path-group"===this.group.type?this.left:0),textTop:0+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:e}},_wrapSVGTextAndBg:function(t,e){t.push('\t<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',e.textBgRects.join(""),"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',e.textSpans.join(""),"</text>\n","\t</g>\n")},_getSVGTextAndBg:function(t,e){var i=[],r=[],n=0;this._setSVGBg(r);for(var o=0,s=this._textLines.length;s>o;o++)this.textBackgroundColor&&this._setSVGTextLineBg(r,o,e,t,n),this._setSVGTextLineText(o,i,n,e,t,r),n+=this._getHeightOfLine(this.ctx,o);return{textSpans:i,textBgRects:r}},_setSVGTextLineText:function(t,i,r,o,s){var a=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-s+r-this.height/2;i.push('<tspan x="',n(o+this._getLineLeftOffset(this.__lineWidths[t]),4),'" ','y="',n(a,4),'" ',this._getFillAttributes(this.fill),">",e.util.string.escapeXml(this._textLines[t]),"</tspan>")},_setSVGTextLineBg:function(t,e,i,r,o){t.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',n(i+this._getLineLeftOffset(this.__lineWidths[e]),4),'" y="',n(o-this.height/2,4),'" width="',n(this.__lineWidths[e],4),'" height="',n(this._getHeightOfLine(this.ctx,e)/this.lineHeight,4),'"></rect>\n')},_setSVGBg:function(t){this.backgroundColor&&t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',n(-this.width/2,4),'" y="',n(-this.height/2,4),'" width="',n(this.width,4),'" height="',n(this.height,4),'"></rect>\n')},_getFillAttributes:function(t){var i=t&&"string"==typeof t?new e.Color(t):"";return i&&i.getSource()&&1!==i.getAlpha()?'opacity="'+i.getAlpha()+'" fill="'+i.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_set:function(t,e){this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i){if(!t)return null;var r=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES);i=e.util.object.extend(i?e.util.object.clone(i):{},r),i.top=i.top||0,i.left=i.left||0,"dx"in r&&(i.left+=r.dx),"dy"in r&&(i.top+=r.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE),i.originX||(i.originX="left");var n=t.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),o=new e.Text(n,i),s=0;return"left"===o.originX&&(s=o.getWidth()/2),"right"===o.originX&&(s=-o.getWidth()/2),o.set({left:o.getLeft()+s,top:o.getTop()-o.getHeight()/2+o.fontSize*(.18+o._fontSizeFraction)}),o},e.Text.fromObject=function(t){return new e.Text(t.text,r(t))},e.util.createAccessors(e.Text)}(exports)},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_3__},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},o=i(2),s=i(7),a=r(s),c=i(3),l=r(c),u={canvasMaxNum:10};e.default=a.default.extend({initialize:function(t){t=n({},u,t),a.default.prototype.initialize.call(this,t)},_onMapResize:function(){a.default.prototype._onMapResize.call(this,this._map),this.fabrics.forEach(function(t){var e=t.contextContainer.canvas;t.setDimensions({width:e.width,height:e.height})})},onAdd:function(t){a.default.prototype.onAdd.call(this,t),this.initFabrics()},onRemove:function(){this.disposeFabrics(this.lockedFabrics),this.disposeFabrics(this.fabrics),a.default.prototype.onRemove.call(this)},_lockAllCanvas:function(){a.default.prototype._lockAllCanvas.call(this),this.lockedFabrics=this.fabrics,this.lastFabricCanvas=void 0,this.fabrics=[]},_removeLockedCanvas:function(){a.default.prototype._removeLockedCanvas.call(this),this.disposeFabrics(this.lockedFabrics)},getFabric:function(){var t=void 0;t=this.lastFabricCanvas?this.fabrics.indexOf(this.lastFabricCanvas)+1:0;var e=this.fabrics[t];return e||(e=this.createFabric(),this.fabrics[t]=e),this.lastFabricCanvas=e},createFabric:function(){var t=this.createCanvas();return new o.fabric.StaticCanvas(t,{renderOnAddRemove:!1,stateful:!1})},initFabrics:function(){this.fabrics=[],this.lockedFabrics=[]},disposeFabrics:function(t){t.forEach(function(t){t.dispose()})},renderInSingleFrame:function(t,e,i,r,n){this.raf(function(){e.forEach(function(e){var o=n(e,i,r);void 0!=o&&(l.default.isArray(o)?o.forEach(function(e){return t.add(e)}):t.add(o))}),t.renderAll()})},renderInMultiFrames:function(t,e,i){var r=this;this.renderLayerBounds=this.getRenderLayerBounds();var n=t.features.length/this.options.canvasMaxNum;n>i&&(i=n);for(var o=[],s=this.getRenderContainerBounds(),a=this.getBufferedOffset(),c=0,l=t.features.length;l>c;c++){o.push(t.features[c]),o.length===i&&(this.renderInSingleFrame(this.getFabric(),o,s,a,e),o=[])}o.length>0&&this.renderInSingleFrame(this.getFabric(),o,s,a,e),this.raf(function(){r.fire("renderdone")})}})},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},c=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),l=i(3),u=(r(l),i(6)),h=(r(u),i(13)),f=r(h),d=(i(9),0);e.default=function(t){function e(t){n(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.id=d++,i.requestCounter=0,i.props=a({},i.props,t),i}return s(e,t),c(e,[{key:"emitLoadStart",value:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;e>r;r++)i[r-1]=arguments[r];this.emit.apply(this,["loadstart",t].concat(i))}},{key:"emitLoadData",value:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;e>r;r++)i[r-1]=arguments[r];this.emit.apply(this,["loaddata",t].concat(i))}},{key:"emitLoad",value:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;e>r;r++)i[r-1]=arguments[r];this.emit.apply(this,["load",t].concat(i))}},{key:"emitLoadError",value:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;e>r;r++)i[r-1]=arguments[r];this.emit.apply(this,["loaderror",t].concat(i))}},{key:"getRid",value:function(){return this.id+"-"+this.requestCounter}},{key:"setProps",value:function(t){this.props=a({},this.props,t)}},{key:"request",value:function(){this.requestCounter++;var t=this.getRid();return Promise.resolve(this._request(t))}},{key:"_request",value:function(t){throw Error("should overwrite _request interface")}},{key:"destroy",value:function(){this.isDestroy||(this.removeAllListeners(),this._destroy&&this._destroy(),this.isDestroy=!0)}}]),e}(f.default)},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_6__},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var n=i(8),o=function(t){return t&&t.__esModule?t:{default:t}}(n),s=i(0),a={canvasBuffer:{width:function(t){return 3*t},height:function(t){return 3*t}}};e.default=o.default.extend({initialize:function(t){t=r({},a,t),o.default.prototype.initialize.call(this,t)},_initEvents:function(){var t=this;this.on("loadstart",function(e){t.data={type:"FeatureCollection",features:[]}}),this.on("loaddata",function(e){t.renderRid!==e.rid&&(t.clearFrames(),t._lockAllCanvas(),t.renderRid=e.rid),t.data.features=t.data.features.concat(e.data.features),t.render(e.data)}),this.on("load",function(){t.once("renderdone",function(){t._removeLockedCanvas()})})},_initMapEvent:function(){var t=this._map;t.on("resize",this._onMapResize,this),t.on("movestart",this._onMapMovestart,this),t.on("moveend",this._onMapMoveend,this),t.on("zoomstart",this._onZoomstart,this),t.on("zoomend",this._onZoomend,this)},_removeMapEvent:function(){var t=this._map;t.off("resize",this._onMapResize,this),t.off("movestart",this._onMapMovestart,this),t.off("moveend",this._onMapMoveend,this),t.off("zoomstart",this._onZoomstart,this),t.off("zoomend",this._onZoomend,this)},_destroy:function(){this.getPane().removeChild(this.getContainer()),this._removeMapEvent(),this.clearFrames(),this._destroyDs(),this.off()},_reset:function(){this.renderLayerBounds=null;for(var t=this._map,e=this.getNodes(),i=(t.getSize(),this.getRenderLayerBounds()),r=t.containerPointToLayerPoint(i.min),n=i.max.x-i.min.x,o=i.max.y-i.min.y,s=0,a=e.length;a>s;s++){var c=e[s];L.DomUtil.setPosition(c,r),c.width!==n&&(c.width=n),c.height!==o&&(c.height=o)}},_forceRender:function(){var t=this;this.clearFrames(),this.raf(function(){t._lockAllCanvas(),t.render(t.data),t.once("renderdone",function(){t._removeLockedCanvas()})})},_getUnlockedCanvas:function(){for(var t=this.getContainer(),e=[],i=0,r=t.childNodes.length;r>i;i++){var n=t.childNodes[i];L.DomUtil.hasClass(n,"geoengine-locked-canvas")||e.push(n)}return e},_getLockedCanvas:function(){for(var t=this.getContainer(),e=[],i=0,r=t.childNodes.length;r>i;i++){var n=t.childNodes[i];L.DomUtil.hasClass(n,"geoengine-locked-canvas")&&e.push(n)}return e},_lockAllCanvas:function(){this._getUnlockedCanvas().forEach(function(t){L.DomUtil.addClass(t,"geoengine-locked-canvas")})},_removeLockedCanvas:function(){var t=this.getContainer();this._getLockedCanvas().forEach(function(e){t.removeChild(e)})},getBufferedOffset:function(){var t=this.options.canvasBuffer,e=this._map.getSize(),i=t.width(e.x),r=t.height(e.y);return L.point([(i-e.x)/2,(r-e.y)/2])},getViewLayerBounsd:function(){var t=this._map,e=t.getSize();return L.bounds([t.containerPointToLayerPoint(L.point([0,0])),t.containerPointToLayerPoint([e.x,e.y])])},getRenderContainerBounds:function(){var t=this._map.getSize(),e=this.getBufferedOffset();return L.bounds([L.point([0,0]).subtract(e),L.point([t.x,t.y]).add(e)])},getRenderLayerBounds:function(){var t=this._map,e=this._map.getSize(),i=this.getBufferedOffset();return L.bounds([t.containerPointToLayerPoint(L.point([0,0]).subtract(i)),t.containerPointToLayerPoint(L.point([e.x,e.y]).add(i))])},outOfRenderLayerBounds:function(){if(!this.renderLayerBounds)return!0;var t=this._map,e=this._map.getSize(),i=L.bounds([t.containerPointToLayerPoint(L.point([0,0])),t.containerPointToLayerPoint(L.point([e.x,e.y]))]);return!this.renderLayerBounds.contains(i.min)||!this.renderLayerBounds.contains(i.max)},_onMapResize:function(){this.clearFrames(),this._reset()},_onMapMovestart:function(){this.pauseLoop()},_onMapMoveend:function(){this.resumeLoop(),this.outOfRenderLayerBounds()&&(this.clearFrames(),this._forceRender())},_onZoomstart:function(t){this.clearFrames(),this.clearAllCanvas()},_onZoomend:function(t){this._reset(),this.clearFrames(),this._forceRender()},createCanvas:function(){var t=this._map,e=L.DomUtil.create("canvas","leaflet-canvas-layer leaflet-layer");e.style[L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"])]="50% 50%",e.style["pointer-events"]="none";var i=t.getSize(),r=this.options.canvasBuffer;e.width=r.width(i.x),e.height=r.height(i.y);var n=t.options.zoomAnimation&&L.Browser.any3d;return L.DomUtil.addClass(e,"leaflet-zoom-"+(n?"animated":"hide")),this.getContainer().appendChild(e),L.DomUtil.setPosition(e,this.getRenderLayerBounds().min),e},onAdd:function(t){this._map=t,this._initEvents(),this._initMapEvent(),this._initDs()},onRemove:function(){this._destroy()},clearCanvas:function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)},clearAllCanvas:function(){for(var t=this.getNodes(),e=0,i=t.length;i>e;e++)this.clearCanvas(t[e])},setOptions:function(t){var e=(0,s.isAnyRenderOptionsChange)(t,this.options,this._forceRenderKeys);if(L.setOptions(this,t),t.ds&&this._ds!==t.ds)return this._ds.destroy(),void this._initDs();e&&this._forceRender()},getContainer:function(){if(this.container)return this.container;var t=this.getPane(),e=this.container=L.DomUtil.create("div","geoengine-canvas-container");return e.style.position="absolute",t.appendChild(e),e},getNodes:function(){return this.getContainer().childNodes},render:function(){throw Error("expect render function to be override")}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var n=i(5),o=function(t){return t&&t.__esModule?t:{default:t}}(n),s={valueName:"value",defaultValue:"undefined",destroyDsAfterRemove:!0,lazy:!1};e.default=L.Layer.extend({initialize:function(t){t=r({},s,t),L.setOptions(this,t),this._frames={},this._runningFrames={},this._loopPausing=!1},_initDs:function(){var t=this.options.ds;if(!(t instanceof o.default))throw Error("ds must be instance of Datasource");this._ds=t,this._ds.on("loadstart",this._onDsLoadStart,this),this._ds.on("loaddata",this._onDsLoadData,this),this._ds.on("load",this._onDsLoad,this),this._ds.on("loaderror",this._onDsLoadError,this),this.options.lazy||this._ds.request()},_onDsLoadStart:function(t){this.fire("loadstart",{rid:t})},_onDsLoadData:function(t,e,i){this._dataID=i,this.fire("loaddata",{data:e,rid:t,dataUrl:i})},_onDsLoad:function(t){this.fire("load",{rid:t})},_onDsLoadError:function(t,e){this.fire("loaderror",{error:e,rid:t})},_destroyDs:function(){if(this._ds&&this.options.destroyDsAfterRemove)return this._ds.destroy();this._ds.removeListener("loadstart",this._onDsLoadStart,this),this._ds.removeListener("loaddata",this._onDsLoadData,this),this._ds.removeListener("load",this._onDsLoad,this),this._ds.removeListener("loaderror",this._onDsLoadError,this)},getValue:function(t){return(void 0==this.options.getValue?t.properties[this.options.valueName]:this.options.getValue(t))||this.options.defaultValue},clearFrames:function(){var t=this;Object.keys(this._runningFrames).forEach(function(e){var i=t._runningFrames[e];i&&(L.Util.cancelAnimFrame(i.requestAnimFrameID),t._runningFrames[e]=null)}),this._frameFuncs={}},pauseLoop:function(){this._loopPausing=!0},resumeLoop:function(){this._loopPausing=!1,this.loop()},loop:function(){var t=this;this._loopPausing||Object.keys(this._frames).forEach(function(e){if(void 0==t._runningFrames[e]&&0!==t._frames[e].length){var i=t._runningFrame=t._frames[e].shift();i.requestAnimFrameID=L.Util.requestAnimFrame(function(){i.func(),t._runningFrames[e]=null,t.loop()})}})},raf:function(t,e){var i=this._dataID||"default";if(e)throw Error("not support immediate");void 0==this._frames[i]&&(this._frames[i]=[]),this._frames[i].push({func:t}),this.loop()}})},function(t,e,i){t.exports=i(42)},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},c=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),l=i(3),u=r(l),h=i(6),f=r(h),d=i(9),p=i(5),g=r(p),v={headers:{Accept:"application/json","Content-Type":"application/json"}},y=function(t){if(null===t)return t;if(void 0==t.isError)return t;if(t.isError)throw t.error;return t.data},m={maxCacheData:10,parseData:y};e.default=function(t){function e(t){n(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a({},m,t)));return i.cache=[],i}return s(e,t),c(e,[{key:"getRequestOpts",value:function(t){return a({},v,{headers:a({},v.headers,t.headers),credentials:t.credentials,method:t.method||"GET",body:t.body})}},{key:"_request",value:function(t){var e=this,i=this.props.url,r=this.getRequestOpts(this.props);this.emitLoadStart(t);var n=function(i,r){void 0!=i&&t===e.getRid()&&e.emitLoadData(t,i,r)},o=this.sendRequest(i,r,n);return o.then(function(){e.emitLoad(t)}).catch(function(i){return e.emitLoadError(t,i)}),o}},{key:"preload",value:function(t){return t=a({},this.props,t),this.sendRequest(t.url,this.getRequestOpts(t))}},{key:"sendRequest",value:function(t,e){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return u.default.isArray(t)?(0,d.all)(t.map(function(t){return i.sendOneRequest(t,e).then(function(e){return r(e,t)})})):this.sendOneRequest(t,e).then(function(e){return r(e,t)})}},{key:"sendOneRequest",value:function(t,e){var i=this,r=this.getCache(t);if(r)return r.value;var n=this._sendOneRequest(t,e).then(function(e){return null===e&&i.removeCache(t),e}).catch(function(e){throw i.removeCache(t),e});return this.setCache(t,n),n}},{key:"_sendOneRequest",value:function(t,e){var i=this;return(0,f.default)(t,e).then(function(t){return i.isDestroy?null:t.json()}).then(this.props.parseData)}},{key:"setCache",value:function(t,e){this.props.maxCacheData>this.cache.length||(this.cache=this.cache.slice(this.cache.length-this.props.maxCacheData+1)),this.cache.push({key:t,value:e})}},{key:"getCache",value:function(t,e){return u.default.find(this.cache,{key:t})}},{key:"removeCache",value:function(t){this.cache.splice(u.default.findIndex({key:t}),1)}},{key:"clearCache",value:function(){this.cache=[]}},{key:"_destroy",value:function(){this.clearCache()}}]),e}(g.default)},function(t,e){function i(t){if(!t)throw Error("obj is required");var e=r(t);if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return e;throw Error("Coordinate is not a valid Point")}function r(t){if(!t)throw Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return n(e),e;throw Error("No valid coordinates")}function n(t){if(t.length>1&&"number"==typeof t[0]&&"number"==typeof t[1])return!0;if(Array.isArray(t[0])&&t[0].length)return n(t[0]);throw Error("coordinates must only contain numbers")}function o(t,e,i){if(!e||!i)throw Error("type and name required");if(!t||t.type!==e)throw Error("Invalid input to "+i+": must be a "+e+", given "+t.type)}function s(t,e,i){if(!t)throw Error("No feature passed");if(!i)throw Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw Error("Invalid input to "+i+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw Error("Invalid input to "+i+": must be a "+e+", given "+t.geometry.type)}function a(t,e,i){if(!t)throw Error("No featureCollection passed");if(!i)throw Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw Error("Invalid input to "+i+", FeatureCollection required");for(var r=0;t.features.length>r;r++){var n=t.features[r];if(!n||"Feature"!==n.type||!n.geometry)throw Error("Invalid input to "+i+", Feature with geometry required");if(!n.geometry||n.geometry.type!==e)throw Error("Invalid input to "+i+": must be a "+e+", given "+n.geometry.type)}}function c(t){if(!t)throw Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw Error("geojson must be a valid Feature or Geometry Object")}function l(t){if(!t)throw Error("geojson is required");var e=c(t);if(e)return e.type}t.exports={geojsonType:o,collectionOf:a,featureOf:s,getCoord:i,getCoords:r,containsNumber:n,getGeom:c,getGeomType:l}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={getVector:function(t){return{x:t[1].x-t[0].x,y:t[1].y-t[0].y}},getDot:function(t,e){return t.x*e.x+t.y*e.y},getLen:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},getCos:function(t,e){return this.getLen(t)*this.getLen(e)==0?1:this.getDot(t,e)/(this.getLen(t)*this.getLen(e))},getCross:function(t,e){return t.x*e.y-t.y*e.x},getAngle:function(t,e){return Math.acos(this.getCos(this.getVector(t),this.getVector(e)))},getDegree:function(t,e){return 180*this.getAngle(t,e)/Math.PI},getRotateAngle:function(t,e){var i=this.getVector(t),r=this.getVector(e),n=this.getCos(i,r),o=Math.acos(n);return 0>this.getCross(i,r)?2*Math.PI-o:o},getRotateDegree:function(t,e){return 180*this.getRotateAngle(t,e)/Math.PI}}},function(t,e,i){"use strict";function r(){}function n(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function o(t,e,i,r,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new n(i,r||t,o),a=l?l+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}var c=Object.prototype.hasOwnProperty,l="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(l=!1)),a.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)c.call(t,e)&&i.push(l?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=l?l+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,n=i.length,o=Array(n);n>r;r++)o[r]=i[r].fn;return o},a.prototype.listenerCount=function(t){var e=l?l+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,n,o){var s=l?l+t:t;if(!this._events[s])return!1;var a,c,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,n),!0;case 6:return u.fn.call(u.context,e,i,r,n,o),!0}for(c=1,a=Array(h-1);h>c;c++)a[c-1]=arguments[c];u.fn.apply(u.context,a)}else{var f,d=u.length;for(c=0;d>c;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,r);break;default:if(!a)for(f=1,a=Array(h-1);h>f;f++)a[f-1]=arguments[f];u[c].fn.apply(u[c].context,a)}}return!0},a.prototype.on=function(t,e,i){return o(this,t,e,i,!1)},a.prototype.once=function(t,e,i){return o(this,t,e,i,!0)},a.prototype.removeListener=function(t,e,i,r){var n=l?l+t:t;if(!this._events[n])return this;if(!e)return s(this,n),this;var o=this._events[n];if(o.fn)o.fn!==e||r&&!o.once||i&&o.context!==i||s(this,n);else{for(var a=0,c=[],u=o.length;u>a;a++)(o[a].fn!==e||r&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[n]=1===c.length?c[0]:c:s(this,n)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=l?l+t:t,this._events[e]&&s(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=l,a.EventEmitter=a,t.exports=a},function(t,e){},function(t,e,i){var r,n;/*!
 * jQuery JavaScript Library v3.3.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2018-01-20T17:24Z
 */
!function(e,i){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!=typeof window?window:this,function(i,o){"use strict";function s(t,e,i){e=e||ut;var r,n=e.createElement("script");if(n.text=t,i)for(r in Ot)i[r]&&(n[r]=i[r]);e.head.appendChild(n).parentNode.removeChild(n)}function a(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?vt[yt.call(t)]||"object":typeof t}function c(t){var e=!!t&&"length"in t&&t.length,i=a(t);return!wt(t)&&!Ct(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function l(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function u(t,e,i){return wt(e)?Tt.grep(t,function(t,r){return!!e.call(t,r,t)!==i}):e.nodeType?Tt.grep(t,function(t){return t===e!==i}):"string"!=typeof e?Tt.grep(t,function(t){return gt.call(e,t)>-1!==i}):Tt.filter(e,t,i)}function h(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function f(t){var e={};return Tt.each(t.match(Rt)||[],function(t,i){e[i]=!0}),e}function d(t){return t}function p(t){throw t}function g(t,e,i,r){var n;try{t&&wt(n=t.promise)?n.call(t).done(e).fail(i):t&&wt(n=t.then)?n.call(t,e,i):e.apply(void 0,[t].slice(r))}catch(t){i.apply(void 0,[t])}}function v(){ut.removeEventListener("DOMContentLoaded",v),i.removeEventListener("load",v),Tt.ready()}function y(t,e){return e.toUpperCase()}function m(t){return t.replace(Xt,"ms-").replace(zt,y)}function b(){this.expando=Tt.expando+b.uid++}function _(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Ht.test(t)?JSON.parse(t):t)}function x(t,e,i){var r;if(void 0===i&&1===t.nodeType)if(r="data-"+e.replace(qt,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(r))){try{i=_(i)}catch(t){}Yt.set(t,e,i)}else i=void 0;return i}function w(t,e,i,r){var n,o,s=20,a=r?function(){return r.cur()}:function(){return Tt.css(t,e,"")},c=a(),l=i&&i[3]||(Tt.cssNumber[e]?"":"px"),u=(Tt.cssNumber[e]||"px"!==l&&+c)&&Vt.exec(Tt.css(t,e));if(u&&u[3]!==l){for(c/=2,l=l||u[3],u=+c||1;s--;)Tt.style(t,e,u+l),(1-o)*(1-(o=a()/c||.5))>0||(s=0),u/=o;u*=2,Tt.style(t,e,u+l),i=i||[]}return i&&(u=+u||+c||0,n=i[1]?u+(i[1]+1)*i[2]:+i[2],r&&(r.unit=l,r.start=u,r.end=n)),n}function C(t){var e,i=t.ownerDocument,r=t.nodeName,n=Kt[r];return n||(e=i.body.appendChild(i.createElement(r)),n=Tt.css(e,"display"),e.parentNode.removeChild(e),"none"===n&&(n="block"),Kt[r]=n,n)}function O(t,e){for(var i,r,n=[],o=0,s=t.length;s>o;o++)r=t[o],r.style&&(i=r.style.display,e?("none"===i&&((n[o]=Wt.get(r,"display")||null)||(r.style.display="")),""===r.style.display&&Jt(r)&&(n[o]=C(r))):"none"!==i&&(n[o]="none",Wt.set(r,"display",i)));for(o=0;s>o;o++)null!=n[o]&&(t[o].style.display=n[o]);return t}function T(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&l(t,e)?Tt.merge([t],i):i}function S(t,e){for(var i=0,r=t.length;r>i;i++)Wt.set(t[i],"globalEval",!e||Wt.get(e[i],"globalEval"))}function j(t,e,i,r,n){for(var o,s,c,l,u,h,f=e.createDocumentFragment(),d=[],p=0,g=t.length;g>p;p++)if((o=t[p])||0===o)if("object"===a(o))Tt.merge(d,o.nodeType?[o]:o);else if(re.test(o)){for(s=s||f.appendChild(e.createElement("div")),c=(te.exec(o)||["",""])[1].toLowerCase(),l=ie[c]||ie._default,s.innerHTML=l[1]+Tt.htmlPrefilter(o)+l[2],h=l[0];h--;)s=s.lastChild;Tt.merge(d,s.childNodes),s=f.firstChild,s.textContent=""}else d.push(e.createTextNode(o));for(f.textContent="",p=0;o=d[p++];)if(r&&-1<Tt.inArray(o,r))n&&n.push(o);else if(u=Tt.contains(o.ownerDocument,o),s=T(f.appendChild(o),"script"),u&&S(s),i)for(h=0;o=s[h++];)ee.test(o.type||"")&&i.push(o);return f}function k(){return!0}function A(){return!1}function P(){try{return ut.activeElement}catch(t){}}function E(t,e,i,r,n,o){var s,a;if("object"==typeof e){"string"!=typeof i&&(r=r||i,i=void 0);for(a in e)E(t,a,i,r,e[a],o);return t}if(null==r&&null==n?(n=i,r=i=void 0):null==n&&("string"==typeof i?(n=r,r=void 0):(n=r,r=i,i=void 0)),!1===n)n=A;else if(!n)return t;return 1===o&&(s=n,n=function(t){return Tt().off(t),s.apply(this,arguments)},n.guid=s.guid||(s.guid=Tt.guid++)),t.each(function(){Tt.event.add(this,e,n,r,i)})}function L(t,e){return l(t,"table")&&l(11!==e.nodeType?e:e.firstChild,"tr")?Tt(t).children("tbody")[0]||t:t}function M(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function D(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function I(t,e){var i,r,n,o,s,a,c,l;if(1===e.nodeType){if(Wt.hasData(t)&&(o=Wt.access(t),s=Wt.set(e,o),l=o.events)){delete s.handle,s.events={};for(n in l)for(i=0,r=l[n].length;r>i;i++)Tt.event.add(e,n,l[n][i])}Yt.hasData(t)&&(a=Yt.access(t),c=Tt.extend({},a),Yt.set(e,c))}}function R(t,e){var i=e.nodeName.toLowerCase();"input"===i&&Qt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function B(t,e,i,r){e=dt.apply([],e);var n,o,a,c,l,u,h=0,f=t.length,d=f-1,p=e[0],g=wt(p);if(g||f>1&&"string"==typeof p&&!xt.checkClone&&ue.test(p))return t.each(function(n){var o=t.eq(n);g&&(e[0]=p.call(this,n,o.html())),B(o,e,i,r)});if(f&&(n=j(e,t[0].ownerDocument,!1,t,r),o=n.firstChild,1===n.childNodes.length&&(n=o),o||r)){for(a=Tt.map(T(n,"script"),M),c=a.length;f>h;h++)l=n,h!==d&&(l=Tt.clone(l,!0,!0),c&&Tt.merge(a,T(l,"script"))),i.call(t[h],l,h);if(c)for(u=a[a.length-1].ownerDocument,Tt.map(a,D),h=0;c>h;h++)l=a[h],ee.test(l.type||"")&&!Wt.access(l,"globalEval")&&Tt.contains(u,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?Tt._evalUrl&&Tt._evalUrl(l.src):s(l.textContent.replace(he,""),u,l))}return t}function F(t,e,i){for(var r,n=e?Tt.filter(e,t):t,o=0;null!=(r=n[o]);o++)i||1!==r.nodeType||Tt.cleanData(T(r)),r.parentNode&&(i&&Tt.contains(r.ownerDocument,r)&&S(T(r,"script")),r.parentNode.removeChild(r));return t}function N(t,e,i){var r,n,o,s,a=t.style;return i=i||de(t),i&&(s=i.getPropertyValue(e)||i[e],""!==s||Tt.contains(t.ownerDocument,t)||(s=Tt.style(t,e)),!xt.pixelBoxStyles()&&fe.test(s)&&pe.test(e)&&(r=a.width,n=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=r,a.minWidth=n,a.maxWidth=o)),void 0!==s?s+"":s}function X(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function z(t){if(t in _e)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=be.length;i--;)if((t=be[i]+e)in _e)return t}function G(t){var e=Tt.cssProps[t];return e||(e=Tt.cssProps[t]=z(t)||t),e}function W(t,e,i){var r=Vt.exec(e);return r?Math.max(0,r[2]-(i||0))+(r[3]||"px"):e}function Y(t,e,i,r,n,o){var s="width"===e?1:0,a=0,c=0;if(i===(r?"border":"content"))return 0;for(;4>s;s+=2)"margin"===i&&(c+=Tt.css(t,i+$t[s],!0,n)),r?("content"===i&&(c-=Tt.css(t,"padding"+$t[s],!0,n)),"margin"!==i&&(c-=Tt.css(t,"border"+$t[s]+"Width",!0,n))):(c+=Tt.css(t,"padding"+$t[s],!0,n),"padding"!==i?c+=Tt.css(t,"border"+$t[s]+"Width",!0,n):a+=Tt.css(t,"border"+$t[s]+"Width",!0,n));return r||0>o||(c+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-c-a-.5))),c}function H(t,e,i){var r=de(t),n=N(t,e,r),o="border-box"===Tt.css(t,"boxSizing",!1,r),s=o;if(fe.test(n)){if(!i)return n;n="auto"}return s=s&&(xt.boxSizingReliable()||n===t.style[e]),("auto"===n||!parseFloat(n)&&"inline"===Tt.css(t,"display",!1,r))&&(n=t["offset"+e[0].toUpperCase()+e.slice(1)],s=!0),(n=parseFloat(n)||0)+Y(t,e,i||(o?"border":"content"),s,r,n)+"px"}function q(t,e,i,r,n){return new q.prototype.init(t,e,i,r,n)}function U(){we&&(!1===ut.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(U):i.setTimeout(U,Tt.fx.interval),Tt.fx.tick())}function V(){return i.setTimeout(function(){xe=void 0}),xe=Date.now()}function $(t,e){var i,r=0,n={height:t};for(e=e?1:0;4>r;r+=2-e)i=$t[r],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function J(t,e,i){for(var r,n=(Q.tweeners[e]||[]).concat(Q.tweeners["*"]),o=0,s=n.length;s>o;o++)if(r=n[o].call(i,e,t))return r}function Z(t,e,i){var r,n,o,s,a,c,l,u,h="width"in e||"height"in e,f=this,d={},p=t.style,g=t.nodeType&&Jt(t),v=Wt.get(t,"fxshow");i.queue||(s=Tt._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,f.always(function(){f.always(function(){s.unqueued--,Tt.queue(t,"fx").length||s.empty.fire()})}));for(r in e)if(n=e[r],Ce.test(n)){if(delete e[r],o=o||"toggle"===n,n===(g?"hide":"show")){if("show"!==n||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||Tt.style(t,r)}if((c=!Tt.isEmptyObject(e))||!Tt.isEmptyObject(d)){h&&1===t.nodeType&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],l=v&&v.display,null==l&&(l=Wt.get(t,"display")),u=Tt.css(t,"display"),"none"===u&&(l?u=l:(O([t],!0),l=t.style.display||l,u=Tt.css(t,"display"),O([t]))),("inline"===u||"inline-block"===u&&null!=l)&&"none"===Tt.css(t,"float")&&(c||(f.done(function(){p.display=l}),null==l&&(u=p.display,l="none"===u?"":u)),p.display="inline-block")),i.overflow&&(p.overflow="hidden",f.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]})),c=!1;for(r in d)c||(v?"hidden"in v&&(g=v.hidden):v=Wt.access(t,"fxshow",{display:l}),o&&(v.hidden=!g),g&&O([t],!0),f.done(function(){g||O([t]),Wt.remove(t,"fxshow");for(r in d)Tt.style(t,r,d[r])})),c=J(g?v[r]:0,r,f),r in v||(v[r]=c.start,g&&(c.end=c.start,c.start=0))}}function K(t,e){var i,r,n,o,s;for(i in t)if(r=m(i),n=e[r],o=t[i],Array.isArray(o)&&(n=o[1],o=t[i]=o[0]),i!==r&&(t[r]=o,delete t[i]),(s=Tt.cssHooks[r])&&"expand"in s){o=s.expand(o),delete t[r];for(i in o)i in t||(t[i]=o[i],e[i]=n)}else e[r]=n}function Q(t,e,i){var r,n,o=0,s=Q.prefilters.length,a=Tt.Deferred().always(function(){delete c.elem}),c=function(){if(n)return!1;for(var e=xe||V(),i=Math.max(0,l.startTime+l.duration-e),r=i/l.duration||0,o=1-r,s=0,c=l.tweens.length;c>s;s++)l.tweens[s].run(o);return a.notifyWith(t,[l,o,i]),1>o&&c?i:(c||a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:Tt.extend({},e),opts:Tt.extend(!0,{specialEasing:{},easing:Tt.easing._default},i),originalProperties:e,originalOptions:i,startTime:xe||V(),duration:i.duration,tweens:[],createTween:function(e,i){var r=Tt.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(r),r},stop:function(e){var i=0,r=e?l.tweens.length:0;if(n)return this;for(n=!0;r>i;i++)l.tweens[i].run(1);return e?(a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l,e])):a.rejectWith(t,[l,e]),this}}),u=l.props;for(K(u,l.opts.specialEasing);s>o;o++)if(r=Q.prefilters[o].call(l,t,u,l.opts))return wt(r.stop)&&(Tt._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return Tt.map(u,J,l),wt(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),Tt.fx.timer(Tt.extend(c,{elem:t,anim:l,queue:l.opts.queue})),l}function tt(t){return(t.match(Rt)||[]).join(" ")}function et(t){return t.getAttribute&&t.getAttribute("class")||""}function it(t){return Array.isArray(t)?t:"string"==typeof t?t.match(Rt)||[]:[]}function rt(t,e,i,r){var n;if(Array.isArray(e))Tt.each(e,function(e,n){i||Ie.test(t)?r(t,n):rt(t+"["+("object"==typeof n&&null!=n?e:"")+"]",n,i,r)});else if(i||"object"!==a(e))r(t,e);else for(n in e)rt(t+"["+n+"]",e[n],i,r)}function nt(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var r,n=0,o=e.toLowerCase().match(Rt)||[];if(wt(i))for(;r=o[n++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(i)):(t[r]=t[r]||[]).push(i)}}function ot(t,e,i,r){function n(a){var c;return o[a]=!0,Tt.each(t[a]||[],function(t,a){var l=a(e,i,r);return"string"!=typeof l||s||o[l]?s?!(c=l):void 0:(e.dataTypes.unshift(l),n(l),!1)}),c}var o={},s=t===Ue;return n(e.dataTypes[0])||!o["*"]&&n("*")}function st(t,e){var i,r,n=Tt.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((n[i]?t:r||(r={}))[i]=e[i]);return r&&Tt.extend(!0,t,r),t}function at(t,e,i){for(var r,n,o,s,a=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(n in a)if(a[n]&&a[n].test(r)){c.unshift(n);break}if(c[0]in i)o=c[0];else{for(n in i){if(!c[0]||t.converters[n+" "+c[0]]){o=n;break}s||(s=n)}o=o||s}if(o)return o!==c[0]&&c.unshift(o),i[o]}function ct(t,e,i,r){var n,o,s,a,c,l={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=u.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!c&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=o,o=u.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(s=l[c+" "+o]||l["* "+o]))for(n in l)if(a=n.split(" "),a[1]===o&&(s=l[c+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[n]:!0!==l[n]&&(o=a[0],u.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+c+" to "+o}}}return{state:"success",data:e}}var lt=[],ut=i.document,ht=Object.getPrototypeOf,ft=lt.slice,dt=lt.concat,pt=lt.push,gt=lt.indexOf,vt={},yt=vt.toString,mt=vt.hasOwnProperty,bt=mt.toString,_t=bt.call(Object),xt={},wt=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},Ct=function(t){return null!=t&&t===t.window},Ot={type:!0,src:!0,noModule:!0},Tt=function(t,e){return new Tt.fn.init(t,e)},St=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;Tt.fn=Tt.prototype={jquery:"3.3.1",constructor:Tt,length:0,toArray:function(){return ft.call(this)},get:function(t){return null==t?ft.call(this):0>t?this[t+this.length]:this[t]},pushStack:function(t){var e=Tt.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return Tt.each(this,t)},map:function(t){return this.pushStack(Tt.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(ft.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:pt,sort:lt.sort,splice:lt.splice},Tt.extend=Tt.fn.extend=function(){var t,e,i,r,n,o,s=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||wt(s)||(s={}),a===c&&(s=this,a--);c>a;a++)if(null!=(t=arguments[a]))for(e in t)i=s[e],r=t[e],s!==r&&(l&&r&&(Tt.isPlainObject(r)||(n=Array.isArray(r)))?(n?(n=!1,o=i&&Array.isArray(i)?i:[]):o=i&&Tt.isPlainObject(i)?i:{},s[e]=Tt.extend(l,o,r)):void 0!==r&&(s[e]=r));return s},Tt.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==yt.call(t))&&(!(e=ht(t))||"function"==typeof(i=mt.call(e,"constructor")&&e.constructor)&&bt.call(i)===_t)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t){s(t)},each:function(t,e){var i,r=0;if(c(t))for(i=t.length;i>r&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(St,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(c(Object(t))?Tt.merge(i,"string"==typeof t?[t]:t):pt.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:gt.call(e,t,i)},merge:function(t,e){for(var i=+e.length,r=0,n=t.length;i>r;r++)t[n++]=e[r];return t.length=n,t},grep:function(t,e,i){for(var r=[],n=0,o=t.length,s=!i;o>n;n++)!e(t[n],n)!==s&&r.push(t[n]);return r},map:function(t,e,i){var r,n,o=0,s=[];if(c(t))for(r=t.length;r>o;o++)null!=(n=e(t[o],o,i))&&s.push(n);else for(o in t)null!=(n=e(t[o],o,i))&&s.push(n);return dt.apply([],s)},guid:1,support:xt}),"function"==typeof Symbol&&(Tt.fn[Symbol.iterator]=lt[Symbol.iterator]),Tt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){vt["[object "+e+"]"]=e.toLowerCase()});var jt=/*!
 * Sizzle CSS Selector Engine v2.3.3
 * https://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-08-08
 */
function(t){function e(t,e,i,r){var n,o,s,a,c,u,f,d=e&&e.ownerDocument,p=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return i;if(!r&&((e?e.ownerDocument||e:N)!==E&&P(e),e=e||E,M)){if(11!==p&&(c=gt.exec(t)))if(n=c[1]){if(9===p){if(!(s=e.getElementById(n)))return i;if(s.id===n)return i.push(s),i}else if(d&&(s=d.getElementById(n))&&B(e,s)&&s.id===n)return i.push(s),i}else{if(c[2])return J.apply(i,e.getElementsByTagName(t)),i;if((n=c[3])&&_.getElementsByClassName&&e.getElementsByClassName)return J.apply(i,e.getElementsByClassName(n)),i}if(_.qsa&&!Y[t+" "]&&(!D||!D.test(t))){if(1!==p)d=e,f=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(bt,_t):e.setAttribute("id",a=F),u=O(t),o=u.length;o--;)u[o]="#"+a+" "+h(u[o]);f=u.join(","),d=vt.test(t)&&l(e.parentNode)||e}if(f)try{return J.apply(i,d.querySelectorAll(f)),i}catch(t){}finally{a===F&&e.removeAttribute("id")}}}return S(t.replace(ot,"$1"),e,i,r)}function i(){function t(i,r){return e.push(i+" ")>x.cacheLength&&delete t[e.shift()],t[i+" "]=r}var e=[];return t}function r(t){return t[F]=!0,t}function n(t){var e=E.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),r=i.length;r--;)x.attrHandle[i[r]]=e}function s(t,e){var i=e&&t,r=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(r)return r;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&wt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function c(t){return r(function(e){return e=+e,r(function(i,r){for(var n,o=t([],i.length,e),s=o.length;s--;)i[n=o[s]]&&(i[n]=!(r[n]=i[n]))})})}function l(t){return t&&void 0!==t.getElementsByTagName&&t}function u(){}function h(t){for(var e=0,i=t.length,r="";i>e;e++)r+=t[e].value;return r}function f(t,e,i){var r=e.dir,n=e.next,o=n||r,s=i&&"parentNode"===o,a=z++;return e.first?function(e,i,n){for(;e=e[r];)if(1===e.nodeType||s)return t(e,i,n);return!1}:function(e,i,c){var l,u,h,f=[X,a];if(c){for(;e=e[r];)if((1===e.nodeType||s)&&t(e,i,c))return!0}else for(;e=e[r];)if(1===e.nodeType||s)if(h=e[F]||(e[F]={}),u=h[e.uniqueID]||(h[e.uniqueID]={}),n&&n===e.nodeName.toLowerCase())e=e[r]||e;else{if((l=u[o])&&l[0]===X&&l[1]===a)return f[2]=l[2];if(u[o]=f,f[2]=t(e,i,c))return!0}return!1}}function d(t){return t.length>1?function(e,i,r){for(var n=t.length;n--;)if(!t[n](e,i,r))return!1;return!0}:t[0]}function p(t,i,r){for(var n=0,o=i.length;o>n;n++)e(t,i[n],r);return r}function g(t,e,i,r,n){for(var o,s=[],a=0,c=t.length,l=null!=e;c>a;a++)(o=t[a])&&(i&&!i(o,r,n)||(s.push(o),l&&e.push(a)));return s}function v(t,e,i,n,o,s){return n&&!n[F]&&(n=v(n)),o&&!o[F]&&(o=v(o,s)),r(function(r,s,a,c){var l,u,h,f=[],d=[],v=s.length,y=r||p(e||"*",a.nodeType?[a]:a,[]),m=!t||!r&&e?y:g(y,f,t,a,c),b=i?o||(r?t:v||n)?[]:s:m;if(i&&i(m,b,a,c),n)for(l=g(b,d),n(l,[],a,c),u=l.length;u--;)(h=l[u])&&(b[d[u]]=!(m[d[u]]=h));if(r){if(o||t){if(o){for(l=[],u=b.length;u--;)(h=b[u])&&l.push(m[u]=h);o(null,b=[],l,c)}for(u=b.length;u--;)(h=b[u])&&(l=o?K(r,h):f[u])>-1&&(r[l]=!(s[l]=h))}}else b=g(b===s?b.splice(v,b.length):b),o?o(null,s,b,c):J.apply(s,b)})}function y(t){for(var e,i,r,n=t.length,o=x.relative[t[0].type],s=o||x.relative[" "],a=o?1:0,c=f(function(t){return t===e},s,!0),l=f(function(t){return K(e,t)>-1},s,!0),u=[function(t,i,r){var n=!o&&(r||i!==j)||((e=i).nodeType?c(t,i,r):l(t,i,r));return e=null,n}];n>a;a++)if(i=x.relative[t[a].type])u=[f(d(u),i)];else{if(i=x.filter[t[a].type].apply(null,t[a].matches),i[F]){for(r=++a;n>r&&!x.relative[t[r].type];r++);return v(a>1&&d(u),a>1&&h(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ot,"$1"),i,r>a&&y(t.slice(a,r)),n>r&&y(t=t.slice(r)),n>r&&h(t))}u.push(i)}return d(u)}function m(t,i){var n=i.length>0,o=t.length>0,s=function(r,s,a,c,l){var u,h,f,d=0,p="0",v=r&&[],y=[],m=j,b=r||o&&x.find.TAG("*",l),_=X+=null==m?1:Math.random()||.1,w=b.length;for(l&&(j=s===E||s||l);p!==w&&null!=(u=b[p]);p++){if(o&&u){for(h=0,s||u.ownerDocument===E||(P(u),a=!M);f=t[h++];)if(f(u,s||E,a)){c.push(u);break}l&&(X=_)}n&&((u=!f&&u)&&d--,r&&v.push(u))}if(d+=p,n&&p!==d){for(h=0;f=i[h++];)f(v,y,s,a);if(r){if(d>0)for(;p--;)v[p]||y[p]||(y[p]=V.call(c));y=g(y)}J.apply(c,y),l&&!r&&y.length>0&&d+i.length>1&&e.uniqueSort(c)}return l&&(X=_,j=m),v};return n?r(s):s}var b,_,x,w,C,O,T,S,j,k,A,P,E,L,M,D,I,R,B,F="sizzle"+1*new Date,N=t.document,X=0,z=0,G=i(),W=i(),Y=i(),H=function(t,e){return t===e&&(A=!0),0},q={}.hasOwnProperty,U=[],V=U.pop,$=U.push,J=U.push,Z=U.slice,K=function(t,e){for(var i=0,r=t.length;r>i;i++)if(t[i]===e)return i;return-1},Q="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",et="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",it="\\["+tt+"*("+et+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+et+"))|)"+tt+"*\\]",rt=":("+et+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+it+")*)|.*)\\)|)",nt=RegExp(tt+"+","g"),ot=RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),st=RegExp("^"+tt+"*,"+tt+"*"),at=RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),ct=RegExp("="+tt+"*([^\\]'\"]*?)"+tt+"*\\]","g"),lt=RegExp(rt),ut=RegExp("^"+et+"$"),ht={ID:RegExp("^#("+et+")"),CLASS:RegExp("^\\.("+et+")"),TAG:RegExp("^("+et+"|[*])"),ATTR:RegExp("^"+it),PSEUDO:RegExp("^"+rt),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:RegExp("^(?:"+Q+")$","i"),needsContext:RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},ft=/^(?:input|select|textarea|button)$/i,dt=/^h\d$/i,pt=/^[^{]+\{\s*\[native \w/,gt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,vt=/[+~]/,yt=RegExp("\\\\([\\da-f]{1,6}"+tt+"?|("+tt+")|.)","ig"),mt=function(t,e,i){var r="0x"+e-65536;return r!==r||i?e:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},bt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,_t=function(t,e){return e?"\0"===t?"":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},xt=function(){P()},wt=f(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{J.apply(U=Z.call(N.childNodes),N.childNodes)}catch(t){J={apply:U.length?function(t,e){$.apply(t,Z.call(e))}:function(t,e){for(var i=t.length,r=0;t[i++]=e[r++];);t.length=i-1}}}_=e.support={},C=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},P=e.setDocument=function(t){var e,i,r=t?t.ownerDocument||t:N;return r!==E&&9===r.nodeType&&r.documentElement?(E=r,L=E.documentElement,M=!C(E),N!==E&&(i=E.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",xt,!1):i.attachEvent&&i.attachEvent("onunload",xt)),_.attributes=n(function(t){return t.className="i",!t.getAttribute("className")}),_.getElementsByTagName=n(function(t){return t.appendChild(E.createComment("")),!t.getElementsByTagName("*").length}),_.getElementsByClassName=pt.test(E.getElementsByClassName),_.getById=n(function(t){return L.appendChild(t).id=F,!E.getElementsByName||!E.getElementsByName(F).length}),_.getById?(x.filter.ID=function(t){var e=t.replace(yt,mt);return function(t){return t.getAttribute("id")===e}},x.find.ID=function(t,e){if(void 0!==e.getElementById&&M){var i=e.getElementById(t);return i?[i]:[]}}):(x.filter.ID=function(t){var e=t.replace(yt,mt);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},x.find.ID=function(t,e){if(void 0!==e.getElementById&&M){var i,r,n,o=e.getElementById(t);if(o){if((i=o.getAttributeNode("id"))&&i.value===t)return[o];for(n=e.getElementsByName(t),r=0;o=n[r++];)if((i=o.getAttributeNode("id"))&&i.value===t)return[o]}return[]}}),x.find.TAG=_.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):_.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,r=[],n=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[n++];)1===i.nodeType&&r.push(i);return r}return o},x.find.CLASS=_.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&M)return e.getElementsByClassName(t)},I=[],D=[],(_.qsa=pt.test(E.querySelectorAll))&&(n(function(t){L.appendChild(t).innerHTML="<a id='"+F+"'></a><select id='"+F+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+tt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||D.push("\\["+tt+"*(?:value|"+Q+")"),t.querySelectorAll("[id~="+F+"-]").length||D.push("~="),t.querySelectorAll(":checked").length||D.push(":checked"),t.querySelectorAll("a#"+F+"+*").length||D.push(".#.+[+~]")}),n(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=E.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&D.push("name"+tt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&D.push(":enabled",":disabled"),L.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&D.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),D.push(",.*:")})),(_.matchesSelector=pt.test(R=L.matches||L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&n(function(t){_.disconnectedMatch=R.call(t,"*"),R.call(t,"[s!='']:x"),I.push("!=",rt)}),D=D.length&&RegExp(D.join("|")),I=I.length&&RegExp(I.join("|")),e=pt.test(L.compareDocumentPosition),B=e||pt.test(L.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(i.contains?i.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},H=e?function(t,e){if(t===e)return A=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!_.sortDetached&&e.compareDocumentPosition(t)===i?t===E||t.ownerDocument===N&&B(N,t)?-1:e===E||e.ownerDocument===N&&B(N,e)?1:k?K(k,t)-K(k,e):0:4&i?-1:1)}:function(t,e){if(t===e)return A=!0,0;var i,r=0,n=t.parentNode,o=e.parentNode,a=[t],c=[e];if(!n||!o)return t===E?-1:e===E?1:n?-1:o?1:k?K(k,t)-K(k,e):0;if(n===o)return s(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)c.unshift(i);for(;a[r]===c[r];)r++;return r?s(a[r],c[r]):a[r]===N?-1:c[r]===N?1:0},E):E},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==E&&P(t),i=i.replace(ct,"='$1']"),_.matchesSelector&&M&&!Y[i+" "]&&(!I||!I.test(i))&&(!D||!D.test(i)))try{var r=R.call(t,i);if(r||_.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){}return e(i,E,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==E&&P(t),B(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==E&&P(t);var i=x.attrHandle[e.toLowerCase()],r=i&&q.call(x.attrHandle,e.toLowerCase())?i(t,e,!M):void 0;return void 0!==r?r:_.attributes||!M?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},e.escape=function(t){return(t+"").replace(bt,_t)},e.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],r=0,n=0;if(A=!_.detectDuplicates,k=!_.sortStable&&t.slice(0),t.sort(H),A){for(;e=t[n++];)e===t[n]&&(r=i.push(n));for(;r--;)t.splice(i[r],1)}return k=null,t},w=e.getText=function(t){var e,i="",r=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=w(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[r++];)i+=w(e);return i},x=e.selectors={cacheLength:50,createPseudo:r,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(yt,mt),t[3]=(t[3]||t[4]||t[5]||"").replace(yt,mt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&lt.test(i)&&(e=O(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(yt,mt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=G[t+" "];return e||(e=RegExp("(^|"+tt+")"+t+"("+tt+"|$)"))&&G(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,r){return function(n){var o=e.attr(n,t);return null==o?"!="===i:!i||(o+="","="===i?o===r:"!="===i?o!==r:"^="===i?r&&0===o.indexOf(r):"*="===i?r&&o.indexOf(r)>-1:"$="===i?r&&o.slice(-r.length)===r:"~="===i?(" "+o.replace(nt," ")+" ").indexOf(r)>-1:"|="===i&&(o===r||o.slice(0,r.length+1)===r+"-"))}},CHILD:function(t,e,i,r,n){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===r&&0===n?function(t){return!!t.parentNode}:function(e,i,c){var l,u,h,f,d,p,g=o!==s?"nextSibling":"previousSibling",v=e.parentNode,y=a&&e.nodeName.toLowerCase(),m=!c&&!a,b=!1;if(v){if(o){for(;g;){for(f=e;f=f[g];)if(a?f.nodeName.toLowerCase()===y:1===f.nodeType)return!1;p=g="only"===t&&!p&&"nextSibling"}return!0}if(p=[s?v.firstChild:v.lastChild],s&&m){for(f=v,h=f[F]||(f[F]={}),u=h[f.uniqueID]||(h[f.uniqueID]={}),l=u[t]||[],d=l[0]===X&&l[1],b=d&&l[2],f=d&&v.childNodes[d];f=++d&&f&&f[g]||(b=d=0)||p.pop();)if(1===f.nodeType&&++b&&f===e){u[t]=[X,d,b];break}}else if(m&&(f=e,h=f[F]||(f[F]={}),u=h[f.uniqueID]||(h[f.uniqueID]={}),l=u[t]||[],d=l[0]===X&&l[1],b=d),!1===b)for(;(f=++d&&f&&f[g]||(b=d=0)||p.pop())&&((a?f.nodeName.toLowerCase()!==y:1!==f.nodeType)||!++b||(m&&(h=f[F]||(f[F]={}),u=h[f.uniqueID]||(h[f.uniqueID]={}),u[t]=[X,b]),f!==e)););return(b-=n)===r||b%r==0&&b/r>=0}}},PSEUDO:function(t,i){var n,o=x.pseudos[t]||x.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[F]?o(i):o.length>1?(n=[t,t,"",i],x.setFilters.hasOwnProperty(t.toLowerCase())?r(function(t,e){for(var r,n=o(t,i),s=n.length;s--;)r=K(t,n[s]),t[r]=!(e[r]=n[s])}):function(t){return o(t,0,n)}):o}},pseudos:{not:r(function(t){var e=[],i=[],n=T(t.replace(ot,"$1"));return n[F]?r(function(t,e,i,r){for(var o,s=n(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,r,o){return e[0]=t,n(e,null,o,i),e[0]=null,!i.pop()}}),has:r(function(t){return function(i){return e(t,i).length>0}}),contains:r(function(t){return t=t.replace(yt,mt),function(e){return(e.textContent||e.innerText||w(e)).indexOf(t)>-1}}),lang:r(function(t){return ut.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(yt,mt).toLowerCase(),function(e){var i;do{if(i=M?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===L},focus:function(t){return t===E.activeElement&&(!E.hasFocus||E.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(6>t.nodeType)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return dt.test(t.nodeName)},input:function(t){return ft.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,i){return[0>i?i+e:i]}),even:c(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:c(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:c(function(t,e,i){for(var r=0>i?i+e:i;--r>=0;)t.push(r);return t}),gt:c(function(t,e,i){for(var r=0>i?i+e:i;++r<e;)t.push(r);return t})}},x.pseudos.nth=x.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[b]=function(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}(b);for(b in{submit:!0,reset:!0})x.pseudos[b]=function(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}(b);return u.prototype=x.filters=x.pseudos,x.setFilters=new u,O=e.tokenize=function(t,i){var r,n,o,s,a,c,l,u=W[t+" "];if(u)return i?0:u.slice(0);for(a=t,c=[],l=x.preFilter;a;){r&&!(n=st.exec(a))||(n&&(a=a.slice(n[0].length)||a),c.push(o=[])),r=!1,(n=at.exec(a))&&(r=n.shift(),o.push({value:r,type:n[0].replace(ot," ")}),a=a.slice(r.length));for(s in x.filter)!(n=ht[s].exec(a))||l[s]&&!(n=l[s](n))||(r=n.shift(),o.push({value:r,type:s,matches:n}),a=a.slice(r.length));if(!r)break}return i?a.length:a?e.error(t):W(t,c).slice(0)},T=e.compile=function(t,e){var i,r=[],n=[],o=Y[t+" "];if(!o){for(e||(e=O(t)),i=e.length;i--;)o=y(e[i]),o[F]?r.push(o):n.push(o);o=Y(t,m(n,r)),o.selector=t}return o},S=e.select=function(t,e,i,r){var n,o,s,a,c,u="function"==typeof t&&t,f=!r&&O(t=u.selector||t);if(i=i||[],1===f.length){if(o=f[0]=f[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===e.nodeType&&M&&x.relative[o[1].type]){if(!(e=(x.find.ID(s.matches[0].replace(yt,mt),e)||[])[0]))return i;u&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(n=ht.needsContext.test(t)?0:o.length;n--&&(s=o[n],!x.relative[a=s.type]);)if((c=x.find[a])&&(r=c(s.matches[0].replace(yt,mt),vt.test(o[0].type)&&l(e.parentNode)||e))){if(o.splice(n,1),!(t=r.length&&h(o)))return J.apply(i,r),i;break}}return(u||T(t,f))(r,e,!M,i,!e||vt.test(t)&&l(e.parentNode)||e),i},_.sortStable=F.split("").sort(H).join("")===F,_.detectDuplicates=!!A,P(),_.sortDetached=n(function(t){return 1&t.compareDocumentPosition(E.createElement("fieldset"))}),n(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),_.attributes&&n(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),n(function(t){return null==t.getAttribute("disabled")})||o(Q,function(t,e,i){var r;if(!i)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),e}(i);Tt.find=jt,Tt.expr=jt.selectors,Tt.expr[":"]=Tt.expr.pseudos,Tt.uniqueSort=Tt.unique=jt.uniqueSort,Tt.text=jt.getText,Tt.isXMLDoc=jt.isXML,Tt.contains=jt.contains,Tt.escapeSelector=jt.escape;var kt=function(t,e,i){for(var r=[],n=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(n&&Tt(t).is(i))break;r.push(t)}return r},At=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},Pt=Tt.expr.match.needsContext,Et=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;Tt.filter=function(t,e,i){var r=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?Tt.find.matchesSelector(r,t)?[r]:[]:Tt.find.matches(t,Tt.grep(e,function(t){return 1===t.nodeType}))},Tt.fn.extend({find:function(t){var e,i,r=this.length,n=this;if("string"!=typeof t)return this.pushStack(Tt(t).filter(function(){for(e=0;r>e;e++)if(Tt.contains(n[e],this))return!0}));for(i=this.pushStack([]),e=0;r>e;e++)Tt.find(t,n[e],i);return r>1?Tt.uniqueSort(i):i},filter:function(t){return this.pushStack(u(this,t||[],!1))},not:function(t){return this.pushStack(u(this,t||[],!0))},is:function(t){return!!u(this,"string"==typeof t&&Pt.test(t)?Tt(t):t||[],!1).length}});var Lt,Mt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(Tt.fn.init=function(t,e,i){var r,n;if(!t)return this;if(i=i||Lt,"string"==typeof t){if(!(r="<"!==t[0]||">"!==t[t.length-1]||3>t.length?Mt.exec(t):[null,t,null])||!r[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(r[1]){if(e=e instanceof Tt?e[0]:e,Tt.merge(this,Tt.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:ut,!0)),Et.test(r[1])&&Tt.isPlainObject(e))for(r in e)wt(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return n=ut.getElementById(r[2]),n&&(this[0]=n,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):wt(t)?void 0!==i.ready?i.ready(t):t(Tt):Tt.makeArray(t,this)}).prototype=Tt.fn,Lt=Tt(ut);var Dt=/^(?:parents|prev(?:Until|All))/,It={children:!0,contents:!0,next:!0,prev:!0};Tt.fn.extend({has:function(t){var e=Tt(t,this),i=e.length;return this.filter(function(){for(var t=0;i>t;t++)if(Tt.contains(this,e[t]))return!0})},closest:function(t,e){var i,r=0,n=this.length,o=[],s="string"!=typeof t&&Tt(t);if(!Pt.test(t))for(;n>r;r++)for(i=this[r];i&&i!==e;i=i.parentNode)if(11>i.nodeType&&(s?s.index(i)>-1:1===i.nodeType&&Tt.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?Tt.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?gt.call(Tt(t),this[0]):gt.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Tt.uniqueSort(Tt.merge(this.get(),Tt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Tt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return kt(t,"parentNode")},parentsUntil:function(t,e,i){return kt(t,"parentNode",i)},next:function(t){return h(t,"nextSibling")},prev:function(t){return h(t,"previousSibling")},nextAll:function(t){return kt(t,"nextSibling")},prevAll:function(t){return kt(t,"previousSibling")},nextUntil:function(t,e,i){return kt(t,"nextSibling",i)},prevUntil:function(t,e,i){return kt(t,"previousSibling",i)},siblings:function(t){return At((t.parentNode||{}).firstChild,t)},children:function(t){return At(t.firstChild)},contents:function(t){return l(t,"iframe")?t.contentDocument:(l(t,"template")&&(t=t.content||t),Tt.merge([],t.childNodes))}},function(t,e){Tt.fn[t]=function(i,r){var n=Tt.map(this,e,i);return"Until"!==t.slice(-5)&&(r=i),r&&"string"==typeof r&&(n=Tt.filter(r,n)),this.length>1&&(It[t]||Tt.uniqueSort(n),Dt.test(t)&&n.reverse()),this.pushStack(n)}});var Rt=/[^\x20\t\r\n\f]+/g;Tt.Callbacks=function(t){t="string"==typeof t?f(t):Tt.extend({},t);var e,i,r,n,o=[],s=[],c=-1,l=function(){for(n=n||t.once,r=e=!0;s.length;c=-1)for(i=s.shift();++c<o.length;)!1===o[c].apply(i[0],i[1])&&t.stopOnFalse&&(c=o.length,i=!1);t.memory||(i=!1),e=!1,n&&(o=i?[]:"")},u={add:function(){return o&&(i&&!e&&(c=o.length-1,s.push(i)),function e(i){Tt.each(i,function(i,r){wt(r)?t.unique&&u.has(r)||o.push(r):r&&r.length&&"string"!==a(r)&&e(r)})}(arguments),i&&!e&&l()),this},remove:function(){return Tt.each(arguments,function(t,e){for(var i;(i=Tt.inArray(e,o,i))>-1;)o.splice(i,1),i>c||c--}),this},has:function(t){return t?Tt.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return n=s=[],o=i="",this},disabled:function(){return!o},lock:function(){return n=s=[],i||e||(o=i=""),this},locked:function(){return!!n},fireWith:function(t,i){return n||(i=i||[],i=[t,i.slice?i.slice():i],s.push(i),e||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},Tt.extend({Deferred:function(t){var e=[["notify","progress",Tt.Callbacks("memory"),Tt.Callbacks("memory"),2],["resolve","done",Tt.Callbacks("once memory"),Tt.Callbacks("once memory"),0,"resolved"],["reject","fail",Tt.Callbacks("once memory"),Tt.Callbacks("once memory"),1,"rejected"]],r="pending",n={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return n.then(null,t)},pipe:function(){var t=arguments;return Tt.Deferred(function(i){Tt.each(e,function(e,r){var n=wt(t[r[4]])&&t[r[4]];o[r[1]](function(){var t=n&&n.apply(this,arguments);t&&wt(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[r[0]+"With"](this,n?[t]:arguments)})}),t=null}).promise()},then:function(t,r,n){function o(t,e,r,n){return function(){var a=this,c=arguments,l=function(){var i,l;if(t>=s){if((i=r.apply(a,c))===e.promise())throw new TypeError("Thenable self-resolution");l=i&&("object"==typeof i||"function"==typeof i)&&i.then,wt(l)?n?l.call(i,o(s,e,d,n),o(s,e,p,n)):(s++,l.call(i,o(s,e,d,n),o(s,e,p,n),o(s,e,d,e.notifyWith))):(r!==d&&(a=void 0,c=[i]),(n||e.resolveWith)(a,c))}},u=n?l:function(){try{l()}catch(i){Tt.Deferred.exceptionHook&&Tt.Deferred.exceptionHook(i,u.stackTrace),s>t+1||(r!==p&&(a=void 0,c=[i]),e.rejectWith(a,c))}};t?u():(Tt.Deferred.getStackHook&&(u.stackTrace=Tt.Deferred.getStackHook()),i.setTimeout(u))}}var s=0;return Tt.Deferred(function(i){e[0][3].add(o(0,i,wt(n)?n:d,i.notifyWith)),e[1][3].add(o(0,i,wt(t)?t:d)),e[2][3].add(o(0,i,wt(r)?r:p))}).promise()},promise:function(t){return null!=t?Tt.extend(t,n):n}},o={};return Tt.each(e,function(t,i){var s=i[2],a=i[5];n[i[1]]=s.add,a&&s.add(function(){r=a},e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(i[3].fire),o[i[0]]=function(){return o[i[0]+"With"](this===o?void 0:this,arguments),this},o[i[0]+"With"]=s.fireWith}),n.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,i=e,r=Array(i),n=ft.call(arguments),o=Tt.Deferred(),s=function(t){return function(i){r[t]=this,n[t]=arguments.length>1?ft.call(arguments):i,--e||o.resolveWith(r,n)}};if(1>=e&&(g(t,o.done(s(i)).resolve,o.reject,!e),"pending"===o.state()||wt(n[i]&&n[i].then)))return o.then();for(;i--;)g(n[i],s(i),o.reject);return o.promise()}});var Bt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Tt.Deferred.exceptionHook=function(t,e){i.console&&i.console.warn&&t&&Bt.test(t.name)&&i.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},Tt.readyException=function(t){i.setTimeout(function(){throw t})};var Ft=Tt.Deferred();Tt.fn.ready=function(t){return Ft.then(t).catch(function(t){Tt.readyException(t)}),this},Tt.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--Tt.readyWait:Tt.isReady)||(Tt.isReady=!0,!0!==t&&--Tt.readyWait>0||Ft.resolveWith(ut,[Tt]))}}),Tt.ready.then=Ft.then,"complete"===ut.readyState||"loading"!==ut.readyState&&!ut.documentElement.doScroll?i.setTimeout(Tt.ready):(ut.addEventListener("DOMContentLoaded",v),i.addEventListener("load",v));var Nt=function(t,e,i,r,n,o,s){var c=0,l=t.length,u=null==i;if("object"===a(i)){n=!0;for(c in i)Nt(t,e,c,i[c],!0,o,s)}else if(void 0!==r&&(n=!0,wt(r)||(s=!0),u&&(s?(e.call(t,r),e=null):(u=e,e=function(t,e,i){return u.call(Tt(t),i)})),e))for(;l>c;c++)e(t[c],i,s?r:r.call(t[c],c,e(t[c],i)));return n?t:u?e.call(t):l?e(t[0],i):o},Xt=/^-ms-/,zt=/-([a-z])/g,Gt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};b.uid=1,b.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Gt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var r,n=this.cache(t);if("string"==typeof e)n[m(e)]=i;else for(r in e)n[m(r)]=e[r];return n},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][m(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,r=t[this.expando];if(void 0!==r){if(void 0!==e){Array.isArray(e)?e=e.map(m):(e=m(e),e=e in r?[e]:e.match(Rt)||[]),i=e.length;for(;i--;)delete r[e[i]]}(void 0===e||Tt.isEmptyObject(r))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!Tt.isEmptyObject(e)}};var Wt=new b,Yt=new b,Ht=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,qt=/[A-Z]/g;Tt.extend({hasData:function(t){return Yt.hasData(t)||Wt.hasData(t)},data:function(t,e,i){return Yt.access(t,e,i)},removeData:function(t,e){Yt.remove(t,e)},_data:function(t,e,i){return Wt.access(t,e,i)},_removeData:function(t,e){Wt.remove(t,e)}}),Tt.fn.extend({data:function(t,e){var i,r,n,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(n=Yt.get(o),1===o.nodeType&&!Wt.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(r=s[i].name,0===r.indexOf("data-")&&(r=m(r.slice(5)),x(o,r,n[r])));Wt.set(o,"hasDataAttrs",!0)}return n}return"object"==typeof t?this.each(function(){Yt.set(this,t)}):Nt(this,function(e){var i;if(o&&void 0===e){if(void 0!==(i=Yt.get(o,t)))return i;if(void 0!==(i=x(o,t)))return i}else this.each(function(){Yt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Yt.remove(this,t)})}}),Tt.extend({queue:function(t,e,i){var r;if(t)return e=(e||"fx")+"queue",r=Wt.get(t,e),i&&(!r||Array.isArray(i)?r=Wt.access(t,e,Tt.makeArray(i)):r.push(i)),r||[]},dequeue:function(t,e){e=e||"fx";var i=Tt.queue(t,e),r=i.length,n=i.shift(),o=Tt._queueHooks(t,e),s=function(){Tt.dequeue(t,e)};"inprogress"===n&&(n=i.shift(),r--),n&&("fx"===e&&i.unshift("inprogress"),delete o.stop,n.call(t,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Wt.get(t,i)||Wt.access(t,i,{empty:Tt.Callbacks("once memory").add(function(){Wt.remove(t,[e+"queue",i])})})}}),Tt.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),i>arguments.length?Tt.queue(this[0],t):void 0===e?this:this.each(function(){var i=Tt.queue(this,t,e);Tt._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&Tt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){Tt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,r=1,n=Tt.Deferred(),o=this,s=this.length,a=function(){--r||n.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(i=Wt.get(o[s],t+"queueHooks"))&&i.empty&&(r++,i.empty.add(a));return a(),n.promise(e)}});var Ut=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Vt=RegExp("^(?:([+-])=|)("+Ut+")([a-z%]*)$","i"),$t=["Top","Right","Bottom","Left"],Jt=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&Tt.contains(t.ownerDocument,t)&&"none"===Tt.css(t,"display")},Zt=function(t,e,i,r){var n,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];n=i.apply(t,r||[]);for(o in e)t.style[o]=s[o];return n},Kt={};Tt.fn.extend({show:function(){return O(this,!0)},hide:function(){return O(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Jt(this)?Tt(this).show():Tt(this).hide()})}});var Qt=/^(?:checkbox|radio)$/i,te=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ee=/^$|^module$|\/(?:java|ecma)script/i,ie={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ie.optgroup=ie.option,ie.tbody=ie.tfoot=ie.colgroup=ie.caption=ie.thead,ie.th=ie.td;var re=/<|&#?\w+;/;!function(){var t=ut.createDocumentFragment(),e=t.appendChild(ut.createElement("div")),i=ut.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),xt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",xt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var ne=ut.documentElement,oe=/^key/,se=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ae=/^([^.]*)(?:\.(.+)|)/;Tt.event={global:{},add:function(t,e,i,r,n){var o,s,a,c,l,u,h,f,d,p,g,v=Wt.get(t);if(v)for(i.handler&&(o=i,i=o.handler,n=o.selector),n&&Tt.find.matchesSelector(ne,n),i.guid||(i.guid=Tt.guid++),(c=v.events)||(c=v.events={}),(s=v.handle)||(s=v.handle=function(e){return void 0!==Tt&&Tt.event.triggered!==e.type?Tt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(Rt)||[""],l=e.length;l--;)a=ae.exec(e[l])||[],d=g=a[1],p=(a[2]||"").split(".").sort(),d&&(h=Tt.event.special[d]||{},d=(n?h.delegateType:h.bindType)||d,h=Tt.event.special[d]||{},u=Tt.extend({type:d,origType:g,data:r,handler:i,guid:i.guid,selector:n,needsContext:n&&Tt.expr.match.needsContext.test(n),namespace:p.join(".")},o),(f=c[d])||(f=c[d]=[],f.delegateCount=0,h.setup&&!1!==h.setup.call(t,r,p,s)||t.addEventListener&&t.addEventListener(d,s)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),n?f.splice(f.delegateCount++,0,u):f.push(u),Tt.event.global[d]=!0)},remove:function(t,e,i,r,n){var o,s,a,c,l,u,h,f,d,p,g,v=Wt.hasData(t)&&Wt.get(t);if(v&&(c=v.events)){for(e=(e||"").match(Rt)||[""],l=e.length;l--;)if(a=ae.exec(e[l])||[],d=g=a[1],p=(a[2]||"").split(".").sort(),d){for(h=Tt.event.special[d]||{},d=(r?h.delegateType:h.bindType)||d,f=c[d]||[],a=a[2]&&RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;o--;)u=f[o],!n&&g!==u.origType||i&&i.guid!==u.guid||a&&!a.test(u.namespace)||r&&r!==u.selector&&("**"!==r||!u.selector)||(f.splice(o,1),u.selector&&f.delegateCount--,h.remove&&h.remove.call(t,u));s&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,p,v.handle)||Tt.removeEvent(t,d,v.handle),delete c[d])}else for(d in c)Tt.event.remove(t,d+e[l],i,r,!0);Tt.isEmptyObject(c)&&Wt.remove(t,"handle events")}},dispatch:function(t){var e,i,r,n,o,s,a=Tt.event.fix(t),c=Array(arguments.length),l=(Wt.get(this,"events")||{})[a.type]||[],u=Tt.event.special[a.type]||{};for(c[0]=a,e=1;arguments.length>e;e++)c[e]=arguments[e];if(a.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,a)){for(s=Tt.event.handlers.call(this,a,l),e=0;(n=s[e++])&&!a.isPropagationStopped();)for(a.currentTarget=n.elem,i=0;(o=n.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(o.namespace)||(a.handleObj=o,a.data=o.data,void 0!==(r=((Tt.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,c))&&!1===(a.result=r)&&(a.preventDefault(),a.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,a),a.result}},handlers:function(t,e){var i,r,n,o,s,a=[],c=e.delegateCount,l=t.target;if(c&&l.nodeType&&("click"!==t.type||1>t.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],s={},i=0;c>i;i++)r=e[i],n=r.selector+" ",void 0===s[n]&&(s[n]=r.needsContext?Tt(n,this).index(l)>-1:Tt.find(n,this,null,[l]).length),s[n]&&o.push(r);o.length&&a.push({elem:l,handlers:o})}return l=this,e.length>c&&a.push({elem:l,handlers:e.slice(c)}),a},addProp:function(t,e){Object.defineProperty(Tt.Event.prototype,t,{enumerable:!0,configurable:!0,get:wt(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[Tt.expando]?t:new Tt.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==P()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===P()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&l(this,"input"))return this.click(),!1},_default:function(t){return l(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},Tt.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},Tt.Event=function(t,e){if(!(this instanceof Tt.Event))return new Tt.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?k:A,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&Tt.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[Tt.expando]=!0},Tt.Event.prototype={constructor:Tt.Event,isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=k,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=k,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=k,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},Tt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&oe.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&se.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},Tt.event.addProp),Tt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){Tt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,r=this,n=t.relatedTarget,o=t.handleObj;return n&&(n===r||Tt.contains(r,n))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),Tt.fn.extend({on:function(t,e,i,r){return E(this,t,e,i,r)},one:function(t,e,i,r){return E(this,t,e,i,r,1)},off:function(t,e,i){var r,n;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,Tt(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(n in t)this.off(n,e,t[n]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=A),this.each(function(){Tt.event.remove(this,t,i,e)})}});var ce=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,le=/<script|<style|<link/i,ue=/checked\s*(?:[^=]|=\s*.checked.)/i,he=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;Tt.extend({htmlPrefilter:function(t){return t.replace(ce,"<$1></$2>")},clone:function(t,e,i){var r,n,o,s,a=t.cloneNode(!0),c=Tt.contains(t.ownerDocument,t);if(!(xt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Tt.isXMLDoc(t)))for(s=T(a),o=T(t),r=0,n=o.length;n>r;r++)R(o[r],s[r]);if(e)if(i)for(o=o||T(t),s=s||T(a),r=0,n=o.length;n>r;r++)I(o[r],s[r]);else I(t,a);return s=T(a,"script"),s.length>0&&S(s,!c&&T(t,"script")),a},cleanData:function(t){for(var e,i,r,n=Tt.event.special,o=0;void 0!==(i=t[o]);o++)if(Gt(i)){if(e=i[Wt.expando]){if(e.events)for(r in e.events)n[r]?Tt.event.remove(i,r):Tt.removeEvent(i,r,e.handle);i[Wt.expando]=void 0}i[Yt.expando]&&(i[Yt.expando]=void 0)}}}),Tt.fn.extend({detach:function(t){return F(this,t,!0)},remove:function(t){return F(this,t)},text:function(t){return Nt(this,function(t){return void 0===t?Tt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return B(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){L(this,t).appendChild(t)}})},prepend:function(){return B(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=L(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return B(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return B(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Tt.cleanData(T(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return Tt.clone(this,t,e)})},html:function(t){return Nt(this,function(t){var e=this[0]||{},i=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!le.test(t)&&!ie[(te.exec(t)||["",""])[1].toLowerCase()]){t=Tt.htmlPrefilter(t);try{for(;r>i;i++)e=this[i]||{},1===e.nodeType&&(Tt.cleanData(T(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return B(this,arguments,function(e){var i=this.parentNode;0>Tt.inArray(this,t)&&(Tt.cleanData(T(this)),i&&i.replaceChild(e,this))},t)}}),Tt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){Tt.fn[t]=function(t){for(var i,r=[],n=Tt(t),o=n.length-1,s=0;o>=s;s++)i=s===o?this:this.clone(!0),Tt(n[s])[e](i),pt.apply(r,i.get());return this.pushStack(r)}});var fe=RegExp("^("+Ut+")(?!px)[a-z%]+$","i"),de=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=i),e.getComputedStyle(t)},pe=RegExp($t.join("|"),"i");!function(){function t(){if(l){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ne.appendChild(c).appendChild(l);var t=i.getComputedStyle(l);r="1%"!==t.top,a=12===e(t.marginLeft),l.style.right="60%",s=36===e(t.right),n=36===e(t.width),l.style.position="absolute",o=36===l.offsetWidth||"absolute",ne.removeChild(c),l=null}}function e(t){return Math.round(parseFloat(t))}var r,n,o,s,a,c=ut.createElement("div"),l=ut.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",xt.clearCloneStyle="content-box"===l.style.backgroundClip,Tt.extend(xt,{boxSizingReliable:function(){return t(),n},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),a},scrollboxSize:function(){return t(),o}}))}();var ge=/^(none|table(?!-c[ea]).+)/,ve=/^--/,ye={position:"absolute",visibility:"hidden",display:"block"},me={letterSpacing:"0",fontWeight:"400"},be=["Webkit","Moz","ms"],_e=ut.createElement("div").style;Tt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=N(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var n,o,s,a=m(e),c=ve.test(e),l=t.style;if(c||(e=G(a)),s=Tt.cssHooks[e]||Tt.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(n=s.get(t,!1,r))?n:l[e];o=typeof i,"string"===o&&(n=Vt.exec(i))&&n[1]&&(i=w(t,e,n),o="number"),null!=i&&i===i&&("number"===o&&(i+=n&&n[3]||(Tt.cssNumber[a]?"":"px")),xt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,r))||(c?l.setProperty(e,i):l[e]=i))}},css:function(t,e,i,r){var n,o,s,a=m(e);return ve.test(e)||(e=G(a)),s=Tt.cssHooks[e]||Tt.cssHooks[a],s&&"get"in s&&(n=s.get(t,!0,i)),void 0===n&&(n=N(t,e,r)),"normal"===n&&e in me&&(n=me[e]),""===i||i?(o=parseFloat(n),!0===i||isFinite(o)?o||0:n):n}}),Tt.each(["height","width"],function(t,e){Tt.cssHooks[e]={get:function(t,i,r){if(i)return!ge.test(Tt.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?H(t,e,r):Zt(t,ye,function(){return H(t,e,r)})},set:function(t,i,r){var n,o=de(t),s="border-box"===Tt.css(t,"boxSizing",!1,o),a=r&&Y(t,e,r,s,o);return s&&xt.scrollboxSize()===o.position&&(a-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-Y(t,e,"border",!1,o)-.5)),a&&(n=Vt.exec(i))&&"px"!==(n[3]||"px")&&(t.style[e]=i,i=Tt.css(t,e)),W(t,i,a)}}}),Tt.cssHooks.marginLeft=X(xt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(N(t,"marginLeft"))||t.getBoundingClientRect().left-Zt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),Tt.each({margin:"",padding:"",border:"Width"},function(t,e){Tt.cssHooks[t+e]={expand:function(i){for(var r=0,n={},o="string"==typeof i?i.split(" "):[i];4>r;r++)n[t+$t[r]+e]=o[r]||o[r-2]||o[0];return n}},"margin"!==t&&(Tt.cssHooks[t+e].set=W)}),Tt.fn.extend({css:function(t,e){return Nt(this,function(t,e,i){var r,n,o={},s=0;if(Array.isArray(e)){for(r=de(t),n=e.length;n>s;s++)o[e[s]]=Tt.css(t,e[s],!1,r);return o}return void 0!==i?Tt.style(t,e,i):Tt.css(t,e)},t,e,arguments.length>1)}}),Tt.Tween=q,q.prototype={constructor:q,init:function(t,e,i,r,n,o){this.elem=t,this.prop=i,this.easing=n||Tt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(Tt.cssNumber[i]?"":"px")},cur:function(){var t=q.propHooks[this.prop];return t&&t.get?t.get(this):q.propHooks._default.get(this)},run:function(t){var e,i=q.propHooks[this.prop];return this.pos=e=this.options.duration?Tt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):q.propHooks._default.set(this),this}},q.prototype.init.prototype=q.prototype,q.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=Tt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){Tt.fx.step[t.prop]?Tt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[Tt.cssProps[t.prop]]&&!Tt.cssHooks[t.prop]?t.elem[t.prop]=t.now:Tt.style(t.elem,t.prop,t.now+t.unit)}}},q.propHooks.scrollTop=q.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Tt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},Tt.fx=q.prototype.init,Tt.fx.step={};var xe,we,Ce=/^(?:toggle|show|hide)$/,Oe=/queueHooks$/;Tt.Animation=Tt.extend(Q,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return w(i.elem,t,Vt.exec(e),i),i}]},tweener:function(t,e){wt(t)?(e=t,t=["*"]):t=t.match(Rt);for(var i,r=0,n=t.length;n>r;r++)i=t[r],Q.tweeners[i]=Q.tweeners[i]||[],Q.tweeners[i].unshift(e)},prefilters:[Z],prefilter:function(t,e){e?Q.prefilters.unshift(t):Q.prefilters.push(t)}}),Tt.speed=function(t,e,i){var r=t&&"object"==typeof t?Tt.extend({},t):{complete:i||!i&&e||wt(t)&&t,duration:t,easing:i&&e||e&&!wt(e)&&e};return Tt.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration=r.duration in Tt.fx.speeds?Tt.fx.speeds[r.duration]:Tt.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){wt(r.old)&&r.old.call(this),r.queue&&Tt.dequeue(this,r.queue)},r},Tt.fn.extend({fadeTo:function(t,e,i,r){return this.filter(Jt).css("opacity",0).show().end().animate({opacity:e},t,i,r)},animate:function(t,e,i,r){var n=Tt.isEmptyObject(t),o=Tt.speed(e,i,r),s=function(){var e=Q(this,Tt.extend({},t),o);(n||Wt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,n||!1===o.queue?this.each(s):this.queue(o.queue,s)},stop:function(t,e,i){var r=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,n=null!=t&&t+"queueHooks",o=Tt.timers,s=Wt.get(this);if(n)s[n]&&s[n].stop&&r(s[n]);else for(n in s)s[n]&&s[n].stop&&Oe.test(n)&&r(s[n]);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(o[n].anim.stop(i),e=!1,o.splice(n,1));!e&&i||Tt.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=Wt.get(this),r=i[t+"queue"],n=i[t+"queueHooks"],o=Tt.timers,s=r?r.length:0;for(i.finish=!0,Tt.queue(this,t,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;s>e;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete i.finish})}}),Tt.each(["toggle","show","hide"],function(t,e){var i=Tt.fn[e];Tt.fn[e]=function(t,r,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate($(e,!0),t,r,n)}}),Tt.each({slideDown:$("show"),slideUp:$("hide"),slideToggle:$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){Tt.fn[t]=function(t,i,r){return this.animate(e,t,i,r)}}),Tt.timers=[],Tt.fx.tick=function(){var t,e=0,i=Tt.timers;for(xe=Date.now();i.length>e;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||Tt.fx.stop(),xe=void 0},Tt.fx.timer=function(t){Tt.timers.push(t),Tt.fx.start()},Tt.fx.interval=13,Tt.fx.start=function(){we||(we=!0,U())},Tt.fx.stop=function(){we=null},Tt.fx.speeds={slow:600,fast:200,_default:400},Tt.fn.delay=function(t,e){return t=Tt.fx?Tt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,r){var n=i.setTimeout(e,t);r.stop=function(){i.clearTimeout(n)}})},function(){var t=ut.createElement("input"),e=ut.createElement("select"),i=e.appendChild(ut.createElement("option"));t.type="checkbox",xt.checkOn=""!==t.value,xt.optSelected=i.selected,t=ut.createElement("input"),t.value="t",t.type="radio",xt.radioValue="t"===t.value}();var Te,Se=Tt.expr.attrHandle;Tt.fn.extend({attr:function(t,e){return Nt(this,Tt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){Tt.removeAttr(this,t)})}}),Tt.extend({attr:function(t,e,i){var r,n,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?Tt.prop(t,e,i):(1===o&&Tt.isXMLDoc(t)||(n=Tt.attrHooks[e.toLowerCase()]||(Tt.expr.match.bool.test(e)?Te:void 0)),void 0!==i?null===i?void Tt.removeAttr(t,e):n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=Tt.find.attr(t,e),null==r?void 0:r))},attrHooks:{type:{set:function(t,e){if(!xt.radioValue&&"radio"===e&&l(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,r=0,n=e&&e.match(Rt);if(n&&1===t.nodeType)for(;i=n[r++];)t.removeAttribute(i)}}),Te={set:function(t,e,i){return!1===e?Tt.removeAttr(t,i):t.setAttribute(i,i),i}},Tt.each(Tt.expr.match.bool.source.match(/\w+/g),function(t,e){var i=Se[e]||Tt.find.attr;Se[e]=function(t,e,r){var n,o,s=e.toLowerCase();return r||(o=Se[s],Se[s]=n,n=null!=i(t,e,r)?s:null,Se[s]=o),n}});var je=/^(?:input|select|textarea|button)$/i,ke=/^(?:a|area)$/i;Tt.fn.extend({prop:function(t,e){return Nt(this,Tt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[Tt.propFix[t]||t]})}}),Tt.extend({prop:function(t,e,i){var r,n,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&Tt.isXMLDoc(t)||(e=Tt.propFix[e]||e,n=Tt.propHooks[e]),void 0!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:t[e]=i:n&&"get"in n&&null!==(r=n.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=Tt.find.attr(t,"tabindex");return e?parseInt(e,10):je.test(t.nodeName)||ke.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),xt.optSelected||(Tt.propHooks.selected={get:function(t){return null},set:function(t){}}),Tt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Tt.propFix[this.toLowerCase()]=this}),Tt.fn.extend({addClass:function(t){var e,i,r,n,o,s,a,c=0;if(wt(t))return this.each(function(e){Tt(this).addClass(t.call(this,e,et(this)))});if(e=it(t),e.length)for(;i=this[c++];)if(n=et(i),r=1===i.nodeType&&" "+tt(n)+" "){for(s=0;o=e[s++];)0>r.indexOf(" "+o+" ")&&(r+=o+" ");a=tt(r),n!==a&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,r,n,o,s,a,c=0;if(wt(t))return this.each(function(e){Tt(this).removeClass(t.call(this,e,et(this)))});if(!arguments.length)return this.attr("class","");if(e=it(t),e.length)for(;i=this[c++];)if(n=et(i),r=1===i.nodeType&&" "+tt(n)+" "){for(s=0;o=e[s++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");a=tt(r),n!==a&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t,r="string"===i||Array.isArray(t);return"boolean"==typeof e&&r?e?this.addClass(t):this.removeClass(t):this.each(wt(t)?function(i){Tt(this).toggleClass(t.call(this,i,et(this),e),e)}:function(){var e,n,o,s;if(r)for(n=0,o=Tt(this),s=it(t);e=s[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==i||(e=et(this),e&&Wt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Wt.get(this,"__className__")||""))})},hasClass:function(t){var e,i,r=0;for(e=" "+t+" ";i=this[r++];)if(1===i.nodeType&&(" "+tt(et(i))+" ").indexOf(e)>-1)return!0;return!1}});var Ae=/\r/g;Tt.fn.extend({val:function(t){var e,i,r,n=this[0];{if(arguments.length)return r=wt(t),this.each(function(i){var n;1===this.nodeType&&(n=r?t.call(this,i,Tt(this).val()):t,null==n?n="":"number"==typeof n?n+="":Array.isArray(n)&&(n=Tt.map(n,function(t){return null==t?"":t+""})),(e=Tt.valHooks[this.type]||Tt.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,n,"value")||(this.value=n))});if(n)return(e=Tt.valHooks[n.type]||Tt.valHooks[n.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(n,"value"))?i:(i=n.value,"string"==typeof i?i.replace(Ae,""):null==i?"":i)}}}),Tt.extend({valHooks:{option:{get:function(t){var e=Tt.find.attr(t,"value");return null!=e?e:tt(Tt.text(t))}},select:{get:function(t){var e,i,r,n=t.options,o=t.selectedIndex,s="select-one"===t.type,a=s?null:[],c=s?o+1:n.length;for(r=0>o?c:s?o:0;c>r;r++)if(i=n[r],(i.selected||r===o)&&!i.disabled&&(!i.parentNode.disabled||!l(i.parentNode,"optgroup"))){if(e=Tt(i).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var i,r,n=t.options,o=Tt.makeArray(e),s=n.length;s--;)r=n[s],(r.selected=Tt.inArray(Tt.valHooks.option.get(r),o)>-1)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),Tt.each(["radio","checkbox"],function(){Tt.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=Tt.inArray(Tt(t).val(),e)>-1}},xt.checkOn||(Tt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),xt.focusin="onfocusin"in i;var Pe=/^(?:focusinfocus|focusoutblur)$/,Ee=function(t){t.stopPropagation()};Tt.extend(Tt.event,{trigger:function(t,e,r,n){var o,s,a,c,l,u,h,f,d=[r||ut],p=mt.call(t,"type")?t.type:t,g=mt.call(t,"namespace")?t.namespace.split("."):[];if(s=f=a=r=r||ut,3!==r.nodeType&&8!==r.nodeType&&!Pe.test(p+Tt.event.triggered)&&(p.indexOf(".")>-1&&(g=p.split("."),p=g.shift(),g.sort()),l=0>p.indexOf(":")&&"on"+p,t=t[Tt.expando]?t:new Tt.Event(p,"object"==typeof t&&t),t.isTrigger=n?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),e=null==e?[t]:Tt.makeArray(e,[t]),h=Tt.event.special[p]||{},n||!h.trigger||!1!==h.trigger.apply(r,e))){if(!n&&!h.noBubble&&!Ct(r)){for(c=h.delegateType||p,Pe.test(c+p)||(s=s.parentNode);s;s=s.parentNode)d.push(s),a=s;a===(r.ownerDocument||ut)&&d.push(a.defaultView||a.parentWindow||i)}for(o=0;(s=d[o++])&&!t.isPropagationStopped();)f=s,t.type=o>1?c:h.bindType||p,u=(Wt.get(s,"events")||{})[t.type]&&Wt.get(s,"handle"),u&&u.apply(s,e),(u=l&&s[l])&&u.apply&&Gt(s)&&!1===(t.result=u.apply(s,e))&&t.preventDefault();return t.type=p,n||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(d.pop(),e)||!Gt(r)||l&&wt(r[p])&&!Ct(r)&&(a=r[l],a&&(r[l]=null),Tt.event.triggered=p,t.isPropagationStopped()&&f.addEventListener(p,Ee),r[p](),t.isPropagationStopped()&&f.removeEventListener(p,Ee),Tt.event.triggered=void 0,a&&(r[l]=a)),t.result}},simulate:function(t,e,i){var r=Tt.extend(new Tt.Event,i,{type:t,isSimulated:!0});Tt.event.trigger(r,null,e)}}),Tt.fn.extend({trigger:function(t,e){return this.each(function(){Tt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return Tt.event.trigger(t,e,i,!0)}}),xt.focusin||Tt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){Tt.event.simulate(e,t.target,Tt.event.fix(t))};Tt.event.special[e]={setup:function(){var r=this.ownerDocument||this,n=Wt.access(r,e);n||r.addEventListener(t,i,!0),Wt.access(r,e,(n||0)+1)},teardown:function(){var r=this.ownerDocument||this,n=Wt.access(r,e)-1;n?Wt.access(r,e,n):(r.removeEventListener(t,i,!0),Wt.remove(r,e))}}});var Le=i.location,Me=Date.now(),De=/\?/;Tt.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new i.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||Tt.error("Invalid XML: "+t),e};var Ie=/\[\]$/,Re=/\r?\n/g,Be=/^(?:submit|button|image|reset|file)$/i,Fe=/^(?:input|select|textarea|keygen)/i;Tt.param=function(t,e){var i,r=[],n=function(t,e){var i=wt(e)?e():e;r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(t)||t.jquery&&!Tt.isPlainObject(t))Tt.each(t,function(){n(this.name,this.value)});else for(i in t)rt(i,t[i],e,n);return r.join("&")},Tt.fn.extend({serialize:function(){return Tt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=Tt.prop(this,"elements");return t?Tt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!Tt(this).is(":disabled")&&Fe.test(this.nodeName)&&!Be.test(t)&&(this.checked||!Qt.test(t))}).map(function(t,e){var i=Tt(this).val();return null==i?null:Array.isArray(i)?Tt.map(i,function(t){return{name:e.name,value:t.replace(Re,"\r\n")}}):{name:e.name,value:i.replace(Re,"\r\n")}}).get()}});var Ne=/%20/g,Xe=/#.*$/,ze=/([?&])_=[^&]*/,Ge=/^(.*?):[ \t]*([^\r\n]*)$/gm,We=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ye=/^(?:GET|HEAD)$/,He=/^\/\//,qe={},Ue={},Ve="*/".concat("*"),$e=ut.createElement("a");$e.href=Le.href,Tt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Le.href,type:"GET",isLocal:We.test(Le.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ve,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":Tt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?st(st(t,Tt.ajaxSettings),e):st(Tt.ajaxSettings,t)},ajaxPrefilter:nt(qe),ajaxTransport:nt(Ue),ajax:function(t,e){function r(t,e,r,a){var l,f,d,_,x,w=e;u||(u=!0,c&&i.clearTimeout(c),n=void 0,s=a||"",C.readyState=t>0?4:0,l=t>=200&&300>t||304===t,r&&(_=at(p,C,r)),_=ct(p,_,C,l),l?(p.ifModified&&(x=C.getResponseHeader("Last-Modified"),x&&(Tt.lastModified[o]=x),(x=C.getResponseHeader("etag"))&&(Tt.etag[o]=x)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=_.state,f=_.data,d=_.error,l=!d)):(d=w,!t&&w||(w="error",0>t&&(t=0))),C.status=t,C.statusText=(e||w)+"",l?y.resolveWith(g,[f,w,C]):y.rejectWith(g,[C,w,d]),C.statusCode(b),b=void 0,h&&v.trigger(l?"ajaxSuccess":"ajaxError",[C,p,l?f:d]),m.fireWith(g,[C,w]),h&&(v.trigger("ajaxComplete",[C,p]),--Tt.active||Tt.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,o,s,a,c,l,u,h,f,d,p=Tt.ajaxSetup({},e),g=p.context||p,v=p.context&&(g.nodeType||g.jquery)?Tt(g):Tt.event,y=Tt.Deferred(),m=Tt.Callbacks("once memory"),b=p.statusCode||{},_={},x={},w="canceled",C={readyState:0,getResponseHeader:function(t){var e;if(u){if(!a)for(a={};e=Ge.exec(s);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return u?s:null},setRequestHeader:function(t,e){return null==u&&(t=x[t.toLowerCase()]=x[t.toLowerCase()]||t,_[t]=e),this},overrideMimeType:function(t){return null==u&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(u)C.always(t[C.status]);else for(e in t)b[e]=[b[e],t[e]];return this},abort:function(t){var e=t||w;return n&&n.abort(e),r(0,e),this}};if(y.promise(C),p.url=((t||p.url||Le.href)+"").replace(He,Le.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(Rt)||[""],null==p.crossDomain){l=ut.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=$e.protocol+"//"+$e.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=Tt.param(p.data,p.traditional)),ot(qe,p,e,C),u)return C;h=Tt.event&&p.global,h&&0==Tt.active++&&Tt.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ye.test(p.type),o=p.url.replace(Xe,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Ne,"+")):(d=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(De.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(ze,"$1"),d=(De.test(o)?"&":"?")+"_="+Me+++d),p.url=o+d),p.ifModified&&(Tt.lastModified[o]&&C.setRequestHeader("If-Modified-Since",Tt.lastModified[o]),Tt.etag[o]&&C.setRequestHeader("If-None-Match",Tt.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ve+"; q=0.01":""):p.accepts["*"]);for(f in p.headers)C.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(!1===p.beforeSend.call(g,C,p)||u))return C.abort();if(w="abort",m.add(p.complete),C.done(p.success),C.fail(p.error),n=ot(Ue,p,e,C)){if(C.readyState=1,h&&v.trigger("ajaxSend",[C,p]),u)return C;p.async&&p.timeout>0&&(c=i.setTimeout(function(){C.abort("timeout")},p.timeout));try{u=!1,n.send(_,r)}catch(t){if(u)throw t;r(-1,t)}}else r(-1,"No Transport");return C},getJSON:function(t,e,i){return Tt.get(t,e,i,"json")},getScript:function(t,e){return Tt.get(t,void 0,e,"script")}}),Tt.each(["get","post"],function(t,e){Tt[e]=function(t,i,r,n){return wt(i)&&(n=n||r,r=i,i=void 0),Tt.ajax(Tt.extend({url:t,type:e,dataType:n,data:i,success:r},Tt.isPlainObject(t)&&t))}}),Tt._evalUrl=function(t){return Tt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},Tt.fn.extend({wrapAll:function(t){var e;return this[0]&&(wt(t)&&(t=t.call(this[0])),e=Tt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return this.each(wt(t)?function(e){Tt(this).wrapInner(t.call(this,e))}:function(){var e=Tt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=wt(t);return this.each(function(i){Tt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){Tt(this).replaceWith(this.childNodes)}),this}}),Tt.expr.pseudos.hidden=function(t){return!Tt.expr.pseudos.visible(t)},Tt.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},Tt.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(t){}};var Je={0:200,1223:204},Ze=Tt.ajaxSettings.xhr();xt.cors=!!Ze&&"withCredentials"in Ze,xt.ajax=Ze=!!Ze,Tt.ajaxTransport(function(t){var e,r;if(xt.cors||Ze&&!t.crossDomain)return{send:function(n,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(s in n)a.setRequestHeader(s,n[s]);e=function(t){return function(){e&&(e=r=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Je[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=e(),r=a.onerror=a.ontimeout=e("error"),void 0!==a.onabort?a.onabort=r:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout(function(){e&&r()})},e=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),Tt.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),Tt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return Tt.globalEval(t),t}}}),Tt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),Tt.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(r,n){e=Tt("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&n("error"===t.type?404:200,t.type)}),ut.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Ke=[],Qe=/(=)\?(?=&|$)|\?\?/;Tt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ke.pop()||Tt.expando+"_"+Me++;return this[t]=!0,t}}),Tt.ajaxPrefilter("json jsonp",function(t,e,r){var n,o,s,a=!1!==t.jsonp&&(Qe.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qe.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return n=t.jsonpCallback=wt(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Qe,"$1"+n):!1!==t.jsonp&&(t.url+=(De.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return s||Tt.error(n+" was not called"),s[0]},t.dataTypes[0]="json",o=i[n],i[n]=function(){s=arguments},r.always(function(){void 0===o?Tt(i).removeProp(n):i[n]=o,t[n]&&(t.jsonpCallback=e.jsonpCallback,Ke.push(n)),s&&wt(o)&&o(s[0]),s=o=void 0}),"script"}),xt.createHTMLDocument=function(){var t=ut.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),Tt.parseHTML=function(t,e,i){if("string"!=typeof t)return[];"boolean"==typeof e&&(i=e,e=!1);var r,n,o;return e||(xt.createHTMLDocument?(e=ut.implementation.createHTMLDocument(""),r=e.createElement("base"),r.href=ut.location.href,e.head.appendChild(r)):e=ut),n=Et.exec(t),o=!i&&[],n?[e.createElement(n[1])]:(n=j([t],e,o),o&&o.length&&Tt(o).remove(),Tt.merge([],n.childNodes))},Tt.fn.load=function(t,e,i){var r,n,o,s=this,a=t.indexOf(" ");return a>-1&&(r=tt(t.slice(a)),t=t.slice(0,a)),wt(e)?(i=e,e=void 0):e&&"object"==typeof e&&(n="POST"),s.length>0&&Tt.ajax({url:t,type:n||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(r?Tt("<div>").append(Tt.parseHTML(t)).find(r):t)}).always(i&&function(t,e){s.each(function(){i.apply(this,o||[t.responseText,e,t])})}),this},Tt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){Tt.fn[e]=function(t){return this.on(e,t)}}),Tt.expr.pseudos.animated=function(t){return Tt.grep(Tt.timers,function(e){return t===e.elem}).length},Tt.offset={setOffset:function(t,e,i){var r,n,o,s,a,c,l,u=Tt.css(t,"position"),h=Tt(t),f={};"static"===u&&(t.style.position="relative"),a=h.offset(),o=Tt.css(t,"top"),c=Tt.css(t,"left"),l=("absolute"===u||"fixed"===u)&&(o+c).indexOf("auto")>-1,l?(r=h.position(),s=r.top,n=r.left):(s=parseFloat(o)||0,n=parseFloat(c)||0),wt(e)&&(e=e.call(t,i,Tt.extend({},a))),null!=e.top&&(f.top=e.top-a.top+s),null!=e.left&&(f.left=e.left-a.left+n),"using"in e?e.using.call(t,f):h.css(f)}},Tt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){Tt.offset.setOffset(this,t,e)});var e,i,r=this[0];if(r)return r.getClientRects().length?(e=r.getBoundingClientRect(),i=r.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var t,e,i,r=this[0],n={top:0,left:0};if("fixed"===Tt.css(r,"position"))e=r.getBoundingClientRect();else{for(e=this.offset(),i=r.ownerDocument,t=r.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===Tt.css(t,"position");)t=t.parentNode;t&&t!==r&&1===t.nodeType&&(n=Tt(t).offset(),n.top+=Tt.css(t,"borderTopWidth",!0),n.left+=Tt.css(t,"borderLeftWidth",!0))}return{top:e.top-n.top-Tt.css(r,"marginTop",!0),left:e.left-n.left-Tt.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===Tt.css(t,"position");)t=t.offsetParent;return t||ne})}}),Tt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;Tt.fn[t]=function(r){return Nt(this,function(t,r,n){var o;if(Ct(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===n)return o?o[e]:t[r];o?o.scrollTo(i?o.pageXOffset:n,i?n:o.pageYOffset):t[r]=n},t,r,arguments.length)}}),Tt.each(["top","left"],function(t,e){Tt.cssHooks[e]=X(xt.pixelPosition,function(t,i){if(i)return i=N(t,e),fe.test(i)?Tt(t).position()[e]+"px":i})}),Tt.each({Height:"height",Width:"width"},function(t,e){Tt.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,r){Tt.fn[r]=function(n,o){var s=arguments.length&&(i||"boolean"!=typeof n),a=i||(!0===n||!0===o?"margin":"border");return Nt(this,function(e,i,n){var o;return Ct(e)?0===r.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===n?Tt.css(e,i,a):Tt.style(e,i,n,a)},e,s?n:void 0,s)}})}),Tt.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){Tt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),Tt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),Tt.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,r){return this.on(e,t,i,r)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}}),Tt.proxy=function(t,e){var i,r,n;if("string"==typeof e&&(i=t[e],e=t,t=i),wt(t))return r=ft.call(arguments,2),n=function(){return t.apply(e||this,r.concat(ft.call(arguments)))},n.guid=t.guid=t.guid||Tt.guid++,n},Tt.holdReady=function(t){t?Tt.readyWait++:Tt.ready(!0)},Tt.isArray=Array.isArray,Tt.parseJSON=JSON.parse,Tt.nodeName=l,Tt.isFunction=wt,Tt.isWindow=Ct,Tt.camelCase=m,Tt.type=a,Tt.now=Date.now,Tt.isNumeric=function(t){var e=Tt.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},r=[],void 0!==(n=function(){return Tt}.apply(e,r))&&(t.exports=n);var ti=i.jQuery,ei=i.$;return Tt.noConflict=function(t){return i.$===Tt&&(i.$=ei),t&&i.jQuery===Tt&&(i.jQuery=ti),Tt},o||(i.jQuery=i.$=Tt),Tt})},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t){return d[t]?d[t]:d[t]=(0,l.default)(t).then(function(t){return t.text()})}Object.defineProperty(e,"__esModule",{value:!0}),e.AdminDistrictLayer=void 0;var o=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var s=i(15),a=r(s),c=i(6),l=r(c),u=i(8),h=r(u),f=i(0),d={},p={},g=e.AdminDistrictLayer=h.default.extend({_forceRenderKeys:["fill","valueName","getValue","url"],initialize:function(t){t=o({},p,t),h.default.prototype.initialize.call(this,t)},_initEvents:function(){var t=this;this.on("loadstart",function(e){t.data={type:"FeatureCollection",features:[]}}),this.on("loaddata",function(e){t.renderRid!==e.rid&&(t.clearFrames(),t.clearSvg(),t.renderRid=e.rid),t.data.features=t.data.features.concat(e.data.features),t.render(e.data)})},_initMapEvent:function(){var t=this._map;t.on("click",this.clearClickFeature,this),t.on("resize",this._reset,this),t.on("moveend",this._reset,this),t.on("zoomstart",this._onZoomstart,this),t.on("zoomend",this._reset,this)},_removeMapEvent:function(){var t=this._map;t.off("click",this.clearClickFeature,this),t.off("resize",this._reset,this),t.off("moveend",this._reset,this),t.off("zoomstart",this._onZoomstart,this),t.off("zoomend",this._reset,this)},_destroy:function(){for(var t=this.getContainer(),e=t.childNodes,i=0,r=e.length;r>i;i++)e[i]&&t.removeChild(e[i]);this.$svg&&this.$svg.off(),this._removeMapEvent(),this.clearFrames(),this._destroyDs(),this.off()},_onZoomstart:function(){this.getSvg().hide()},_reset:function(){if(this.bounds){var t=this.bounds,e=new L.Bounds(this._map.latLngToLayerPoint([t[0],t[1]]),this._map.latLngToLayerPoint([t[2],t[3]]));if(void 0===this.layerBounds||!this.layerBounds.min.equals(e.min)||!this.layerBounds.max.equals(e.max)){this.layerBounds=e;var i=e.getSize(),r=this.getSvg();L.DomUtil.setPosition(r.get(0),e.min),r.attr("width",i.x+"px").attr("height",i.y+"px").show()}}},_forceRender:function(){this.clearFrames(),this.raf(this.render.bind(this,this.data))},onAdd:function(t){this._map=t,this._initEvents(),this._initMapEvent(),this._initDs()},onRemove:function(){this._destroy()},setOptions:function(t){var e=(0,f.isAnyRenderOptionsChange)(t,this.options,this._forceRenderKeys);if(L.setOptions(this,t),t.ds&&this._ds!==t.ds)return this._ds.destroy(),void this._initDs();e&&this._forceRender()},initSvg:function(t){var e=this;if(void 0==this.svgContainer&&(this.svgContainer=document.createElement("div")),this.level!==t&&(this.initSvgPromise=null,this.level=t),this.initSvgPromise)return this.initSvgPromise;var i=this.svgContainer,r=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);return i.style[r]="50% 50%",i.style.position="absolute",this.initSvgPromise=n(this.options.url[t]).then(function(r){i.innerHTML=r;var n=(0,a.default)(i).find("svg").hide().attr("data-level",t);e.$svg=n;var o=n.attr("bounds").split(" ").map(function(t){return parseFloat(t)});e.bounds=o;var s=e.getContainer();(0,a.default)(s).empty().append(i),e._reset(),e.initSvgClickEvent()})},initSvgClickEvent:function(){var t=this;this.$svg.on("click",function(e){t.isSvgClicked=!0,t.clickFeature=(0,a.default)(e.target).data("feature")})},clearClickFeature:function(){this.isSvgClicked||(this.clickFeature=null),this.isSvgClicked=!1},getSvg:function(){return this.$svg?this.$svg:(0,a.default)(this.svgContainer).find("svg")},clearSvg:function(){this.getSvg().find("polygon").attr("fill","none").attr("stroke","none")},renderInSingleFrame:function(t,e){this.raf(function(){t.forEach(function(t){return e(t)})})},renderInMultiFrames:function(t,e,i){for(var r=[],n=0,o=t.features.length;o>n;n++){r.push(t.features[n]),r.length===i&&(this.renderInSingleFrame(r,e),r=[])}r.length>0&&this.renderInSingleFrame(r,e)},renderPolygon:function(t,e){var i=this.getSvg(),r=this.getValue(t),n=(0,f.getScale)(r,this.options.fill),o=t.properties[e],s=i.find("[adcode="+o+"]");s.data("feature",t),s.attr("fill")!==n&&s.attr("fill",n)},render:function(t){var e=this;if(void 0!=t){var i=t&&t.features&&t.features[0];if(void 0!=i){var r="province";i.properties&&i.properties.city&&(r="city"),this.initSvg(r).then(function(){e.$svg.find("[adcode]").data("feature",null),e.renderInMultiFrames(t,function(t){e.renderPolygon(t,r)},20)}).catch(function(t){console.error(t)})}}},getContainer:function(){return this.getPane()},findObjectByXy:function(t,e){return this.clickFeature}});e.default=function(t){return new g(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BubbleLayer=void 0;var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},n=i(2),o=i(4),s=function(t){return t&&t.__esModule?t:{default:t}}(o),a=i(0),c={gap:3},l=e.BubbleLayer=s.default.extend({_forceRenderKeys:["radius","fill","gap","valueName","getValue"],initialize:function(t){t=r({},c,t),s.default.prototype.initialize.call(this,t)},createBubble:function(t,e,i){var r=this.getValue(t),o=(0,a.getScale)(r,this.options.radius),s=(0,a.pointToPixel)(t,e,this._map,i);if(void 0==s)return null;var c=(0,a.getScale)(r,this.options.fill),l=new n.fabric.Circle({radius:o,strokeWidth:2,fill:"#fff",stroke:c,originX:"center",originY:"center"}),u=new n.fabric.Circle({radius:o-this.options.gap,fill:c,originX:"center",originY:"center"}),h=[l,u];if(this.options.font){h.push(new n.fabric.Text(""+r,{originX:"center",originY:"center",fontSize:this.options.font.size,fill:this.options.font.fill}))}return new n.fabric.Group(h,{originX:"center",originY:"center",top:s.y,left:s.x})},render:function(t){var e=this;if(void 0!=t){this.renderInMultiFrames(t,function(t,i,r){return e.createBubble(t,i,r)},500)}},findObjectByXy:function(t,e){for(var i=this.data.features,r=this._map.getSize(),n=i.length-1;n>-1;n--){var o=i[n],s=this.getValue(o),c=(0,a.getScale)(s,this.options.radius),l=new L.Bounds(L.point([-c,-c]),r.add([c,c])),u=(0,a.pointToPixel)(o,l,this._map);if(void 0!=u){if(Math.pow(c,2)>=Math.pow(t-u.x,2)+Math.pow(e-u.y,2))return o}}return null}});e.default=function(t){return new l(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i(45),i(1);var o=i(36),s=function(t){return t&&t.__esModule?t:{default:t}}(o);e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.async=!0;var i=L.tileLayer.canvas();i.setUrl(t);var o={};o.WGS84=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};return d3.geo.transform({point:function(e,r){var n=i._map.latLngToLayerPoint(new L.LatLng(r,e));this.stream.point(n.x-t.x,n.y-t.y)}})};var a={};a.geojson={extensions:["geojson","json"],get:function(t,e){var i=d3.xhr(t).responseType("json").get(e);return i.abort.bind(i)},parse:function(t,e){t=!t.isError&&t.data?t.data:t;var i={x:parseInt(d3.select(e).style("left").slice(0,-2),10),y:parseInt(d3.select(e).style("top").slice(0,-2),10)};return{data:t,projection:o.WGS84(i)}}},a.topojson={},a.protobuf={};var c="auto";i.mode=function(t,e){return c=t,i};var l=[];i.render=function(t,e){if("function"==typeof e)return l.push({layer:t,run:e}),i;var r=new s.default(i,t);return l.push({layer:t,run:r.run.bind(r)}),r};var u=function(){var t=null;if("auto"===c){var e=i._url.split("?")[0].split(".").pop(),r=!0,o=!1,s=void 0;try{for(var l,u=Object.keys(a)[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var h=l.value;if(a[h].extensions.includes(e)){t=a[h];break}}}catch(t){o=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw s}}if(!t)throw Error("The URLs must be end with geojson, json, topojson or mvt, while not the "+e)}else t="object"===(void 0===c?"undefined":n(c))?c:a[c];return t};return i.getData=function(t,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:u()).get(t&&i.getTileUrl(t)||i._url,function(t,i){if(t)return e(t);e(null,i.response)})},i.drawTile=function(t,o,s){var a=t.getContext("2d");o=r({},o,{z:s});var c=u();i.getData(o,function(r,s){if(r)throw r;var u=c.parse(s,t),h=d3.geo.path().projection(u.projection).context(a).pointRadius(function(t){return t.properties._geoengine_radius}),f=t.width,d=t.height;if(e.hidpiPolyfill&&(f*=1/window.devicePixelRatio,d*=1/window.devicePixelRatio),a.clearRect(0,0,f,d),!l.length)throw Error("No renderer specified!");l.forEach(function(t){u.data&&(i.__currentLayer=t.layer,t.run(a,u.data.features,o,function(t){"object"!==(void 0===t?"undefined":n(t))||Array.isArray(t)||(t=[t]),a.beginPath(),t.forEach(h)}))}),i.tileDrawn(t)},c)},i}},function(t,e,i){"use strict";function r(t,e,i){var r=t.lat;return": "+t.lng.toFixed(9)+"\n<br/>\n: "+r.toFixed(9)+"\n<br/>\n: "+e+" \n<br/>\n"+(i?"":"")+"\n<br/>\n\n  "}Object.defineProperty(e,"__esModule",{value:!0}),e.CircleRangeLayer=void 0;var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var o=i(3),s=function(t){return t&&t.__esModule?t:{default:t}}(o);i(14);var a={strokeColor:"rgba(255,0,0,1)",strokeWeight:3,fillColor:"rgba(255,0,0,0.5)",toolTipContent:r,toolTipClass:"circle-range-tooltip",disableEditWhenMouseUp:!1},c=e.CircleRangeLayer=L.Layer.extend({initialize:function(t){this.setOptions(n({},a,t)),this.circle={editing:!1},this.isCirclEditEnabled=!0,this.prevent=!1,this.timer=0},setOptions:function(t){L.setOptions(this,t)},onAdd:function(t){this._map=t,this._initMapEvents(),this.enableEdit()},onRemove:function(){this._destroy()},_destroy:function(){clearTimeout(this.openCircleEditTimer);for(var t in this.mapEvents)this._map.off(t,this.mapEvents[t]);this.unlockMap(),this.removeCircleInstance(),this.removeToolTip()},_initMapEvents:function(){this.mapEvents={mousedown:this.onMouseDown.bind(this),mousemove:s.default.throttle(this.onMouseMove.bind(this),50),mouseup:this.onMouseUp.bind(this),zoomend:this.onZoomEnd.bind(this)};for(var t=["zoomend"],e=0;1>e;e++){var i=t[e];this._map.on(i,this.mapEvents[i])}},onMouseDown:function(t){var e=this;this.openCircleEditTimer=setTimeout(function(){e.removeCircleInstance(),e.removeToolTip(),e.circle={startLatlng:t.latlng,endLatlng:t.latlng,radius:0,editing:!0},e.initCircle(),e.renderToolTip(),e._map.on("mousemove",e.mapEvents.mousemove)},200)},onMouseMove:function(t){if(void 0!=this._map&&this.circle.editing){this.circle.endLatlng=t.latlng;var e=this.circle;this.circle.radius=this._map.distance(e.startLatlng,e.endLatlng),this.drawCircle(),this.renderToolTip(),this.fire("circlechange",this.circle)}},onMouseUp:function(){void 0!=this._map&&(clearTimeout(this.openCircleEditTimer),this.options.disableEditWhenMouseUp&&this.disableEdit(),this.circle.editing&&(this.circle.editing=!1,this.fire("circleconfirm",this.circle),this._map.off("mousemove",this.mapEvents.mousemove)))},onZoomEnd:function(){this.updateToolTipPosition()},lockMap:function(){this._map.dragging.disable(),this._map.doubleClickZoom.disable()},unlockMap:function(){this._map.dragging.enable(),this._map.doubleClickZoom.enable()},disableEdit:function(){this.isCirclEditEnabled=!1;for(var t=["mouseup","mousedown"],e=0;2>e;e++){var i=t[e];this._map.off(i,this.mapEvents[i])}this.unlockMap(),this.renderToolTip(),this.fire("disableedit")},enableEdit:function(){this.isCirclEditEnabled=!0;for(var t=["mouseup","mousedown"],e=0;2>e;e++){var i=t[e];this._map.on(i,this.mapEvents[i])}this.lockMap(),this.renderToolTip(),this.fire("enableedit")},initCircle:function(){var t=this;this.circleInstance=L.circle(this.circle.startLatlng),this.circleInstance.options.pane=this.options.pane,this.circleInstance.setStyle({weight:this.options.strokeWeight,color:this.options.strokeColor,fill:!0,fillColor:this.options.fillColor}),this.circleInstance.on("click",function(){t.timer=setTimeout(function(){t.prevent||(t.isCirclEditEnabled?t.disableEdit():t.enableEdit()),t.prevent=!1},200)}),this.circleInstance.on("dblclick",function(){clearTimeout(t.timer),t.prevent=!0,t.fire("circleaffirm",t.circle),t.removeCircleInstance(),t.removeToolTip()}),this.circleInstance.addTo(this._map)},drawCircle:function(){this.circleInstance.setRadius(this.circle.radius)},renderToolTip:function(){var t=this.circle,e=t.startLatlng,i=t.radius;void 0!=e&&(void 0==this.toolTip&&(this.toolTip=L.DomUtil.create("span",this.options.toolTipClass,this._map.getPane(this.options.pane))),this.updateToolTipPosition(),this.toolTip.innerHTML=this.options.toolTipContent(e,i,this.isCirclEditEnabled))},updateToolTipPosition:function(){if(void 0!=this.toolTip){var t=this._map.latLngToLayerPoint(this.circle.endLatlng);L.DomUtil.setPosition(this.toolTip,t)}},removeCircleInstance:function(){this.circleInstance&&(this.circleInstance.off(),this.circleInstance.remove(),this.circleInstance=void 0)},removeToolTip:function(){this.toolTip&&(L.DomUtil.remove(this.toolTip),this.toolTip=void 0)}});c.fireEvents=["circlechange","circleconfirm","enableedit","disableedit","circleaffirm"],e.default=function(t){return new c(t)}},function(t,e,i){"use strict";function r(t,e,i){var r=t.lat;return": "+t.lng.toFixed(9)+"\n<br/>\n: "+r.toFixed(9)+"\n<br/>\n: "+e+" \n  "}function n(){return L.divIcon({html:""})}function o(){return L.divIcon({html:""})}Object.defineProperty(e,"__esModule",{value:!0}),e.CircleRangeLayer=void 0;var s=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var a=i(3);i(14);var c={strokeColor:"rgba(255,0,0,1)",strokeWeight:3,dashArray:"5, 5",radiusStrokeColor:"rgba(255,0,0,1)",radiusStrokeWeight:3,radiusDashArray:"5, 5",fillColor:"rgba(255,0,0,0.5)",toolTipContent:r,toolTipClass:"circle-range-tooltip",disableEditWhenMouseUp:!1,renderBorderHandler:n,renderCenterHandler:o,isCirclEditEnabled:!0,pane:"circle-range-pane",centerHandlerTooltip:""},l=e.CircleRangeLayer=L.Layer.extend({initialize:function(t){if(void 0==t.initCircle)throw Error("options.initCircle cannot be empty");this.setOptions(s({},c,t)),this.isCirclEditEnabled=this.options.isCirclEditEnabled,this.prevent=!1,this.timer=0},initCircle:function(t){var e=t.startLatlng,i=t.endLatlng;this.circle={startLatlng:L.latLng(e),endLatlng:L.latLng(i),radius:this._map.distance(e,i)}},setOptions:function(t){L.setOptions(this,t),this._map&&this.options.circle&&this.options.circle!==this.circle&&(this.initCircle(this.options.circle),this.renderCircle())},onAdd:function(t){this._map=t,void 0==this.getPane()&&this._map.createPane(this.options.pane),this._initMapEvents(),this.initCircle(this.options.initCircle),this.initCircleInstance(),this.initCircleRadius(),this.initCenterHandler(),this.initBorderHandler(),this.renderCircle(),this.enableEdit()},onRemove:function(){this._destroy()},_destroy:function(){this._destroyMapEvents(),this.removeLeafletInstance(this.polyline),this.removeLeafletInstance(this.circleInstance),this.removeLeafletInstance(this.centerHandler),this.removeLeafletInstance(this.borderHandler),this.removeToolTip()},_initMapEvents:function(){this.mapEvents={zoomend:this.onZoomEnd.bind(this)};for(var t=["zoomend"],e=0;1>e;e++){var i=t[e];this._map.on(i,this.mapEvents[i])}},_destroyMapEvents:function(){for(var t in this.mapEvents)this._map.off(t,this.mapEvents[t])},onZoomEnd:function(){this.updateToolTipPosition()},enableEdit:function(){L.setOptions(this.centerHandler.options,{draggable:!0}),L.setOptions(this.borderHandler.options,{draggable:!0}),this.isCirclEditEnabled=!0,this.fire("enableedit")},disableEdit:function(){L.setOptions(this.centerHandler.options,{draggable:!1}),L.setOptions(this.borderHandler.options,{draggable:!1}),this.isCirclEditEnabled=!1,this.fire("disableedit")},getPaneName:function(){var t=this._map.getPanes(),e=this.getPane();for(var i in t)if(t[i]===e)return i},initCircleInstance:function(){this.circleInstance=L.circle(this.circle.startLatlng,{pane:this.getPaneName()}),this.circleInstance.setStyle({weight:this.options.strokeWeight,color:this.options.strokeColor,dashArray:this.options.dashArray,fill:!0,fillColor:this.options.fillColor}),this.circleInstance.addTo(this._map)},initCircleRadius:function(){this.polyline=L.polyline([this.circle.startLatlng,this.circle.endLatlng],{pane:this.getPaneName(),weight:this.options.radiusStrokeWeight,color:this.options.radiusStrokeColor,dashArray:this.options.radiusDashArray}),this.polyline.addTo(this._map)},initCenterHandler:function(){var t=this,e=this.options.renderCenterHandler();if(!(e instanceof L.Icon))throw Error("renderCenterHandler must return an object instanceof L.Icon");this.centerHandler=L.marker(this.circle.startLatlng,{icon:e,draggable:this.isCirclEditEnabled,pane:this.getPaneName(),zIndexOffset:1e3});var i=this.options.centerHandlerTooltip;"function"==typeof i&&(i=function(e){return t.options.centerHandlerTooltip(t.circle.startLatlng,t.circle.radius,t.isCirclEditEnabled,e)}),i&&this.centerHandler.bindTooltip(i),this.centerHandler.on("drag",function(){var e=t.centerHandler.getLatLng(),i=t.circle.startLatlng,r=t.circle.endLatlng,n={lat:r.lat+e.lat-i.lat,lng:r.lng+e.lng-i.lng};t.circle=s({},t.circle,{startLatlng:e,endLatlng:n}),t.borderHandler.setLatLng(n),t.renderCircle(),t.fire("circlechange",t.circle)}),this.centerHandler.addTo(this._map)},initBorderHandler:function(){var t=this,e=this.options.renderBorderHandler();if(!(e instanceof L.Icon))throw Error("renderCenterHandler must return an object instanceof L.Icon");this.borderHandler=L.marker(this.circle.endLatlng,{icon:e,draggable:this.isCirclEditEnabled,pane:this.getPaneName(),zIndexOffset:1e3}),this.borderHandler.on("drag",function(){var e=t.borderHandler.getLatLng();t.circle=s({},t.circle,{endLatlng:e,radius:t._map.distance(t.circle.startLatlng,e)}),t.renderCircle(),t.fire("circlechange",t.circle)}),this.borderHandler.addTo(this._map)},renderCircle:function(){this.renderToolTip(),this.renderCircleRadius(),this.renderCenterHandler(),this.renderBorderHandler(),this.circleInstance.setLatLng(this.circle.startLatlng),this.circleInstance.setRadius(this.circle.radius)},renderCenterHandler:function(){this.centerHandler.setLatLng(this.circle.startLatlng)},renderBorderHandler:function(){this.borderHandler.setLatLng(this.circle.endLatlng)},renderCircleRadius:function(){this.polyline.setLatLngs([this.circle.startLatlng,this.circle.endLatlng])},renderToolTip:function(){var t=this.circle,e=t.startLatlng,i=t.radius;void 0!=e&&(void 0==this.toolTip&&(this.toolTip=L.DomUtil.create("span",this.options.toolTipClass,this.getPane())),this.updateToolTipPosition(),this.toolTip.innerHTML=this.options.toolTipContent(e,i,this.isCirclEditEnabled))},updateToolTipPosition:function(){if(void 0!=this.toolTip){var t=this._map.latLngToLayerPoint(this.circle.endLatlng);L.DomUtil.setPosition(this.toolTip,t)}},removeLeafletInstance:function(t){t&&(t.off(),t.remove())},removeToolTip:function(){this.toolTip&&(L.DomUtil.remove(this.toolTip),this.toolTip=void 0)}});l.fireEvents=["circlechange","circleconfirm","enableedit","disableedit","circleaffirm"],e.default=function(t){return new l(t)}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){for(var i={},r=["baseUrl","id","version","extent","filter","transforms","time","token","geohash_level"],n=0;9>n;n++){var o=r[n],s=t[o],a=s;p.default.isObject(s)?a=encodeURIComponent(JSON.stringify(s)):void 0==s&&(a=""),i[o]=a}return e(i)}function c(t,e){return t.extent&&t.extent.geohashes&&t.extent.geohashes.length>1?t.extent.geohashes.map(function(i){return a(f({},t,{extent:f({},t.extent,{geohashes:[i]})}),e)}):a(t,e)}function l(t){var e=t.baseUrl,i=t.version,r=t.id,n=t.extent,o=t.filter,s=t.transforms,a=t.time,c=t.token,l=t.geohash_level;if(!c)throw Error("token cannot be empty");if(!r)throw Error("id cannot be empty");if(!i)throw Error("version cannot be empty");return e+"/datasource/"+i+"/data/"+r+"?extent="+n+"&filter="+o+"&transforms="+s+"&time="+a+"&geohash_level="+l+"&token="+c}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),h=function t(e,i,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,r)}if("value"in n)return n.value;var s=n.get;if(void 0!==s)return s.call(r)},f=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},d=i(3),p=r(d),g=i(10),v=r(g);e.default=function(t){function e(){var t,i,r,s;n(this,e);for(var a=arguments.length,c=Array(a),u=0;a>u;u++)c[u]=arguments[u];return i=r=o(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(c))),r.template=l,s=i,o(r,s)}return s(e,t),u(e,[{key:"preload",value:function(t){return t=f({},this.props,t),t.url=c(t,this.template),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"preload",this).call(this,t)}},{key:"_request",value:function(t){return this.props.url=c(this.props,this.template),h(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_request",this).call(this,t)}},{key:"setTemplate",value:function(t){this.template=t}},{key:"setProps",value:function(t){this.props=f({},this.props,t)}}]),e}(v.default)},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=i(5),c=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default=function(t){function e(){return r(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),s(e,[{key:"setData",value:function(t){this.props.data=t}},{key:"_request",value:function(t){this.emitLoadStart(t),this.emitLoadData(t,this.props.data),this.emitLoad(t)}}]),e}(c.default)},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){if(void 0==t)throw Error("dsMap must be a datasourceMap");for(var e in t){if(!(t[e]instanceof h.default))throw Error(e+" is not a datasource")}}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},c=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),l=i(9),u=i(5),h=function(t){return t&&t.__esModule?t:{default:t}}(u),f={ignoreOutdateRequest:!0,dsMap:{}};e.default=function(t){function e(t){r(this,e),s(t.dsMap);var i=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a({},f,t)));return i.listenerMap={},i.dataMap={},i.initDsMapListeners(),i}return o(e,t),c(e,[{key:"setDsMap",value:function(t){s(t),this.destroyDsMapListeners(),this.dataMap={},this.props.dsMap=t,this.initDsMapListeners()}},{key:"addDs",value:function(t,e){if(void 0!=this.props.dsMap[t])throw Error("ds "+t+" has been in map. duplicte key");this.props.dsMap[t]=e,this.initDsListeners(t)}},{key:"removeDs",value:function(t){this.destroyDsListeners(t),delete this.dataMap[t],delete this.props.dsMap[t]}},{key:"initDsMapListeners",value:function(){for(var t in this.props.dsMap)this.initDsListeners(t)}},{key:"initDsListeners",value:function(t){var e=this.props.dsMap[t],i={loadstart:this.onDsLoadStart.bind(this,t,e),loaddata:this.onDsLoadData.bind(this,t,e),load:this.onDsLoad.bind(this,t,e)};this.listenerMap[t]=i;for(var r in i)e.on(r,i[r])}},{key:"destroyDsMapListeners",value:function(){for(var t in this.props.dsMap)this.destroyDsEvent(t)}},{key:"destroyDsEvent",value:function(t){var e=this.props.dsMap[t],i=this.listenerMap[t];for(var r in i)e.removeListener(r,i[r]);delete this.listenerMap[t]}},{key:"onDsLoadStart",value:function(t,e,i){void 0==this.dataMap[t]&&(this.dataMap[t]={}),this.dataMap[t].request={rid:i}}},{key:"onDsLoadData",value:function(t,e,i,r){var n=this.dataMap[t];this.props.ignoreOutdateRequest&&n.request.rid!=i||(void 0!=n.request.data?(n.request.data=[n.request.data],n.request.data.push(r)):n.request.data=r)}},{key:"onDsLoad",value:function(t,e,i){var r=this.dataMap[t];if(!this.props.ignoreOutdateRequest||r.request.rid==i){r.data=r.request.data,delete r.request;var n=this.props.parseData(this.getUnparsedData());void 0!=n&&this.emitLoadData(i,n)}}},{key:"onDsLoadError",value:function(t,e,i,r){this.emitLoadError(i,r)}},{key:"getUnparsedData",value:function(){var t={};for(var e in this.dataMap)t[e]=this.dataMap[e].data;return t}},{key:"_request",value:function(t){var e=this;this.emitLoadStart(t);var i=Object.keys(this.props.dsMap).map(function(t){return e.props.dsMap[t].request()});return(0,l.all)(i).then(function(){e.emitLoad(t)}).catch(function(i){e.emitLoadError(t,i)})}}]),e}(h.default)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GridHeatLayer=void 0;var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},n=i(2),o=i(4),s=function(t){return t&&t.__esModule?t:{default:t}}(o),a=i(0),c={minPixel:5,gridSize:{width:1,height:1,unit:"arc"}},l=e.GridHeatLayer=s.default.extend({_forceRenderKeys:["gridSize","fill","minPixel","valueName","getValue","minPixel","unit"],initialize:function(t){t=r({},c,t),s.default.prototype.initialize.call(this,t)},createGrid:function(t,e,i,r){var o=(0,a.pointToPixel)(t,e,this._map,r);if(void 0==o)return null;var s=this.getValue(t),c=(0,a.getScale)(s,this.options.fill);return new n.fabric.Rect({originX:"center",originY:"center",fill:c,top:o.y,left:o.x,width:i.width,height:i.height})},gridSizeToPixel:function(t){var e=this._map,i=t.unit,r=t.width,n=t.height;if("arc"===i)return(0,a.arcToPixel)(r,n,this.options.minPixel,e);if("meter"===i)return(0,a.meterToPixel)(r,n,this.options.minPixel,e);if("pixel"===i)return{width:r,height:n};throw Error("only support unit [arc, meter, pixel]")},render:function(t){var e=this;if(void 0!=t){var i=this.options.gridSize,r=this.gridSizeToPixel(i);this.renderInMultiFrames(t,function(t,i,n){return e.createGrid(t,i,r,n)},2e3)}},findObjectByXy:function(t,e){for(var i=this.data.features,r=this.gridSizeToPixel(this.options.gridSize),n=this._map.getSize(),o=new L.Bounds(L.point([-r.width,-r.height]),n.add([r.width,r.height])),s=i.length-1;s>-1;s--){var c=i[s],l=(0,a.pointToPixel)(c,o,this._map);if(void 0!=l&&(Math.abs(l.x-t)<=r.width/2&&Math.abs(l.y-e)<=r.height/2))return c}return null}});e.default=function(t){return new l(t)}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.HeatLayer=void 0;var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var o=i(43),s=r(o),a=i(7),c=r(a),l=i(0),u={blur:3,radius:5,minOpacity:.1,unit:"pixel",minPixel:1};e.HeatLayer=L.HeatLayer=c.default.extend({_forceRenderKeys:["fill","radius","blur","valueName","getValue","unit","minPixel"],initialize:function(t){t=n({},u,t),c.default.prototype.initialize.call(this,t),this.grid=[]},_initEvents:function(){var t=this;this.on("loadstart",function(e){t.clearGrid(),t.data={type:"FeatureCollection",features:[]}}),this.on("loaddata",function(e){t.data.features=t.data.features.concat(e.data.features),t.addDataToGrid(e.data)}),this.on("load",function(e){t._forceRender()})},_onMapResize:function(){c.default.prototype._onMapResize.call(this,this._map),this.getHeat().resize(),this.clearGrid()},_onMapMoveend:function(){this.clearGrid(),c.default.prototype._onMapMoveend.call(this,this._map)},_onZoomstart:function(t){c.default.prototype._onZoomstart.call(this,this._map),this.clearGrid()},convertUnit:function(t){if("meter"===this.options.unit)return(0,l.meterToPixel)(t,0,this.options.minPixel,this._map).width;if("arc"===this.options.unit)return(0,l.arcToPixel)(t,0,this.options.minPixel,this._map).width;if("pixel"===this.options.unit)return t;throw Error("only support unit [arc, meter, pixel]")},_updateOptions:function(){if(void 0!=this.heat){var t=this.getHeat(),e=this.options,i=e.radius,r=e.blur;if(t.radius(this.convertUnit(i),this.convertUnit(r)),this.options.fill){var n=this.getFillMax(),o=this.getFillMin();t.gradient(this.getGradient()),t.max(n-o)}}},onAdd:function(t){c.default.prototype.onAdd.call(this,t),this.initHeat()},getFillMax:function(){var t=this.options.fill.domain;return 0===t.length?1:t[t.length-1]},getFillMin:function(){var t=this.options.fill.domain;return 2>t.length?0:t[0]},getGradient:function(){var t=this.options.fill,e=t.domain,i=t.range,r=this.getFillMax(),n=this.getFillMin(),o=r-n;o>0||(o=1);var s={};return e.forEach(function(t,e){var r=t-n;r>0||(r=0),s[r/o]=i[e]}),s},initHeat:function(){if(this.heat)return this.heat;var t=this.createCanvas();return this.heat=(0,s.default)(t),this._updateOptions(),this.heat},getHeat:function(){return this.heat?this.heat:this.initHeat()},_lockAllCanvas:function(){c.default.prototype._lockAllCanvas.call(this),this.heat=void 0},addDataToGrid:function(t){if(void 0!=t){for(var e=this.getFillMin(),i=(this.getHeat(),this.getRenderContainerBounds()),r=this.getBufferedOffset(),n=this.grid,o=0,s=t.features.length;s>o;o++){var a=t.features[o],c=(0,l.pointToPixel)(a,i,this._map,r);if(void 0!=c){var u=c.x,h=c.y,f=this.getValue(a);isNaN(f)&&(f=e),n[h]=n[h]||[];var d=n[h][u];d?d[2]+=f:n[h][u]=[u,h,f]}}return n}},renderGrid:function(t){for(var e=this.getHeat(),i=this.getFillMax(),r=this.getFillMin(),n=[],o=0,s=t.length;s>o;o++)if(t[o])for(var a=0,c=t[o].length;c>a;a++){var l=t[o][a];l&&n.push([Math.round(l[0]),Math.round(l[1]),Math.min(l[2]-r,i-r)])}this.clearAllCanvas(),e.data(n).draw(this.options.minOpacity)},clearGrid:function(){this.grid=[]},recomputeDataToGrid:function(){0===this.grid.length&&this.addDataToGrid(this.data)},setOptions:function(t){var e=(0,l.isAnyRenderOptionsChange)(t,this.options,this._forceRenderKeys),i=this.options.valueName!==t.valueName||this.options.getValue!==t.getValue;if(L.setOptions(this,t),t.ds&&this._ds!==t.ds)return this._ds.destroy(),void this._initDs();i&&this.clearGrid(),(i||e)&&this._forceRender()},render:function(){var t=this;this.recomputeDataToGrid(),this._updateOptions(),this.renderGrid(this.grid),this.raf(function(){t.fire("renderdone")})}});e.default=L.heatLayer=function(t,e){return new L.HeatLayer(t,e)}},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},a=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),c=i(13),l=function(t){return t&&t.__esModule?t:{default:t}}(c);e.default=new(function(t){function e(){r(this,e);var t=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.registerList=[],t}return o(e,t),a(e,[{key:"register",value:function(t,e,i){if(void 0==e._map)throw Error("layer must be register after add to map");e._map===this.map&&this.isInited||this.initEventsOnMap(e._map),this.registerList.push({name:t,layer:e,zIndex:i}),this.registerList=this.registerList.sort(function(t,e){return t.zIndex-e.zIndex})}},{key:"unregister",value:function(t){for(var e=0,i=this.registerList.length;i>e;e++)if(this.registerList[e].name===t)return this.registerList.splice(e,1)}},{key:"initEventsOnMap",value:function(t){this._map=t,t.on("click",this.onMapClick,this),t.on("mousemove",this.onMapMouseMove,this),this.isInited=!0}},{key:"onMapClick",value:function(t){var e=this,i=t.containerPoint;clearTimeout(this.clickTimer),this.clickTimer=setTimeout(function(){var r=e.getByXy(i);r&&e.emit("clickobject",r.object,r.layer,i,t)},100)}},{key:"onMapMouseMove",value:function(t){var e=this,i=t.containerPoint;this.hoverTimer&&clearTimeout(this.hoverTimer),this.hoverTimer=setTimeout(function(){var r=e.getByXy(i);r&&e.emit("hoverobject",r.object,r.layer,i,t),e.hoverTimer=null},100)}},{key:"getByXy",value:function(t){for(var e=t.x,i=t.y,r=this.registerList.length-1;r>-1;r--){var n=this.registerList[r],o=n.layer;if(void 0!=o.findObjectByXy){var a=void 0;try{a=o.findObjectByXy(e,i)}catch(t){console.error("layer "+n.name+" findObject error",t)}if(a)return{layer:o,object:s({},a,{layerName:n.name})}}}}},{key:"destroy",value:function(){this._map.off("click",this.onMapClick,this),this.removeAllListeners()}}]),e}(l.default))},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.MarkerLayer=void 0;var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};i(1);var o=i(15),s=(r(o),i(6)),a=(r(s),i(8)),c=r(a),l=i(0),u={renderFeature:function(t){return L.divIcon({html:'<pre style="width: 100px; border: 1px solid black; background: rgba(0,0,0,0.7); color: white; word-break: break-all; white-space: normal">'+JSON.stringify(t)+"</pre>",className:"geoengin-marker"})},opacity:1,renderPopup:function(t){return null},renderTooltip:function(t){return null}},h=e.MarkerLayer=c.default.extend({_forceRenderKeys:["renderFeature","opacity","pane"],initialize:function(t){t=n({},u,t),c.default.prototype.initialize.call(this,t),this.group=null,this.clickObject=null},_initEvents:function(){var t=this;this.on("loadstart",function(e){t.data={type:"FeatureCollection",features:[]}}),this.on("loaddata",function(e){t.renderRid!==e.rid&&(t.clear(),t.renderRid=e.rid),t.data.features=t.data.features.concat(e.data.features),t.render(e.data)})},_initMapEvents:function(){this._map.on("click",this.onMapClick,this)},_removeMapEvents:function(){this._map.off("click",this.onMapClick,this)},_destroy:function(){this._destroyDs(),this.off()},onAdd:function(t){this._map=t,this._initEvents(),this._initMapEvents(),this._initDs()},onRemove:function(){this.clear(),this._destroy()},onMapClick:function(t){if(t.group===this.group)return this.clickObject=t.feature;this.clickObject=null},setOptions:function(t){var e=(0,l.isAnyRenderOptionsChange)(t,this.options,this._forceRenderKeys);if(L.setOptions(this,t),t.ds&&this._ds!==t.ds)return this._ds.destroy(),void this._initDs();e&&(this.clear(),this.render())},clear:function(){this.group&&(this.group.remove(),this.clickObject=null,this.group=null)},getPaneName:function(){var t=this._map.getPanes(),e=this.getPane();for(var i in t)if(t[i]===e)return i},renderFeature:function(t){var e=t.geometry.coordinates,i=[e[1],e[0]],r=this.options.renderFeature(t),n=this.options.renderPopup(t),o=this.options.renderTooltip(t);if(!(r instanceof L.Icon))throw Error("renderFeature must return an object instanceof L.Icon");if(n&&!(n instanceof L.Popup))throw Error("renderPopup must return an object instanceof L.popup");if(o&&!(o instanceof L.Tooltip))throw Error("renderTooltip must return an object instanceof L.tooltip");var s=new L.Marker(i,{pane:this.getPaneName(),opacity:this.options.opacity,icon:r});return n&&s.bindPopup(n),o&&s.bindTooltip(o),s._feature_=t,s},initMarkerGroupEvent:function(){var t=this;this.group.on("click",function(e){t._map.fire("click",n({},e,{feature:e.layer._feature_,group:t.group}))})},render:function(t){if(void 0!=t){if(void 0!=(t&&t.features&&t.features[0])){var e=t.features.map(this.renderFeature.bind(this));this.group=L.featureGroup(e),this.group.addTo(this._map),this.initMarkerGroupEvent()}}},findObjectByXy:function(){return this.clickObject?this.clickObject:null}});e.default=function(t){return new h(t)}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonLayer=void 0;var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},o=i(2),s=i(4),a=r(s),c=i(0),l=i(35),u=r(l),h=i(34),f=r(h),d={strokeWidth:3,stroke:{range:["rgb(0, 167, 157)"]},fill:{range:["rgba(0, 167, 157, 0.5)"]}},p=e.PolygonLayer=a.default.extend({_forceRenderKeys:["fill","stroke","strokeWidth","valueName","getValue"],initialize:function(t){t=n({},d,t),a.default.prototype.initialize.call(this,t)},createPolygon:function(t,e,i){var r=(0,c.polygonToPixels)(t,e,this._map,i);if(void 0==r)return null;var n=this.getValue(t),s=(0,c.getScale)(n,this.options.stroke||d.stroke),a=(0,c.getScale)(n,this.options.fill||d.fill);return new o.fabric.Polygon(r,{stroke:s,strokeWidth:this.options.strokeWidth,strokeLineCap:"round",strokeLineJoin:"round",fill:a})},render:function(t){var e=this;void 0!=t&&this.renderInMultiFrames(t,function(t,i,r){return e.createPolygon(t,i,r)},2e3)},findObjectByXy:function(t,e){var i=this.data.features,r=(0,c.pixelToPoint)(t,e,this._map),n=f.default.point([r.lng,r.lat]),o=!0,s=!1,a=void 0;try{for(var l,h=i[Symbol.iterator]();!(o=(l=h.next()).done);o=!0){var d=l.value,p=f.default.polygon((0,c.getPolygonCoords)(d));if((0,u.default)(n,p))return d}}catch(t){s=!0,a=t}finally{try{!o&&h.return&&h.return()}finally{if(s)throw a}}return null}});e.default=function(t){return new p(t)}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.PolylineLayer=void 0;var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},o=i(2),s=i(4),a=r(s),c=i(0),l=i(12),u=(r(l),i(39)),h=i(40),f=i(3),d=r(f),p={strokeWidth:3},g=e.PolylineLayer=a.default.extend({_forceRenderKeys:["pattern","stroke","strokeWidth","valueName","getValue"],initialize:function(t){t=n({},p,t),a.default.prototype.initialize.call(this,t)},loadPolylineRenderOptions:function(){if(void 0==this.options.pattern)return Promise.resolve({type:"stroke"});var t=this.options.pattern,e=t.src,i=t.patternWidth,r=t.patternHeight,n=t.cropOffsetX,s=t.cropOffsetY;return new Promise(function(t,a){var c=new Image;c.src=e,c.onload=function(){t({type:"pattern",pattern:new o.fabric.Pattern({source:(0,u.createPatternCanvas)(c,i/c.width,r/c.height,n,s,0,0)})})},c.onerror=a})},clonePixels:function(t){var e=[];return t.forEach(function(t){e.push({x:t.x,y:t.y})}),e},createPolylineWithPattern:function(t,e,i){var r=this.options.pattern,n=r.paddingX,s=r.paddingY,a=r.background,c=new o.fabric.Polyline(this.clonePixels(t),{stroke:d.default.isFunction(a)?a(i):a,strokeWidth:e.source.height,strokeLineCap:"round",strokeLineJoin:"round",fill:"transparent"});c.minY=c.minY+e.source.height/2,c.minX=c.minX+e.source.height/2;var l=[c];return l=l.concat((0,h.createPolylineDecoratorsWithPattern)(this.clonePixels(t),e,n,s))},createSimplePolyline:function(t,e){var i=this.getValue(t),r=(0,c.getScale)(i,this.options.stroke),n=new o.fabric.Polyline(e,{stroke:r,strokeWidth:this.options.strokeWidth,strokeLineCap:"round",strokeLineJoin:"round",fill:"transparent"});return n.minY=n.minY+this.options.strokeWidth/2,n.minX=n.minX+this.options.strokeWidth/2,n},createPolyline:function(t,e,i,r){var n=(0,c.lineToPixels)(t,e,this._map,r);return void 0==n?null:"pattern"===i.type?this.createPolylineWithPattern(n,i.pattern,t):this.createSimplePolyline(t,n)},render:function(t){var e=this;void 0!=t&&this.loadPolylineRenderOptions().then(function(i){e.renderInMultiFrames(t,function(t,r,n){return e.createPolyline(t,r,i,n)},2e3)}).catch(function(t){console.error(t)})},findObjectByXy:function(t,e){for(var i=this.data.features,r=this._map.getSize(),n=new L.Bounds(L.point([0,0]),r),o=i.length-1;o>-1;o--){var s=i[o],a=(0,c.lineToPixels)(s,n,this._map);if(void 0!=a&&(0,c.isPointOnLine)(t,e,a,this.options.strokeWidth))return s}return null}});e.default=function(t){return new g(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={arrowSample:i(44)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScatterLayer=void 0;var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},n=i(2),o=i(4),s=function(t){return t&&t.__esModule?t:{default:t}}(o),a=i(0),c={radius:5},l=e.ScatterLayer=s.default.extend({_forceRenderKeys:["radius","fill","valueName","getValue"],initialize:function(t){t=r({},c,t),s.default.prototype.initialize.call(this,t)},createScatter:function(t,e,i){var r=(0,a.pointToPixel)(t,e,this._map,i);if(void 0==r)return null;var o=this.getValue(t),s=(0,a.getScale)(o,this.options.fill);return new n.fabric.Circle({originX:"center",originY:"center",fill:s,radius:this.options.radius,top:r.y,left:r.x})},render:function(t){var e=this;if(void 0!=t){this.renderInMultiFrames(t,function(t,i,r){return e.createScatter(t,i,r)},2e3)}},findObjectByXy:function(t,e){for(var i=this.data.features,r=this.options.radius,n=Math.pow(r,2),o=this._map.getSize(),s=new L.Bounds(L.point([-r,-r]),o.add([r,r])),c=i.length-1;c>-1;c--){var l=i[c],u=(0,a.pointToPixel)(l,s,this._map);if(void 0!=u){if(n>=Math.pow(t-u.x,2)+Math.pow(e-u.y,2))return l}}return null}});e.default=function(t){return new l(t)}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.SymbolLayer=void 0;var n=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},o=i(2),s=i(4),a=r(s),c=i(0),l=i(3),u=r(l),h=i(37),f=r(h),d={},p={src:"http://img4.imgtn.bdimg.com/it/u=4019847970,3718827910&fm=21&gp=0.jpg",originX:"center",originY:"center",width:10,height:10,angle:0},g=e.SymbolLayer=a.default.extend({_forceRenderKeys:["symbol","valueName","getValue"],initialize:function(t){t=n({},d,t),a.default.prototype.initialize.call(this,t),this.imageCache={}},getCache:function(t,e){for(var i=(0,c.getScale)(t,this.options.symbol),r=Object.keys(e),n=(0,c.getKey)(i),o=0,s=r.length;s>o;++o){var a=r[o];if(a===n)return e[a]}console.error(Error("symbol "+n+" not found"));var l=new Image(i.width,i.height);return l.src=f.default,{symbol:i,imgElement:l}},generateImageCache:function(t){var e=this;return new Promise(function(i,r){var o=(0,c.getKey)(t);t=n({},p,t);var s=new Image(t.width,t.height);s.src=t.src,s.onload=function(){e.imageCache[o]={symbol:t,imgElement:s},i()},s.onerror=function(){console.error(Error("symbol "+t.src+" load failed")),i()}})},initImageCache:function(){var t=this;return this.initImageCachePromise?this.initImageCachePromise:this.initImageCachePromise=u.default.isArray(this.options.symbol.range)?Promise.all(this.options.symbol.range.map(function(e){return t.generateImageCache(e)})):this.generateImageCache(this.options.symbol)},clearImageCache:function(){this.initImageCachePromise=null,this.imageCache={}},createSymbol:function(t,e,i,r){var n=this.getValue(t),s=this.getCache(n,e),a=s.symbol,l=s.imgElement,u=(0,c.pointToPixel)(t,i,this._map,r);return void 0==u?null:new o.fabric.Image(l,{left:u.x,top:u.y,originX:a.originX,originY:a.originY,angle:a.angle})},render:function(t){var e=this;if(void 0!=t){var i=this.renderRid;this.initImageCache().then(function(){if(i===e.renderRid){var r=e.imageCache;e.renderInMultiFrames(t,function(t,i,n){return e.createSymbol(t,r,i,n)},2e3)}}).catch(function(t){console.error(t)})}},findObjectByXy:function(t,e){for(var i=this.data.features,r=this._map.getSize(),n=this.imageCache,o=i.length-1;o>-1;o--){var s=i[o],a=this.getValue(s),l=this.getCache(a,n),u=l.symbol,h=new L.Bounds(L.point([-u.width,-u.height]),r.add([u.width,u.height])),f=(0,c.pointToPixel)(s,h,this._map);if(void 0!=f&&!("center"===u.originX&&Math.abs(f.x-t)>u.width/2||"center"===u.originY&&Math.abs(f.y-e)>u.height/2||"left"===u.originX&&f.x-t>u.width||"top"===u.originY&&f.y-e>u.height||"right"===u.originX&&-(f.x-t)>u.width||"bottom"===u.originY&&-(f.y-e)>u.height))return s}return null},setOptions:function(t){u.default.isEqual(t.symbol,this.options.symbol)||this.clearImageCache(),a.default.prototype.setOptions.call(this,t)}});e.default=function(t){return new g(t)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return L.tileLayer(t,r({errorTileUrl:"http://geo-engine-tiles.oss-cn-hangzhou.aliyuncs.com/default.png"},e))}},function(t,e){function i(t,e,i,r){if(void 0===t)throw Error("geometry is required");if(e&&e.constructor!==Object)throw Error("properties must be an Object");if(i&&4!==i.length)throw Error("bbox must be an Array of 4 numbers");if(r&&-1===["string","number"].indexOf(typeof r))throw Error("id must be a number or a string");var n={type:"Feature"};return r&&(n.id=r),i&&(n.bbox=i),n.properties=e||{},n.geometry=t,n}function r(t,e,i){if(!t)throw Error("type is required");if(!e)throw Error("coordinates is required");if(!Array.isArray(e))throw Error("coordinates must be an Array");if(i&&4!==i.length)throw Error("bbox must be an Array of 4 numbers");var r;switch(t){case"Point":r=n(e).geometry;break;case"LineString":r=s(e).geometry;break;case"Polygon":r=o(e).geometry;break;case"MultiPoint":r=l(e).geometry;break;case"MultiLineString":r=c(e).geometry;break;case"MultiPolygon":r=u(e).geometry;break;default:throw Error(t+" is invalid")}return i&&(r.bbox=i),r}function n(t,e,r,n){if(!t)throw Error("No coordinates passed");if(void 0===t.length)throw Error("Coordinates must be an array");if(2>t.length)throw Error("Coordinates must be at least 2 numbers long");if(!x(t[0])||!x(t[1]))throw Error("Coordinates must contain numbers");return i({type:"Point",coordinates:t},e,r,n)}function o(t,e,r,n){if(!t)throw Error("No coordinates passed");for(var o=0;t.length>o;o++){var s=t[o];if(4>s.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;s[s.length-1].length>a;a++){if(0===o&&0===a&&!x(s[0][0])||!x(s[0][1]))throw Error("Coordinates must contain numbers");if(s[s.length-1][a]!==s[0][a])throw Error("First and last Position are not equivalent.")}}return i({type:"Polygon",coordinates:t},e,r,n)}function s(t,e,r,n){if(!t)throw Error("No coordinates passed");if(2>t.length)throw Error("Coordinates must be an array of two or more positions");if(!x(t[0][1])||!x(t[0][1]))throw Error("Coordinates must contain numbers");return i({type:"LineString",coordinates:t},e,r,n)}function a(t,e,i){if(!t)throw Error("No features passed");if(!Array.isArray(t))throw Error("features must be an Array");if(e&&4!==e.length)throw Error("bbox must be an Array of 4 numbers");if(i&&-1===["string","number"].indexOf(typeof i))throw Error("id must be a number or a string");var r={type:"FeatureCollection"};return i&&(r.id=i),e&&(r.bbox=e),r.features=t,r}function c(t,e,r,n){if(!t)throw Error("No coordinates passed");return i({type:"MultiLineString",coordinates:t},e,r,n)}function l(t,e,r,n){if(!t)throw Error("No coordinates passed");return i({type:"MultiPoint",coordinates:t},e,r,n)}function u(t,e,r,n){if(!t)throw Error("No coordinates passed");return i({type:"MultiPolygon",coordinates:t},e,r,n)}function h(t,e,r,n){if(!t)throw Error("geometries is required");if(!Array.isArray(t))throw Error("geometries must be an Array");return i({type:"GeometryCollection",geometries:t},e,r,n)}function f(t,e){if(void 0===t||null===t||isNaN(t))throw Error("num is required");if(e&&e<0)throw Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i}function d(t,e){if(void 0===t||null===t)throw Error("radians is required");var i=w[e||"kilometers"];if(!i)throw Error("units is invalid");return t*i}function p(t,e){if(void 0===t||null===t)throw Error("distance is required");var i=w[e||"kilometers"];if(!i)throw Error("units is invalid");return t/i}function g(t,e){return y(p(t,e))}function v(t){if(null===t||void 0===t)throw Error("bearing is required");var e=t%360;return 0>e&&(e+=360),e}function y(t){if(null===t||void 0===t)throw Error("radians is required");return t%(2*Math.PI)*180/Math.PI}function m(t){if(null===t||void 0===t)throw Error("degrees is required");return t%360*Math.PI/180}function b(t,e,i){if(null===t||void 0===t)throw Error("distance is required");if(t<0)throw Error("distance must be a positive number");return d(p(t,e),i||"kilometers")}function _(t,e,i){if(null===t||void 0===t)throw Error("area is required");if(t<0)throw Error("area must be a positive number");var r=C[e||"meters"];if(!r)throw Error("invalid original units");var n=C[i||"kilometers"];if(!n)throw Error("invalid final units");return t/r*n}function x(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}var w={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65},C={kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,centimetres:1e4,millimeter:1e6,acres:247105e-9,miles:3.86e-7,yards:1.195990046,feet:10.763910417,inches:1550.003100006};t.exports={feature:i,geometry:r,featureCollection:a,geometryCollection:h,point:n,multiPoint:l,lineString:s,multiLineString:c,polygon:o,multiPolygon:u,radiansToDistance:d,distanceToRadians:p,distanceToDegrees:g,radians2degrees:y,degrees2radians:m,bearingToAngle:v,convertDistance:b,convertArea:_,round:f,isNumber:x}},function(t,e,i){function r(t,e,i){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,o=e.length-1;e.length>n;o=n++){var s=e[n][0],a=e[n][1],c=e[o][0],l=e[o][1];if(t[1]*(s-c)+a*(c-t[0])+l*(t[0]-s)==0&&0>=(s-t[0])*(c-t[0])&&0>=(a-t[1])*(l-t[1]))return!i;a>t[1]!=l>t[1]&&(c-s)*(t[1]-a)/(l-a)+s>t[0]&&(r=!r)}return r}function n(t,e){return!(e[0]>t[0]||e[1]>t[1]||t[0]>e[2]||t[1]>e[3])}var o=i(11),s=o.getCoord,a=o.getCoords;t.exports=function(t,e,i){if(!t)throw Error("point is required");if(!e)throw Error("polygon is required");var o=s(t),c=a(e),l=e.geometry?e.geometry.type:e.type,u=e.bbox;if(u&&!1===n(o,u))return!1;"Polygon"===l&&(c=[c]);for(var h=0,f=!1;c.length>h&&!f;h++)if(r(o,c[h][0],i)){for(var d=!1,p=1;c[h].length>p&&!d;)r(o,c[h][p],!i)&&(d=!0),p++;d||(f=!0)}return f}},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var i=0;e.length>i;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();e.default=function(){function t(e,i){var n=this;r(this,t),this.layer=e,this.layerName=i,Object.keys(Object.getPrototypeOf(e)).concat(["render","data","mode","addTo","onAdd","onRemove"]).forEach(function(t){return n[t]=function(){for(var i=arguments.length,r=Array(i),n=0;i>n;n++)r[n]=arguments[n];return e[t].apply(e,r)}}),this.instructions=[],this.whereConditions=[],this.operateProperty=[],this.TYPE=["pit","bubble","point-heat","area-heat"],this.defaultRadius=10,this.defaultIntensity=.5}return o(t,[{key:"minZoom",value:function(t){return this.minZoom=t,this}},{key:"maxZoom",value:function(t){return this.maxZoom=t,this}},{key:"_radius",value:function(t){if("function"!=typeof t){var e=parseFloat(t);if(Number.isNaN(e)||!Number.isFinite(e))throw Error("radius could only be function or number, while "+t+" is not an vaild number");t=function(t){return e}}return this.operateProperty.push({type:"add",name:"_geoengine_radius",value:t}),this}},{key:"radius",value:function(t){return this._radius(t||this.defaultRadius),this}},{key:"type",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bubble";if(!this.TYPE.includes(t))throw Error("Only support type is one of "+this.TYPE+", while don't support "+t+" for now");return this._radius(this.defaultRadius),this}},{key:"radiusBy",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return this._radius(function(r){var o=i;switch(e&&(void 0===e?"undefined":n(e))){case"object":var s=e[r.properties[t]];o=void 0==s?i:s;break;case"function":var a=e(r.properties[t]);o=void 0==a?i:a;break;default:o=r.properties[t]||i}return o}),this}},{key:"heatBy",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return this._heat(function(r){var o=i;switch(e&&(void 0===e?"undefined":n(e))){case"object":var s=e[r.properties[t]];o=void 0==s?i:s;break;case"function":var a=e(r.properties[t]);o=void 0==a?i:a;break;default:o=r.properties[t]||i}return o}),this}},{key:"heat",value:function(t){return this._heat(t||this.defaultIntensity),this}},{key:"_heat",value:function(t){if("function"!=typeof t){var e=parseFloat(t);if(Number.isNaN(e)||0>e||e>1)throw Error("heat could only be function or number between 0 and 1, while "+t+" is not an vaild number or not in rang from 0 to 1");t=function(t){return e}}return this.operateProperty.push({type:"add",name:"_geoengine_heat",value:t}),this}},{key:"fill",value:function(t){return this.instructions.push({type:"fill",color:t}),this}},{key:"stroke",value:function(t,e){return this.instructions.push({type:"stroke",width:t,color:e}),this}},{key:"fillBy",value:function(t,e,i){return this.fill(function(r){return e[r.properties[t]]||i}),this}},{key:"strokeBy",value:function(t,e,i){return this.stroke(function(r){return e[r.properties[t]]||i}),this}},{key:"_where",value:function(t){var e=this,i=t.field,r=t.value,o=t.invert;switch(void 0===r?"undefined":n(r)){case"undefined":switch(void 0===i?"undefined":n(i)){case"string":this.where(function(t){return!!t.properties[i]},void 0,o);break;case"object":Object.keys(i).forEach(function(t){return e.where(t,i[t],o)});break;case"function":if(o){var s=i;i=function(){for(var t=arguments.length,e=Array(t),i=0;t>i;i++)e[i]=arguments[i];return!s.apply(null,e)}}this.whereConditions.push(i);break;default:throw Error("RenderInterface error in where filter if type of value is undefined the type of filed must be one of string, object and function while not "+("undefined"==typeof filed?"undefined":n(filed))+"  ")}break;case"string":case"number":this.where(function(t){return t.properties[i]===r},void 0,o);break;case"object":Array.isArray(r)&&this.where(function(t){return-1!==r.indexOf(t.properties[i])},void 0,o);break;default:throw Error("RenderInterface error in where filter with the type of filed is "+("undefined"==typeof filed?"undefined":n(filed))+" and the type of value is "+(void 0===r?"undefined":n(r))+" ")}return this}},{key:"where",value:function(t,e){return this._where({field:t,value:e,invert:arguments.length>2&&void 0!==arguments[2]&&arguments[2]})}},{key:"run",value:function(t,e,i,r){"number"==typeof this.minZoom&&this.minZoom>i.z||"number"==typeof this.maxZoom&&i.z>this.maxZoom||(this.whereConditions.forEach(function(t){return e=e.filter(t)}),this.operateProperty.forEach(function(t){var i=t.name,r=t.value;switch(t.type){case"add":case"update":e.forEach(function(t){return t.properties[i]=r(t)});break;case"remove":e.forEach(function(t){return delete t.properties[i]})}}),this.instructions.forEach(function(i){if("fill"===i.type)if("string"==typeof i.color)t.fillStyle=i.color,r(e),t.fill();else{if("function"!=typeof i.color)throw Error("fill color must be string or function, while the actual type is "+n(i.color));e.forEach(function(e){t.fillStyle=i.color(e),r(e),t.fill()})}else if("stroke"===i.type)if("number"==typeof i.width&&"string"==typeof i.color)t.lineWidth=i.width,t.strokeStyle=i.color,r(e),t.stroke();else{if("function"!=typeof i.width&&"function"!=typeof i.color)throw Error("Expected stroke(number or function, string or function) or stroke(function), got stroke("+n(i.width)+", "+n(i.color)+")");e.forEach(function(e){var n="function"==typeof i.width?i.width(e):i.width;"function"==typeof i.color&&i.color(e);void 0===i.color&&Array.isArray(n)&&(n[1],n=n[0]),r(e),t.stroke()})}}))}}]),t}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.fabric=e.resource=e.utils=e.layerDB=e.MixDatasource=e.MemoryDatasource=e.GeoEngineDatasource=e.HttpDatasource=e.Datasource=e.BaseDatasource=e.circleRangeLayer=e.circleRangeLayerV2=e.markerLayer=e.symbolLayer=e.adminDistrictLayer=e.bubbleLayer=e.scatterLayer=e.polygonLayer=e.gridHeatLayer=e.polylineLayer=e.FabricLayer=e.CanvasLayer=e.tileLayer=e.heatLayer=e.canvasTile=void 0;var n=i(18);Object.defineProperty(e,"canvasTile",{enumerable:!0,get:function(){return r(n).default}});var o=i(25);Object.defineProperty(e,"heatLayer",{enumerable:!0,get:function(){return r(o).default}});var s=i(33);Object.defineProperty(e,"tileLayer",{enumerable:!0,get:function(){return r(s).default}});var a=i(7);Object.defineProperty(e,"CanvasLayer",{enumerable:!0,get:function(){return r(a).default}});var c=i(4);Object.defineProperty(e,"FabricLayer",{enumerable:!0,get:function(){return r(c).default}});var l=i(29);Object.defineProperty(e,"polylineLayer",{enumerable:!0,get:function(){return r(l).default}});var u=i(24);Object.defineProperty(e,"gridHeatLayer",{enumerable:!0,get:function(){return r(u).default}});var h=i(28);Object.defineProperty(e,"polygonLayer",{enumerable:!0,get:function(){return r(h).default}});var f=i(31);Object.defineProperty(e,"scatterLayer",{enumerable:!0,get:function(){return r(f).default}});var d=i(17);Object.defineProperty(e,"bubbleLayer",{enumerable:!0,get:function(){return r(d).default}});var p=i(16);Object.defineProperty(e,"adminDistrictLayer",{enumerable:!0,get:function(){return r(p).default}});var g=i(32);Object.defineProperty(e,"symbolLayer",{enumerable:!0,get:function(){return r(g).default}});var v=i(27);Object.defineProperty(e,"markerLayer",{enumerable:!0,get:function(){return r(v).default}});var y=i(20);Object.defineProperty(e,"circleRangeLayerV2",{enumerable:!0,get:function(){return r(y).default}});var m=i(19);Object.defineProperty(e,"circleRangeLayer",{enumerable:!0,get:function(){return r(m).default}});var b=i(5);Object.defineProperty(e,"BaseDatasource",{enumerable:!0,get:function(){return r(b).default}});var _=i(10);Object.defineProperty(e,"Datasource",{enumerable:!0,get:function(){return r(_).default}}),Object.defineProperty(e,"HttpDatasource",{enumerable:!0,get:function(){return r(_).default}});var x=i(21);Object.defineProperty(e,"GeoEngineDatasource",{enumerable:!0,get:function(){return r(x).default}});var w=i(22);Object.defineProperty(e,"MemoryDatasource",{enumerable:!0,get:function(){return r(w).default}});var C=i(23);Object.defineProperty(e,"MixDatasource",{enumerable:!0,get:function(){return r(C).default}});var O=i(26);Object.defineProperty(e,"layerDB",{enumerable:!0,get:function(){return r(O).default}});var T=i(0);Object.defineProperty(e,"utils",{enumerable:!0,get:function(){return r(T).default}});var S=i(30);Object.defineProperty(e,"resource",{enumerable:!0,get:function(){return r(S).default}});var j=i(2);Object.defineProperty(e,"fabric",{enumerable:!0,get:function(){return j.fabric}}),i(1);e.version="3.0.3";L.geoengine=t.exports},function(t,e,i){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=document.createElement("canvas");c.width=t.width*e+o,c.height=t.height*i+s;var l=c.getContext("2d"),u=o,h=s;return a>0&&(l.translate(c.width/2,c.height/2),u=-c.width/2,h=-c.height/2,l.rotate(-a)),l.drawImage(t,r,n,t.width-r,t.height-n,u,h,t.width*e,t.height*i),c}Object.defineProperty(e,"__esModule",{value:!0}),e.createPatternCanvas=r},function(t,e,i){"use strict";function r(t,e,i,r){var n=e.source.width+i,a=e.source.width,c=[];return t.slice(1).map(function(r,s){var l=t[s],u=[l,r],h=[],f=o.default.getVector(u),d=o.default.getLen(f);if(n>a+d)return void(a+=d);var p=o.default.getRotateAngle(u,[{x:0,y:0},{x:1,y:0}]),g=o.default.getRotateDegree(u,[{x:0,y:0},{x:1,y:0}]),v=e.source.height/2*Math.sin(-p),y=-e.source.height/2*Math.cos(-p);h.degree=g,h.offsetX=l.x+v,h.offsetY=l.y+y,h.len=d;var m={x:i-a,y:0};h.push(m);for(var b=m;d-b.x-n>e.source.width;){var _={x:b.x+n,y:0};h.push(_),b=_}c.push(h),a=d-(b.x+e.source.width)}),c.map(function(t){var i=[new s.fabric.Rect({top:0,left:0,width:0,height:e.source.height,fill:"transparent",strokeWidth:0})];return i=i.concat(t.map(function(t){return new s.fabric.Rect({top:t.y,left:t.x,width:e.source.width,height:e.source.height,fill:e,strokeWidth:0})})),new s.fabric.Group(i,{top:t.offsetY,left:t.offsetX,angle:-t.degree,originX:"left",originY:"top"})})}Object.defineProperty(e,"__esModule",{value:!0}),e.createPolylineDecoratorsWithPattern=r;var n=i(12),o=function(t){return t&&t.__esModule?t:{default:t}}(n),s=i(2)},function(t,e,i){var r;!function(n){"use strict";function o(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function s(t,e){return t<<e|t>>>32-e}function a(t,e,i,r,n,a){return o(s(o(o(e,t),o(r,a)),n),i)}function c(t,e,i,r,n,o,s){return a(e&i|~e&r,t,e,n,o,s)}function l(t,e,i,r,n,o,s){return a(e&r|i&~r,t,e,n,o,s)}function u(t,e,i,r,n,o,s){return a(e^i^r,t,e,n,o,s)}function h(t,e,i,r,n,o,s){return a(i^(e|~r),t,e,n,o,s)}function f(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var i,r,n,s,a,f=1732584193,d=-271733879,p=-1732584194,g=271733878;for(i=0;t.length>i;i+=16)r=f,n=d,s=p,a=g,f=c(f,d,p,g,t[i],7,-680876936),g=c(g,f,d,p,t[i+1],12,-389564586),p=c(p,g,f,d,t[i+2],17,606105819),d=c(d,p,g,f,t[i+3],22,-1044525330),f=c(f,d,p,g,t[i+4],7,-176418897),g=c(g,f,d,p,t[i+5],12,1200080426),p=c(p,g,f,d,t[i+6],17,-1473231341),d=c(d,p,g,f,t[i+7],22,-45705983),f=c(f,d,p,g,t[i+8],7,1770035416),g=c(g,f,d,p,t[i+9],12,-1958414417),p=c(p,g,f,d,t[i+10],17,-42063),d=c(d,p,g,f,t[i+11],22,-1990404162),f=c(f,d,p,g,t[i+12],7,1804603682),g=c(g,f,d,p,t[i+13],12,-40341101),p=c(p,g,f,d,t[i+14],17,-1502002290),d=c(d,p,g,f,t[i+15],22,1236535329),f=l(f,d,p,g,t[i+1],5,-165796510),g=l(g,f,d,p,t[i+6],9,-1069501632),p=l(p,g,f,d,t[i+11],14,643717713),d=l(d,p,g,f,t[i],20,-373897302),f=l(f,d,p,g,t[i+5],5,-701558691),g=l(g,f,d,p,t[i+10],9,38016083),p=l(p,g,f,d,t[i+15],14,-660478335),d=l(d,p,g,f,t[i+4],20,-405537848),f=l(f,d,p,g,t[i+9],5,568446438),g=l(g,f,d,p,t[i+14],9,-1019803690),p=l(p,g,f,d,t[i+3],14,-187363961),d=l(d,p,g,f,t[i+8],20,1163531501),f=l(f,d,p,g,t[i+13],5,-1444681467),g=l(g,f,d,p,t[i+2],9,-51403784),p=l(p,g,f,d,t[i+7],14,1735328473),d=l(d,p,g,f,t[i+12],20,-1926607734),f=u(f,d,p,g,t[i+5],4,-378558),g=u(g,f,d,p,t[i+8],11,-2022574463),p=u(p,g,f,d,t[i+11],16,1839030562),d=u(d,p,g,f,t[i+14],23,-35309556),f=u(f,d,p,g,t[i+1],4,-1530992060),g=u(g,f,d,p,t[i+4],11,1272893353),p=u(p,g,f,d,t[i+7],16,-155497632),d=u(d,p,g,f,t[i+10],23,-1094730640),f=u(f,d,p,g,t[i+13],4,681279174),g=u(g,f,d,p,t[i],11,-358537222),p=u(p,g,f,d,t[i+3],16,-722521979),d=u(d,p,g,f,t[i+6],23,76029189),f=u(f,d,p,g,t[i+9],4,-640364487),g=u(g,f,d,p,t[i+12],11,-421815835),p=u(p,g,f,d,t[i+15],16,530742520),d=u(d,p,g,f,t[i+2],23,-995338651),f=h(f,d,p,g,t[i],6,-198630844),g=h(g,f,d,p,t[i+7],10,1126891415),p=h(p,g,f,d,t[i+14],15,-1416354905),d=h(d,p,g,f,t[i+5],21,-57434055),f=h(f,d,p,g,t[i+12],6,1700485571),g=h(g,f,d,p,t[i+3],10,-1894986606),p=h(p,g,f,d,t[i+10],15,-1051523),d=h(d,p,g,f,t[i+1],21,-2054922799),f=h(f,d,p,g,t[i+8],6,1873313359),g=h(g,f,d,p,t[i+15],10,-30611744),p=h(p,g,f,d,t[i+6],15,-1560198380),d=h(d,p,g,f,t[i+13],21,1309151649),f=h(f,d,p,g,t[i+4],6,-145523070),g=h(g,f,d,p,t[i+11],10,-1120210379),p=h(p,g,f,d,t[i+2],15,718787259),d=h(d,p,g,f,t[i+9],21,-343485551),f=o(f,r),d=o(d,n),p=o(p,s),g=o(g,a);return[f,d,p,g]}function d(t){var e,i="",r=32*t.length;for(e=0;r>e;e+=8)i+=String.fromCharCode(t[e>>5]>>>e%32&255);return i}function p(t){var e,i=[];for(i[(t.length>>2)-1]=void 0,e=0;i.length>e;e+=1)i[e]=0;var r=8*t.length;for(e=0;r>e;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i}function g(t){return d(f(p(t),8*t.length))}function v(t,e){var i,r,n=p(t),o=[],s=[];for(o[15]=s[15]=void 0,n.length>16&&(n=f(n,8*t.length)),i=0;16>i;i+=1)o[i]=909522486^n[i],s[i]=1549556828^n[i];return r=f(o.concat(p(e)),512+8*e.length),d(f(s.concat(r),640))}function y(t){var e,i,r="0123456789abcdef",n="";for(i=0;t.length>i;i+=1)e=t.charCodeAt(i),n+=r.charAt(e>>>4&15)+r.charAt(15&e);return n}function m(t){return unescape(encodeURIComponent(t))}function b(t){return g(m(t))}function _(t){return y(b(t))}function x(t,e){return v(m(t),m(e))}function w(t,e){return y(x(t,e))}function C(t,e,i){return e?i?x(e,t):w(e,t):i?b(t):_(t)}void 0!==(r=function(){return C}.call(e,i,e,t))&&(t.exports=r)}()},function(t,e,i){"use strict";function r(t,e){return Array.prototype.slice.call(t,e||0)}function n(t){return"[object Function]"===Object.prototype.toString.call(t)}function o(t){var e=[],i=t.length;return new a(function(r,n){var o=!1;t.forEach(function(t,s){t.then(function(t){if(!o)return e[s]=t,i--,0===i?r(e):void 0},function(t){o=!0,n(t)})})})}function s(t,e){var i,r=new a(function(e,r){i=r,t(e,r)});return r.cancel=function(){i(Error(e||"promise is canceled")),r.cancel=null,r.isCancel=!0,i=null},r}var a;try{a=Promise}catch(t){}var c={setPromise:function(t){a=t},promisify:function(t,e){return function(){var i=r(arguments),n=this;return new a(function(o,s){i.push(function(t){var i=r(arguments,1);return e&&!1===e.withError&&(i=[t].concat(i),t=null),t?s(t):0===i.length?o(void 0):1===i.length?o(i[0]):void o(i)}),t.apply(n,i)})}},all:function(t){return a.all?a.all(t):o(t)},parallel:function(t,e){var i=t.length;if((e=e||i)>=i)return c.all(t.map(function(t){return t()}));var r=[];return new Promise(function(i,n){function o(e,a){e().then(function(e){if(r[a]=e,t.length>s)o(t[s],s),s++;else if(r.length===t.length)return i(r)},n)}var s=0;t.slice(0,e).forEach(o),s=e})},props:function(t){var e={},i=Object.keys(t),r=i.length;return new a(function(n,o){var s=!1;i.forEach(function(i){t[i].then(function(t){if(!s)return e[i]=t,r--,0===r?n(e):void 0},function(t){s=!0,o(t)})})})},cancelable:s,sleep:function(t){return new a(function(e,i){setTimeout(e,t)})},delay:function(t,e){var i=s(function(r,n){setTimeout(function(){if(!i.isCancel)return r(Promise.resolve().then(t))},e)},"delay is canceled");return i},interval:function(t,e){var i=s(function(r,n){function o(){setTimeout(function(){if(!i.isCancel)return Promise.resolve().then(t).then(o)},e)}o()},"interval is canceled");return i},retry:function(t,e,i){return new a(function(r,o){function s(){return e()?Promise.resolve().then(t).then(r,function(t){return a=t,c.sleep(n(i)?i():i).then(s)}):(a.isRetryFailed=!0,o(a))}var a=Error("retry failed");return s()})}};t.exports=c},function(t,e,i){"use strict";function r(t){if(!(this instanceof r))return new r(t);this._canvas=t="string"==typeof t?document.getElementById(t):t,this._ctx=t.getContext("2d"),this._width=t.width,this._height=t.height,this._max=1,this._data=[]}t.exports=r,r.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(t){return this._data=t,this},max:function(t){return this._max=t,this},add:function(t){return this._data.push(t),this},clear:function(){return this._data=[],this},radius:function(t,e){e=void 0===e?15:e;var i=this._circle=document.createElement("canvas"),r=i.getContext("2d"),n=this._r=t+e;return i.width=i.height=2*n,r.shadowOffsetX=r.shadowOffsetY=2*n,r.shadowBlur=e,r.shadowColor="black",r.beginPath(),r.arc(-n,-n,t,0,2*Math.PI,!0),r.closePath(),r.fill(),this},resize:function(){this._width=this._canvas.width,this._height=this._canvas.height},gradient:function(t){var e=document.createElement("canvas"),i=e.getContext("2d"),r=i.createLinearGradient(0,0,0,256);e.width=1,e.height=256;for(var n in t)r.addColorStop(n,t[n]);return i.fillStyle=r,i.fillRect(0,0,1,256),this._grad=i.getImageData(0,0,1,256).data,this},draw:function(t){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var e=this._ctx;e.clearRect(0,0,this._width,this._height);for(var i,r=0,n=this._data.length;n>r;r++)i=this._data[r],e.globalAlpha=Math.max(i[2]/this._max,void 0===t?.05:t),e.drawImage(this._circle,i[0]-this._r,i[1]-this._r);var o=e.getImageData(0,0,this._width,this._height);return this._colorize(o.data,this._grad),e.putImageData(o,0,0),this},_colorize:function(t,e){for(var i,r=0,n=t.length;n>r;r+=4)(i=4*t[r+3])&&(t[r]=e[i],t[r+1]=e[i+1],t[r+2]=e[i+2])}}},function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjAiIHdpZHRoPSIyMCIgdmVyc2lvbj0iMSI+CiAgPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBwb2ludHM9IgoJMCwwIDE1LDEwIDAsMjAiLz4KPC9zdmc+Cgo="},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_45__}])});