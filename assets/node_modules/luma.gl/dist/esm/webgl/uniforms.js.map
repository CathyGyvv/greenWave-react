{"version":3,"sources":["../../../src/webgl/uniforms.js"],"names":["Framebuffer","Texture","Sampler","formatValue","log","assert","GL_FLOAT","GL_FLOAT_VEC2","GL_FLOAT_VEC3","GL_FLOAT_VEC4","GL_INT","GL_INT_VEC2","GL_INT_VEC3","GL_INT_VEC4","GL_BOOL","GL_BOOL_VEC2","GL_BOOL_VEC3","GL_BOOL_VEC4","GL_FLOAT_MAT2","GL_FLOAT_MAT3","GL_FLOAT_MAT4","GL_SAMPLER_2D","GL_SAMPLER_CUBE","GL_UNSIGNED_INT","GL_UNSIGNED_INT_VEC2","GL_UNSIGNED_INT_VEC3","GL_UNSIGNED_INT_VEC4","GL_FLOAT_MAT2x3","GL_FLOAT_MAT2x4","GL_FLOAT_MAT3x2","GL_FLOAT_MAT3x4","GL_FLOAT_MAT4x2","GL_FLOAT_MAT4x3","GL_SAMPLER_3D","GL_SAMPLER_2D_SHADOW","GL_SAMPLER_2D_ARRAY","GL_SAMPLER_2D_ARRAY_SHADOW","GL_SAMPLER_CUBE_SHADOW","GL_INT_SAMPLER_2D","GL_INT_SAMPLER_3D","GL_INT_SAMPLER_CUBE","GL_INT_SAMPLER_2D_ARRAY","GL_UNSIGNED_INT_SAMPLER_2D","GL_UNSIGNED_INT_SAMPLER_3D","GL_UNSIGNED_INT_SAMPLER_CUBE","GL_UNSIGNED_INT_SAMPLER_2D_ARRAY","UNIFORM_SETTERS","gl","location","value","uniform1f","uniform2fv","toFloatArray","uniform3fv","uniform4fv","uniform1i","uniform2iv","toIntArray","uniform3iv","uniform4iv","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","uniform1ui","uniform2uiv","toUIntArray","uniform3uiv","uniform4uiv","uniformMatrix2x3fv","uniformMatrix2x4fv","uniformMatrix3x2fv","uniformMatrix3x4fv","uniformMatrix4x2fv","uniformMatrix4x3fv","FLOAT_ARRAY","INT_ARRAY","UINT_ARRAY","toTypedArray","uniformLength","Type","cache","length","warn","result","i","Float32Array","Int32Array","Uint32Array","parseUniformName","name","UNIFORM_NAME_REGEXP","matches","match","Error","isArray","Boolean","getUniformSetter","info","setter","type","bind","checkUniformValues","uniforms","source","uniformName","checkUniformValue","console","error","Array","ArrayBuffer","isView","checkUniformArray","isFinite","texture","checkLength","Math","min","Number","areUniformsEqual","uniform1","uniform2","len","getUniformsTable","header","program","undefinedOnly","SHADER_MODULE_UNIFORM_REGEXP","PROJECT_MODULE_UNIFORM_REGEXP","uniformLocations","_uniformSetters","table","uniformNames","Object","keys","sort","count","addUniformToTable","unusedCount","unusedTable","uniform","isDefined","isUniformDefined","undefined"],"mappings":"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","sourcesContent":["import Framebuffer from './framebuffer';\nimport Texture from './texture';\nimport Sampler from './sampler';\nimport {formatValue, log} from '../utils';\nimport assert from '../utils/assert';\n\n// Local constants, will be \"collapsed\" during minification\n\n// WebGL1\n\nconst GL_FLOAT = 0x1406;\nconst GL_FLOAT_VEC2 = 0x8B50;\nconst GL_FLOAT_VEC3 = 0x8B51;\nconst GL_FLOAT_VEC4 = 0x8B52;\n\nconst GL_INT = 0x1404;\nconst GL_INT_VEC2 = 0x8B53;\nconst GL_INT_VEC3 = 0x8B54;\nconst GL_INT_VEC4 = 0x8B55;\n\nconst GL_BOOL = 0x8B56;\nconst GL_BOOL_VEC2 = 0x8B57;\nconst GL_BOOL_VEC3 = 0x8B58;\nconst GL_BOOL_VEC4 = 0x8B59;\n\nconst GL_FLOAT_MAT2 = 0x8B5A;\nconst GL_FLOAT_MAT3 = 0x8B5B;\nconst GL_FLOAT_MAT4 = 0x8B5C;\n\nconst GL_SAMPLER_2D = 0x8B5E;\nconst GL_SAMPLER_CUBE = 0x8B60;\n\n// WebGL2\n\nconst GL_UNSIGNED_INT = 0x1405;\nconst GL_UNSIGNED_INT_VEC2 = 0x8DC6;\nconst GL_UNSIGNED_INT_VEC3 = 0x8DC7;\nconst GL_UNSIGNED_INT_VEC4 = 0x8DC8;\n\n/* eslint-disable camelcase */\nconst GL_FLOAT_MAT2x3 = 0x8B65;\nconst GL_FLOAT_MAT2x4 = 0x8B66;\nconst GL_FLOAT_MAT3x2 = 0x8B67;\nconst GL_FLOAT_MAT3x4 = 0x8B68;\nconst GL_FLOAT_MAT4x2 = 0x8B69;\nconst GL_FLOAT_MAT4x3 = 0x8B6A;\n\nconst GL_SAMPLER_3D = 0x8B5F;\nconst GL_SAMPLER_2D_SHADOW = 0x8B62;\nconst GL_SAMPLER_2D_ARRAY = 0x8DC1;\nconst GL_SAMPLER_2D_ARRAY_SHADOW = 0x8DC4;\nconst GL_SAMPLER_CUBE_SHADOW = 0x8DC5;\nconst GL_INT_SAMPLER_2D = 0x8DCA;\nconst GL_INT_SAMPLER_3D = 0x8DCB;\nconst GL_INT_SAMPLER_CUBE = 0x8DCC;\nconst GL_INT_SAMPLER_2D_ARRAY = 0x8DCF;\nconst GL_UNSIGNED_INT_SAMPLER_2D = 0x8DD2;\nconst GL_UNSIGNED_INT_SAMPLER_3D = 0x8DD3;\nconst GL_UNSIGNED_INT_SAMPLER_CUBE = 0x8DD4;\nconst GL_UNSIGNED_INT_SAMPLER_2D_ARRAY = 0x8DD7;\n\nconst UNIFORM_SETTERS = {\n\n  // WEBGL1\n\n  /* eslint-disable max-len */\n  [GL_FLOAT]: (gl, location, value) => gl.uniform1f(location, value),\n  [GL_FLOAT_VEC2]: (gl, location, value) => gl.uniform2fv(location, toFloatArray(value, 2)),\n  [GL_FLOAT_VEC3]: (gl, location, value) => gl.uniform3fv(location, toFloatArray(value, 3)),\n  [GL_FLOAT_VEC4]: (gl, location, value) => gl.uniform4fv(location, toFloatArray(value, 4)),\n\n  [GL_INT]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_INT_VEC2]: (gl, location, value) => gl.uniform2iv(location, toIntArray(value, 2)),\n  [GL_INT_VEC3]: (gl, location, value) => gl.uniform3iv(location, toIntArray(value, 3)),\n  [GL_INT_VEC4]: (gl, location, value) => gl.uniform4iv(location, toIntArray(value, 4)),\n\n  [GL_BOOL]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_BOOL_VEC2]: (gl, location, value) => gl.uniform2iv(location, toIntArray(value, 2)),\n  [GL_BOOL_VEC3]: (gl, location, value) => gl.uniform3iv(location, toIntArray(value, 3)),\n  [GL_BOOL_VEC4]: (gl, location, value) => gl.uniform4iv(location, toIntArray(value, 4)),\n\n  // uniformMatrix(false): don't transpose the matrix\n  [GL_FLOAT_MAT2]: (gl, location, value) => gl.uniformMatrix2fv(location, false, toFloatArray(value, 4)),\n  [GL_FLOAT_MAT3]: (gl, location, value) => gl.uniformMatrix3fv(location, false, toFloatArray(value, 9)),\n  [GL_FLOAT_MAT4]: (gl, location, value) => gl.uniformMatrix4fv(location, false, toFloatArray(value, 16)),\n\n  [GL_SAMPLER_2D]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_SAMPLER_CUBE]: (gl, location, value) => gl.uniform1i(location, value),\n\n  // WEBGL2 - unsigned integers, irregular matrices, additional texture samplers\n\n  [GL_UNSIGNED_INT]: (gl, location, value) => gl.uniform1ui(location, value),\n  [GL_UNSIGNED_INT_VEC2]: (gl, location, value) => gl.uniform2uiv(location, toUIntArray(value, 2)),\n  [GL_UNSIGNED_INT_VEC3]: (gl, location, value) => gl.uniform3uiv(location, toUIntArray(value, 3)),\n  [GL_UNSIGNED_INT_VEC4]: (gl, location, value) => gl.uniform4uiv(location, toUIntArray(value, 4)),\n\n  // uniformMatrix(false): don't transpose the matrix\n  [GL_FLOAT_MAT2x3]: (gl, location, value) => gl.uniformMatrix2x3fv(location, false, toFloatArray(value, 6)),\n  [GL_FLOAT_MAT2x4]: (gl, location, value) => gl.uniformMatrix2x4fv(location, false, toFloatArray(value, 8)),\n  [GL_FLOAT_MAT3x2]: (gl, location, value) => gl.uniformMatrix3x2fv(location, false, toFloatArray(value, 6)),\n  [GL_FLOAT_MAT3x4]: (gl, location, value) => gl.uniformMatrix3x4fv(location, false, toFloatArray(value, 12)),\n  [GL_FLOAT_MAT4x2]: (gl, location, value) => gl.uniformMatrix4x2fv(location, false, toFloatArray(value, 8)),\n  [GL_FLOAT_MAT4x3]: (gl, location, value) => gl.uniformMatrix4x3fv(location, false, toFloatArray(value, 12)),\n\n  [GL_SAMPLER_3D]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_SAMPLER_2D_SHADOW]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_SAMPLER_2D_ARRAY]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_SAMPLER_2D_ARRAY_SHADOW]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_SAMPLER_CUBE_SHADOW]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_INT_SAMPLER_2D]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_INT_SAMPLER_3D]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_INT_SAMPLER_CUBE]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_INT_SAMPLER_2D_ARRAY]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_UNSIGNED_INT_SAMPLER_2D]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_UNSIGNED_INT_SAMPLER_3D]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_UNSIGNED_INT_SAMPLER_CUBE]: (gl, location, value) => gl.uniform1i(location, value),\n  [GL_UNSIGNED_INT_SAMPLER_2D_ARRAY]: (gl, location, value) => gl.uniform1i(location, value)\n  /* eslint-enable max-len */\n};\n\n// Pre-allocated typed arrays for temporary conversion\nconst FLOAT_ARRAY = {};\nconst INT_ARRAY = {};\nconst UINT_ARRAY = {};\n\n/* Functions to ensure the type of uniform values */\nfunction toTypedArray(value, uniformLength, Type, cache) {\n  const length = value.length;\n  if (length % uniformLength) {\n    log.warn(`Uniform size should be multiples of ${uniformLength}`, value)();\n  }\n\n  if (value instanceof Type) {\n    return value;\n  }\n  let result = cache[length];\n  if (!result) {\n    result = new Type(length);\n    cache[length] = result;\n  }\n  for (let i = 0; i < length; i++) {\n    result[i] = value[i];\n  }\n  return result;\n}\n\nfunction toFloatArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Float32Array, FLOAT_ARRAY);\n}\n\nfunction toIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Int32Array, INT_ARRAY);\n}\n\nfunction toUIntArray(value, uniformLength) {\n  return toTypedArray(value, uniformLength, Uint32Array, UINT_ARRAY);\n}\n\nexport function parseUniformName(name) {\n  // name = name[name.length - 1] === ']' ?\n  // name.substr(0, name.length - 3) : name;\n\n  // if array name then clean the array brackets\n  const UNIFORM_NAME_REGEXP = /([^\\[]*)(\\[[0-9]+\\])?/;\n  const matches = name.match(UNIFORM_NAME_REGEXP);\n  if (!matches || matches.length < 2) {\n    throw new Error(`Failed to parse GLSL uniform name ${name}`);\n  }\n\n  return {\n    name: matches[1],\n    length: matches[2] || 1,\n    isArray: Boolean(matches[2])\n  };\n}\n\n// Returns a Magic Uniform Setter\n/* eslint-disable complexity */\nexport function getUniformSetter(gl, location, info) {\n  const setter = UNIFORM_SETTERS[info.type];\n  if (!setter) {\n    throw new Error(`Unknown GLSL uniform type ${info.type}`);\n  }\n  return setter.bind(null, gl, location);\n}\n\n// Basic checks of uniform values without knowledge of program\n// To facilitate early detection of e.g. undefined values in JavaScript\nexport function checkUniformValues(uniforms, source) {\n  for (const uniformName in uniforms) {\n    const value = uniforms[uniformName];\n    if (!checkUniformValue(value)) {\n      // Add space to source\n      source = source ? `${source} ` : '';\n      // Value could be unprintable so write the object on console\n      console.error(`${source} Bad uniform ${uniformName}`, value); // eslint-disable-line\n      /* eslint-enable no-console */\n      throw new Error(`${source} Bad uniform ${uniformName}`);\n    }\n  }\n  return true;\n}\n\n// TODO use type information during validation\nfunction checkUniformValue(value) {\n  if (Array.isArray(value) || ArrayBuffer.isView(value)) {\n    return checkUniformArray(value);\n  }\n\n  // Check if single value is a number\n  if (isFinite(value)) {\n    return true;\n  } else if (value === true || value === false) {\n    return true;\n  } else if (value instanceof Texture || value instanceof Sampler) {\n    return true;\n  } else if (value instanceof Framebuffer) {\n    return Boolean(value.texture);\n  }\n  return false;\n}\n\nfunction checkUniformArray(value) {\n  // Check that every element in array is a number, and at least 1 element\n  if (value.length === 0) {\n    return false;\n  }\n\n  const checkLength = Math.min(value.length, 16);\n\n  for (let i = 0; i < checkLength; ++i) {\n    if (!Number.isFinite(value[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Given two values of a uniform, returns `true` if they are equal\n */\nexport function areUniformsEqual(uniform1, uniform2) {\n  if (Array.isArray(uniform1) || ArrayBuffer.isView(uniform1)) {\n    if (!uniform2) {\n      return false;\n    }\n    const len = uniform1.length;\n    if (uniform2.length !== len) {\n      return false;\n    }\n    for (let i = 0; i < len; i++) {\n      if (uniform1[i] !== uniform2[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return uniform1 === uniform2;\n}\n\n// Prepares a table suitable for console.table\n/* eslint-disable max-statements */\nexport function getUniformsTable({\n  header = 'Uniforms',\n  program,\n  uniforms,\n  undefinedOnly = false\n} = {}) {\n  assert(program);\n\n  const SHADER_MODULE_UNIFORM_REGEXP = '.*_.*';\n  const PROJECT_MODULE_UNIFORM_REGEXP = '.*Matrix'; // TODO - Use explicit list\n\n  const uniformLocations = program._uniformSetters;\n  const table = {}; // {[header]: {}};\n\n  // Add program's provided uniforms (in alphabetical order)\n  const uniformNames = Object.keys(uniformLocations).sort();\n\n  let count = 0;\n\n  // First add non-underscored uniforms (assumed not coming from shader modules)\n  for (const uniformName of uniformNames) {\n    if (!uniformName.match(SHADER_MODULE_UNIFORM_REGEXP) &&\n      !uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({table, header, uniforms, uniformName, undefinedOnly})) {\n        count++;\n      }\n    }\n  }\n\n  // add underscored uniforms (assumed from shader modules)\n  for (const uniformName of uniformNames) {\n    if (uniformName.match(PROJECT_MODULE_UNIFORM_REGEXP)) {\n      if (addUniformToTable({table, header, uniforms, uniformName, undefinedOnly})) {\n        count++;\n      }\n    }\n  }\n\n  for (const uniformName of uniformNames) {\n    if (!table[uniformName]) {\n      if (addUniformToTable({table, header, uniforms, uniformName, undefinedOnly})) {\n        count++;\n      }\n    }\n  }\n\n  // Create a table of unused uniforms\n  let unusedCount = 0;\n  const unusedTable = {};\n  if (!undefinedOnly) {\n    for (const uniformName in uniforms) {\n      const uniform = uniforms[uniformName];\n      if (!table[uniformName]) {\n        unusedCount++;\n        unusedTable[uniformName] = {\n          Type: `NOT USED: ${uniform}`,\n          [header]: formatValue(uniform)\n        };\n      }\n    }\n  }\n\n  return {table, count, unusedTable, unusedCount};\n}\n\n// Helper\nfunction addUniformToTable({table, header, uniforms, uniformName, undefinedOnly}) {\n  const value = uniforms[uniformName];\n  const isDefined = isUniformDefined(value);\n  if (!undefinedOnly || !isDefined) {\n    table[uniformName] = {\n      // Add program's unprovided uniforms\n      [header]: isDefined ? formatValue(value) : 'N/A',\n      'Uniform Type': isDefined ? value : 'NOT PROVIDED'\n    };\n    return true;\n  }\n  return false;\n}\n\nfunction isUniformDefined(value) {\n  return value !== undefined && value !== null;\n}\n"],"file":"uniforms.js"}