{"version":3,"sources":["../../../../../../src/shadertools/modules/fp64/test-deprecated/fp64-shader.spec.js"],"names":["BUFFER_DATA","Float32Array","glEnumToString","gl","value","NO_ERROR","p","toString","addSpan","contents","div","undefined","divs","document","body","getElementsByClassName","lastDiv","length","span","createElement","appendChild","innerHTML","addDiv","testInfoDiv","setAttribute","logToConsole","msg","window","console","log","escapeHTML","text","replace","testPassed","testFailed","glErrorShouldBe","glErrors","opt_msg","err","getError","ndx","indexOf","errStrs","ii","push","expected","join","fp64ify","a","a_hi","Math","fround","a_lo","getFloat64","upper","random","pow","getVec4Float64","getMat4Float64","result","i","initializeGL","canvas","viewport","width","height","clearColor","clearDepth","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","initializeTexTarget","framebuffer","createFramebuffer","bindFramebuffer","FRAMEBUFFER","tex","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","texImage2D","RGBA32F","RGBA","FLOAT","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","render","drawArrays","TRIANGLE_STRIP","getGPUOutput","buf","readPixels","checkError","reference","currentDiv","line","referece64","result64","abs","test_float_add","testName","float0","float1","float_ref","float0_vec2","float1_vec2","float_ref_vec2","program","Program","vs","require","fs","modules","use","setBuffers","positions","Buffer","target","ARRAY_BUFFER","data","size","setUniforms","b","ONE","test_float_sub","test_float_mul","test_float_div","test_float_sqrt","sqrt","test_float_exp","exp","test_float_log","test_float_sin","sin","test_float_cos","cos","test_float_tan","tan","test_float_radians","PI","onload","fp64","idx0","test_no","loop","cpu_result","gpu_result"],"mappings":"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","sourcesContent":["// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n// TODO - need to clean up this code to follow lint rules, disable for now\n/* eslint-disable */\n\nimport 'babel-polyfill';\n\nimport {document, window} from 'global';\nimport {Buffer, createGLContext, Program, setParameters, assembleShaders, registerShaderModules, fp64} from 'luma.gl';\n\nconst BUFFER_DATA = new Float32Array([1, 1, -1, 1, 1, -1, -1, -1]);\n\n// Utilities functions that to be moved to a common place for future tests\n\nfunction glEnumToString(gl, value) {\n  // Optimization for the most common enum:\n  if (value === gl.NO_ERROR) {\n    return \"NO_ERROR\";\n  }\n  for (var p in gl) {\n    if (gl[p] == value) {\n      return p;\n    }\n  }\n  return \"0x\" + value.toString(16);\n};\n\nfunction addSpan(contents, div) {\n  if (div == undefined) {\n    var divs = document.body.getElementsByClassName(\"testInfo\");\n    var lastDiv = divs[divs.length - 1];\n    div = lastDiv;\n  }\n\n  var span = document.createElement(\"span\");\n  div.appendChild(span);\n  span.innerHTML = contents + '<br />';\n}\n\nfunction addDiv(contents) {\n  var testInfoDiv = document.createElement(\"div\");\n  document.body.appendChild(testInfoDiv);\n  testInfoDiv.setAttribute(\"class\", \"testInfo\");\n\n  return testInfoDiv;\n}\n\nfunction logToConsole(msg) {\n  if (window.console)\n    window.console.log(msg);\n}\n\nfunction escapeHTML(text) {\n  return text.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\");\n}\n\nfunction testPassed(msg) {\n  addSpan('<span><span class=\"pass\" style=\"color:green\">PASS</span> ' + escapeHTML(msg) + '</span>');\n  logToConsole('PASS ' + msg);\n}\n\nfunction testFailed(msg) {\n  addSpan('<span><span class=\"fail\" style=\"color:red\">FAIL</span> ' + escapeHTML(msg) + '</span>');\n  logToConsole('FAIL ' + msg);\n}\n\nfunction glErrorShouldBe(gl, glErrors, opt_msg) {\n  if (!glErrors.length) {\n    glErrors = [glErrors];\n  }\n  opt_msg = opt_msg || \"\";\n  var err = gl.getError();\n  var ndx = glErrors.indexOf(err);\n  var errStrs = [];\n  for (var ii = 0; ii < glErrors.length; ++ii) {\n    errStrs.push(glEnumToString(gl, glErrors[ii]));\n  }\n  var expected = errStrs.join(\" or \");\n  if (ndx < 0) {\n    var msg = \"getError expected\" + ((glErrors.length > 1) ? \" one of: \" : \": \");\n    testFailed(msg + expected +  \". Was \" + glEnumToString(gl, err) + \" : \" + opt_msg);\n  } else {\n    //var msg = \"getError was \" + ((glErrors.length > 1) ? \"one of: \" : \"expected value: \");\n    //testPassed(msg + expected + \" : \" + opt_msg);\n  }\n};\n\n// Special utility functions for df64 tests\n\nfunction fp64ify(a) {\n  const a_hi = Math.fround(a);\n  const a_lo = a - Math.fround(a);\n  return new Float32Array([a_hi, a_lo]);\n}\n\nfunction getFloat64(upper = 256) {\n  return Math.random() * Math.pow(2.0, (Math.random() - 0.5) * upper);\n}\n\nfunction getVec4Float64() {\n  return [getFloat64(), getFloat64(), getFloat64(), getFloat64()]\n}\n\nfunction getMat4Float64() {\n  var result = [];\n  for (var i = 0; i < 16; i++)\n  {\n    result.push(getFloat64());\n  }\n  return result;\n}\n\nfunction initializeGL(canvas)\n{\n  const gl = createGLContext(canvas);\n  setParameters(gl, {\n    viewport: [0, 0, canvas.width, canvas.height],\n    clearColor: [0, 0, 0, 1],\n    clearDepth: 1\n  });\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n\n  // var fp_texture_support = gl.getExtension('OES_texture_float');\n  // if (!fp_texture_support)\n  // {\n  //   console.error(\"no floating point texture support!\");\n  // }\n  return gl;\n}\n\nfunction initializeTexTarget(gl)\n{\n  var framebuffer = gl.createFramebuffer();\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n  framebuffer.width = 10;\n  framebuffer.height = 10;\n\n  var tex = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, tex);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA32F, framebuffer.width, framebuffer.height, 0, gl.RGBA, gl.FLOAT, null);\n\n  var renderbuffer = gl.createRenderbuffer();\n  gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n  gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, framebuffer.width, framebuffer.height);\n  gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, tex, 0);\n  gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer);\n\n}\n\nfunction render(gl)\n{\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n  glErrorShouldBe(gl, gl.NO_ERROR, \"no error from draw\");\n}\n\nfunction getGPUOutput(gl)\n{\n\n  var width = gl.canvas.width;\n  var height = gl.canvas.height;\n  var buf = new Float32Array(width * height * 4);\n\n  gl.readPixels(0, 0, width, height, gl.RGBA, gl.FLOAT, buf);\n\n  return buf;\n}\n\nfunction checkError(result, reference)\n{\n  var currentDiv = addDiv();\n  var line;\n  addSpan(\"------------------------\", currentDiv);\n\n  let referece64 = reference[0] + reference[1];\n  let result64 = result[0] + result[1];\n\n  line = 'CPU output: (' + reference[0].toString() + ',' + reference[1].toString() + ') = ' + referece64.toString() + '<br>';\n  addSpan(line, currentDiv);\n  line = \"GPU output: (\" + result[0].toString() + ',' + result[1].toString() + ',' + result[2].toString() + ',' + result[3].toString() + ') = ' + result64.toString() + '<br>';\n  addSpan(line, currentDiv);\n\n  line = \"error: \" + Math.abs((referece64 - result64) / referece64) + '<br>';\n  addSpan(line, currentDiv);\n\n\n  // var referenceBits = new Int32Array(reference.buffer);\n  // var resultBits = new Int32Array(result.buffer);\n\n  // var refHiExp = (referenceBits[0] & 0x7F800000) >>> 23;\n  // var refLoExp = (referenceBits[1] & 0x7F800000) >>> 23;\n  // var resHiExp = (resultBits[0] & 0x7F800000) >>> 23;\n  // var resLoExp = (resultBits[1] & 0x7F800000) >>> 23;\n\n  // var refHiMan = referenceBits[0] & 0x007FFFFF;\n  // var refLoMan = referenceBits[1] & 0x007FFFFF;\n  // var resHiMan = resultBits[0] & 0x007FFFFF;\n  // var resLoMan = resultBits[1] & 0x007FFFFF;\n\n  // if (refHiExp !== resHiExp || refLoExp !== resLoExp)\n  // {\n  //   line = \"High 8-bit exponent error: \" + Math.abs(refHiExp - resHiExp).toString() + \" ulp<br>\";\n  //   addSpan(line, currentDiv);\n  //   line = \"Low 8-bit exponent error: \" + Math.abs(refLoExp - resLoExp).toString() + \" ulp<br>\";\n  //   addSpan(line, currentDiv);\n  // }\n\n  // line = \"High 24-bit mantissa reference: \" + refHiMan.toString(2) + \" result: \" + resHiMan.toString(2) + \" error: \" + Math.abs(refHiMan - resHiMan).toString() + \" ulp<br>\";\n  // addSpan(line, currentDiv);\n  // line = \"Low 24-bit mantissa reference: \" + refLoMan.toString(2) + \" result: \" + resLoMan.toString(2) + \" error: \" + Math.abs(refLoMan - resLoMan).toString() + \" ulp<br>\";\n  // addSpan(line, currentDiv);\n}\n\n// Actual tests for different arithmetic functions\n\nfunction test_float_add(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float +\n  const float0 = getFloat64();\n  const float1 = getFloat64();\n  const float_ref = float0 + float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_add.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }\n    ));\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') + (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_sub(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float -\n  const float0 = getFloat64();\n  const float1 = getFloat64();\n  const float_ref = float0 - float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n      vs: require('./vs_float_sub.glsl'),\n      fs: require('./fs.glsl'),\n      modules: ['fp64']\n    }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') - (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_mul(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float x\n  const float0 = getFloat64(128);\n  const float1 = getFloat64(128);\n\n  const float_ref = float0 * float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n    vs: require('./vs_float_mul.glsl'),\n    fs: require('./fs.glsl'),\n    modules: ['fp64']\n  }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') * (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_div(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // float /\n  const float0 = getFloat64(128);\n  const float1 = getFloat64(128);\n  const float_ref = float0 / float1;\n\n  const float0_vec2 = fp64ify(float0);\n  const float1_vec2 = fp64ify(float1);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n    vs: require('./vs_float_div.glsl'),\n    fs: require('./fs.glsl'),\n    modules: ['fp64']\n  }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    b: float1_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"(\" + float0_vec2.toString() + ') / (' + float1_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_sqrt(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // sqrt\n  const float0 = getFloat64(128);\n  const float_ref = Math.sqrt(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_sqrt.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"sqrt(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_exp(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // exp\n  const float0 = getFloat64(6);\n  const float_ref = Math.exp(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_exp.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"exp(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_log(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // log\n  const float0 = getFloat64(24);\n  const float_ref = Math.log(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_log.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"log(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\n\nfunction test_float_sin(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // sin\n  const float0 = getFloat64(8);\n  const float_ref = Math.sin(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_sin.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"sin(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_cos(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // cos\n  const float0 = getFloat64(8);\n  const float_ref = Math.cos(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_cos.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"cos(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_tan(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // tan\n  const float0 = getFloat64(8);\n  const float_ref = Math.tan(float0);\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_tan.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"tan(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\nfunction test_float_radians(gl, testName) {\n  var currentDiv = addDiv();\n  addSpan(testName, currentDiv);\n\n // radians\n  const float0 = getFloat64(16);\n  const float_ref = float0 * Math.PI / 180.0;\n\n  const float0_vec2 = fp64ify(float0);\n  const float_ref_vec2 = fp64ify(float_ref);\n\n  const program = new Program(gl, assembleShaders(gl, {\n        vs: require('./vs_float_radians.glsl'),\n        fs: require('./fs.glsl'),\n        modules: ['fp64']\n      }));\n\n  program.use();\n  program.setBuffers({\n    positions: new Buffer(gl, {target: gl.ARRAY_BUFFER, data: BUFFER_DATA, size: 2})\n  }).setUniforms({\n    a: float0_vec2,\n    ONE: 1.0\n  });\n\n  var line;\n  line = \"tan(\" + float0_vec2.toString() + ')<br>';\n  addSpan(line, currentDiv);\n  return float_ref_vec2;\n}\n\n// Main entrance\nwindow.onload = () => {\n  const canvas = document.createElement('canvas');\n  document.body.appendChild(canvas);\n\n  canvas.width = 16;\n  canvas.height = 16;\n\n  // Initialize GL\n\n  var gl = initializeGL(canvas);\n  initializeTexTarget(gl);\n\n\n  registerShaderModules([fp64]);\n\n  var idx0;\n  var test_no = 0;\n  const loop = 100;\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_add(gl, \"Float addition test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_sub(gl, \"Float subtraction test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_mul(gl, \"Float multiplication test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_div(gl, \"Float division test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_sqrt(gl, \"Float sqrt test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_exp(gl, \"Float exp test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_log(gl, \"Float log test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_sin(gl, \"Float sin test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n   }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n    var cpu_result = test_float_cos(gl, \"Float cos test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n\n\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n\n    var cpu_result = test_float_tan(gl, \"Float tan test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n\n  for (idx0 = 0; idx0 < loop; idx0++) {\n    var currentDiv = addDiv();\n    addSpan(\"------------------------\", currentDiv);\n    addSpan(\"Loop No. \" + test_no++, currentDiv);\n\n\n    var cpu_result = test_float_radians(gl, \"Float radians test\");\n\n    render(gl);\n\n    var gpu_result = getGPUOutput(gl);\n\n    checkError(gpu_result, cpu_result);\n\n    addSpan(\"------------------------\", currentDiv);\n  }\n}\n"],"file":"fp64-shader.spec.js"}