{"version":3,"sources":["../../../src/webgl-context/polyfill-get-parameter.js"],"names":["OES_element_index","WEBGL_draw_buffers","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","WEBGL_debug_renderer_info","GL_FRAGMENT_SHADER_DERIVATIVE_HINT","GL_DONT_CARE","GL_GPU_DISJOINT_EXT","GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT","GL_UNMASKED_VENDOR_WEBGL","GL_UNMASKED_RENDERER_WEBGL","getWebGL2ValueOrZero","isWebGL2","gl","undefined","WEBGL_PARAMETERS","GL","READ_BUFFER","COLOR_ATTACHMENT0","RASTERIZER_DISCARD","SAMPLES","getParameter","ext","getExtension","GPU_DISJOINT_EXT","UNMASKED_VENDOR_WEBGL","VENDOR","UNMASKED_RENDERER_WEBGL","RENDERER","luma","extensions","MAX_TEXTURE_MAX_ANISOTROPY_EXT","MAX_3D_TEXTURE_SIZE","MAX_ARRAY_TEXTURE_LAYERS","MAX_CLIENT_WAIT_TIMEOUT_WEBGL","MAX_COLOR_ATTACHMENTS","MAX_COLOR_ATTACHMENTS_WEBGL","MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS","MAX_COMBINED_UNIFORM_BLOCKS","MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS","MAX_DRAW_BUFFERS","MAX_DRAW_BUFFERS_WEBGL","MAX_ELEMENT_INDEX","MAX_ELEMENTS_INDICES","MAX_ELEMENTS_VERTICES","MAX_FRAGMENT_INPUT_COMPONENTS","MAX_FRAGMENT_UNIFORM_BLOCKS","MAX_FRAGMENT_UNIFORM_COMPONENTS","MAX_SAMPLES","MAX_SERVER_WAIT_TIMEOUT","MAX_TEXTURE_LOD_BIAS","MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS","MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS","MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS","MAX_UNIFORM_BLOCK_SIZE","MAX_UNIFORM_BUFFER_BINDINGS","MAX_VARYING_COMPONENTS","MAX_VERTEX_OUTPUT_COMPONENTS","MAX_VERTEX_UNIFORM_BLOCKS","MAX_VERTEX_UNIFORM_COMPONENTS","MIN_PROGRAM_TEXEL_OFFSET","MAX_PROGRAM_TEXEL_OFFSET","UNIFORM_BUFFER_OFFSET_ALIGNMENT","GL_TEXTURE_BINDING_3D","TEXTURE_BINDING_3D","getParameterPolyfill","originalGetParameter","pname","limit","value","result"],"mappings":"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","sourcesContent":["/* eslint-disable no-inline-comments, max-len, camelcase */\nimport GL from '../constants';\n\nconst OES_element_index = 'OES_element_index';\nconst WEBGL_draw_buffers = 'WEBGL_draw_buffers';\nconst EXT_disjoint_timer_query = 'EXT_disjoint_timer_query';\nconst EXT_disjoint_timer_query_webgl2 = 'EXT_disjoint_timer_query_webgl2';\nconst EXT_texture_filter_anisotropic = 'EXT_texture_filter_anisotropic';\nconst WEBGL_debug_renderer_info = 'WEBGL_debug_renderer_info';\n\nconst GL_FRAGMENT_SHADER_DERIVATIVE_HINT = 0x8B8B;\nconst GL_DONT_CARE = 0x1100;\nconst GL_GPU_DISJOINT_EXT = 0x8FBB;\nconst GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84FF;\nconst GL_UNMASKED_VENDOR_WEBGL = 0x9245; // vendor string of the graphics driver.\nconst GL_UNMASKED_RENDERER_WEBGL = 0x9246; // renderer string of the graphics driver.\n\nconst getWebGL2ValueOrZero = gl => !isWebGL2(gl) ? 0 : undefined;\n\n// if a function returns undefined in this table,\n// the original getParameter will be called, defeating the override\nconst WEBGL_PARAMETERS = {\n  [GL.READ_BUFFER]: gl => !isWebGL2(gl) ? GL.COLOR_ATTACHMENT0 : undefined,\n\n  // WebGL2 context parameters\n  [GL_FRAGMENT_SHADER_DERIVATIVE_HINT]:\n    gl => !isWebGL2(gl) ? GL_DONT_CARE : undefined,\n\n  [GL.RASTERIZER_DISCARD]: getWebGL2ValueOrZero,\n\n  [GL.SAMPLES]: getWebGL2ValueOrZero,\n\n  // WebGL2 extension context parameters\n  [GL_GPU_DISJOINT_EXT]:\n    (gl, getParameter) => {\n      const ext = isWebGL2(gl) ?\n        gl.getExtension(EXT_disjoint_timer_query_webgl2) :\n        gl.getExtension(EXT_disjoint_timer_query);\n      return ext && ext.GPU_DISJOINT_EXT ? getParameter(ext.GPU_DISJOINT_EXT) : 0;\n    },\n\n  // Extension fixed values\n  [GL_UNMASKED_VENDOR_WEBGL]:\n    (gl, getParameter) => {\n      const ext = gl.getExtension(WEBGL_debug_renderer_info);\n      return getParameter((ext && ext.UNMASKED_VENDOR_WEBGL) || GL.VENDOR);\n    },\n\n  [GL_UNMASKED_RENDERER_WEBGL]:\n    (gl, getParameter) => {\n      const ext = gl.getExtension(WEBGL_debug_renderer_info);\n      return getParameter((ext && ext.UNMASKED_RENDERER_WEBGL) || GL.RENDERER);\n    },\n\n  // Extension LIMITS\n  [GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT]:\n    (gl, getParameter) => {\n      const ext = gl.luma.extensions[EXT_texture_filter_anisotropic];\n      return ext ? getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT) : 1.0;\n    },\n\n  // WebGL2 Limits\n  [GL.MAX_3D_TEXTURE_SIZE]: getWebGL2ValueOrZero,\n  [GL.MAX_ARRAY_TEXTURE_LAYERS]: getWebGL2ValueOrZero,\n  [GL.MAX_CLIENT_WAIT_TIMEOUT_WEBGL]: getWebGL2ValueOrZero,\n  [GL.MAX_COLOR_ATTACHMENTS]:\n    (gl, getParameter) => {\n      if (!isWebGL2(gl)) {\n        const ext = gl.getExtension(WEBGL_draw_buffers);\n        return ext ? getParameter(ext.MAX_COLOR_ATTACHMENTS_WEBGL) : 0;\n      }\n      return undefined;\n    },\n  [GL.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_COMBINED_UNIFORM_BLOCKS]: getWebGL2ValueOrZero,\n  [GL.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_DRAW_BUFFERS]:\n    gl => {\n      if (!isWebGL2(gl)) {\n        const ext = gl.getExtension(WEBGL_draw_buffers);\n        return ext ? ext.MAX_DRAW_BUFFERS_WEBGL : 0;\n      }\n      return undefined;\n    },\n  [GL.MAX_ELEMENT_INDEX]:\n    // Guess: per webglstats.com 99.6% of webgl2 supports 2147483647\n    gl => gl.getExtension(OES_element_index) ? 2147483647 : 65535,\n  [GL.MAX_ELEMENTS_INDICES]:\n    // Guess: \"Reasonably safe\" per webglstats.com - could be higher/lower (on some mobile devices)\n    gl => gl.getExtension(OES_element_index) ? 16777216 : 65535,\n  [GL.MAX_ELEMENTS_VERTICES]:\n    // Guess: \"Reasonably safe\" per webglstats.com - could be higher/lower (on some mobile devices)\n    gl => 16777216,\n  [GL.MAX_FRAGMENT_INPUT_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_FRAGMENT_UNIFORM_BLOCKS]: getWebGL2ValueOrZero,\n  [GL.MAX_FRAGMENT_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_SAMPLES]: getWebGL2ValueOrZero,\n  [GL.MAX_SERVER_WAIT_TIMEOUT]: getWebGL2ValueOrZero,\n  [GL.MAX_TEXTURE_LOD_BIAS]: getWebGL2ValueOrZero,\n  [GL.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS]: getWebGL2ValueOrZero,\n  [GL.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_UNIFORM_BLOCK_SIZE]: getWebGL2ValueOrZero,\n  [GL.MAX_UNIFORM_BUFFER_BINDINGS]: getWebGL2ValueOrZero,\n  [GL.MAX_VARYING_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_VERTEX_OUTPUT_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MAX_VERTEX_UNIFORM_BLOCKS]: getWebGL2ValueOrZero,\n  [GL.MAX_VERTEX_UNIFORM_COMPONENTS]: getWebGL2ValueOrZero,\n  [GL.MIN_PROGRAM_TEXEL_OFFSET]: getWebGL2ValueOrZero,\n  [GL.MAX_PROGRAM_TEXEL_OFFSET]: getWebGL2ValueOrZero,\n  [GL.UNIFORM_BUFFER_OFFSET_ALIGNMENT]: getWebGL2ValueOrZero\n};\n\n// Return true if WebGL2 context\nfunction isWebGL2(gl) {\n  const GL_TEXTURE_BINDING_3D = 0x806A;\n  return gl && gl.TEXTURE_BINDING_3D === GL_TEXTURE_BINDING_3D;\n}\n\n// A \"replacement\" gl.getParameter that accepts \"enums\" from extensions and WebGL2\n// and returns reasonably safe defaults\nexport function getParameterPolyfill(gl, originalGetParameter, pname) {\n\n  // Return mock limits (usually 0) for WebGL2 constants to ensure these\n  // can be queries without error\n  const limit = WEBGL_PARAMETERS[pname];\n  const value = typeof limit === 'function' ? limit(gl, originalGetParameter, pname) : limit;\n  const result = value !== undefined ? value : originalGetParameter(pname);\n  return result;\n}\n"],"file":"polyfill-get-parameter.js"}