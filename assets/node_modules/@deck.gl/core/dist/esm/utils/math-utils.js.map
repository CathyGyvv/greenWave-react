{"version":3,"sources":["../../../src/utils/math-utils.js"],"names":["vec4_multiply","vec4_transformMat4","assert","transformVector","matrix","vector","result","scale","createMat4","extractCameraVectors","viewMatrix","viewMatrixInverse","eye","direction","up","mod","value","divisor","Number","isFinite","modulus"],"mappings":"AAAA;AAEA,OAAOA,aAAP,MAA0B,kBAA1B;AACA,OAAOC,kBAAP,MAA+B,uBAA/B;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AAEA,OAAO,SAASC,eAAT,CAAyBC,MAAzB,EAAiCC,MAAjC,EAAyC;AAC9C;AACA,MAAI,CAACD,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AACD,MAAME,SAASL,mBAAmB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAnB,EAAiCI,MAAjC,EAAyCD,MAAzC,CAAf;AACA,MAAMG,QAAQ,IAAID,OAAO,CAAP,CAAlB;AACAN,gBAAcM,MAAd,EAAsBA,MAAtB,EAA8B,CAACC,KAAD,EAAQA,KAAR,EAAeA,KAAf,EAAsBA,KAAtB,CAA9B;AACA,SAAOD,MAAP;AACD,C,CAED;;AACA,OAAO,SAASE,UAAT,GAAsB;AAC3B,SAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC,EAAwC,CAAxC,EAA2C,CAA3C,EAA8C,CAA9C,CAAP;AACD,C,CAED;;AACA,OAAO,SAASC,oBAAT,OAA+D;AAAA,MAAhCC,UAAgC,QAAhCA,UAAgC;AAAA,MAApBC,iBAAoB,QAApBA,iBAAoB;AACpE;AACA,SAAO;AACLC,SAAK,CAACD,kBAAkB,EAAlB,CAAD,EAAwBA,kBAAkB,EAAlB,CAAxB,EAA+CA,kBAAkB,EAAlB,CAA/C,CADA;AAELE,eAAW,CAACH,WAAW,CAAX,CAAD,EAAgBA,WAAW,CAAX,CAAhB,EAA+BA,WAAW,EAAX,CAA/B,CAFN;AAGLI,QAAI,CAACJ,WAAW,CAAX,CAAD,EAAgBA,WAAW,CAAX,CAAhB,EAA+BA,WAAW,CAAX,CAA/B;AAHC,GAAP;AAKD;AAED,OAAO,SAASK,GAAT,CAAaC,KAAb,EAAoBC,OAApB,EAA6B;AAClCf,SAAOgB,OAAOC,QAAP,CAAgBH,KAAhB,KAA0BE,OAAOC,QAAP,CAAgBF,OAAhB,CAAjC;AACA,MAAMG,UAAUJ,QAAQC,OAAxB;AACA,SAAOG,UAAU,CAAV,GAAcH,UAAUG,OAAxB,GAAkCA,OAAzC;AACD","sourcesContent":["// Extensions to math.gl library. Intended to be folded back.\n\nimport vec4_multiply from 'gl-vec4/multiply';\nimport vec4_transformMat4 from 'gl-vec4/transformMat4';\nimport assert from '../utils/assert';\n\nexport function transformVector(matrix, vector) {\n  // Handle non-invertible matrix\n  if (!matrix) {\n    return null;\n  }\n  const result = vec4_transformMat4([0, 0, 0, 0], vector, matrix);\n  const scale = 1 / result[3];\n  vec4_multiply(result, result, [scale, scale, scale, scale]);\n  return result;\n}\n\n// Helper, avoids low-precision 32 bit matrices from gl-matrix mat4.create()\nexport function createMat4() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\n\n// Extract camera vectors (move to math library?)\nexport function extractCameraVectors({viewMatrix, viewMatrixInverse}) {\n  // Read the translation from the inverse view matrix\n  return {\n    eye: [viewMatrixInverse[12], viewMatrixInverse[13], viewMatrixInverse[14]],\n    direction: [viewMatrix[2], viewMatrix[6], viewMatrix[10]],\n    up: [viewMatrix[1], viewMatrix[5], viewMatrix[9]]\n  };\n}\n\nexport function mod(value, divisor) {\n  assert(Number.isFinite(value) && Number.isFinite(divisor));\n  const modulus = value % divisor;\n  return modulus < 0 ? divisor + modulus : modulus;\n}\n"],"file":"math-utils.js"}