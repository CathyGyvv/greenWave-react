{"version":3,"sources":["../../../src/deprecated/first-person-viewport.js"],"names":["Viewport","log","Matrix4","experimental","SphericalCoordinates","getDirectionFromBearingAndPitch","bearing","pitch","spherical","direction","toVector3","normalize","FirstPersonViewport","constructor","opts","deprecated","modelMatrix","up","dir","center","transformDirection","viewMatrix","lookAt","eye","Object","assign","zoom"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,QAAP,MAAqB,uBAArB;AACA,OAAOC,GAAP,MAAgB,cAAhB;AACA,SAAQC,OAAR,EAAiBC,YAAjB,QAAoC,SAApC;MACOC,oB,GAAwBD,Y,CAAxBC,oB;;AAEP,SAASC,+BAAT,CAAyC;AAACC,SAAD;AAAUC;AAAV,CAAzC,EAA2D;AACzD,QAAMC,YAAY,IAAIJ,oBAAJ,CAAyB;AAACE,WAAD;AAAUC;AAAV,GAAzB,CAAlB;AACA,QAAME,YAAYD,UAAUE,SAAV,GAAsBC,SAAtB,EAAlB;AACA,SAAOF,SAAP;AACD;;AAED,eAAe,MAAMG,mBAAN,SAAkCZ,QAAlC,CAA2C;AACxDa,cAAYC,OAAO,EAAnB,EAAuB;AACrBb,QAAIc,UAAJ,CAAe,qBAAf,EAAsC,iBAAtC,IADqB,CAGrB;;AAHqB,8BASjBD,IATiB,CAMnBE,WANmB;AAAA,UAMnBA,WANmB,kCAML,IANK;AAAA,UAOnBV,OAPmB,GASjBQ,IATiB,CAOnBR,OAPmB;AAAA,qBASjBQ,IATiB,CAQnBG,EARmB;AAAA,UAQnBA,EARmB,yBAQd,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CARc,aAWrB;;AACA,UAAMC,MAAMb,gCAAgC;AAC1CC,aAD0C;AAE1CC,aAAO;AAFmC,KAAhC,CAAZ,CAZqB,CAiBrB;;AACA,UAAMY,SAASH,cAAcA,YAAYI,kBAAZ,CAA+BF,GAA/B,CAAd,GAAoDA,GAAnE,CAlBqB,CAoBrB;;AACA,UAAMG,aAAa,IAAInB,OAAJ,GAAcoB,MAAd,CAAqB;AAACC,WAAK,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAN;AAAiBJ,YAAjB;AAAyBF;AAAzB,KAArB,CAAnB;AAEA,UACEO,OAAOC,MAAP,CAAc,EAAd,EAAkBX,IAAlB,EAAwB;AACtBY,YAAM,IADgB;AACV;AACZL;AAFsB,KAAxB,CADF;AAMD;;AA9BuD","sourcesContent":["// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport Viewport from '../viewports/viewport';\nimport log from '../utils/log';\nimport {Matrix4, experimental} from 'math.gl';\nconst {SphericalCoordinates} = experimental;\n\nfunction getDirectionFromBearingAndPitch({bearing, pitch}) {\n  const spherical = new SphericalCoordinates({bearing, pitch});\n  const direction = spherical.toVector3().normalize();\n  return direction;\n}\n\nexport default class FirstPersonViewport extends Viewport {\n  constructor(opts = {}) {\n    log.deprecated('FirstPersonViewport', 'FirstPersonView')();\n\n    // TODO - push direction handling into Matrix4.lookAt\n    const {\n      // view matrix arguments\n      modelMatrix = null,\n      bearing,\n      up = [0, 0, 1] // Defines up direction, default positive z axis,\n    } = opts;\n\n    // Always calculate direction from bearing and pitch\n    const dir = getDirectionFromBearingAndPitch({\n      bearing,\n      pitch: 89\n    });\n\n    // Direction is relative to model coordinates, of course\n    const center = modelMatrix ? modelMatrix.transformDirection(dir) : dir;\n\n    // Just the direction. All the positioning is done in viewport.js\n    const viewMatrix = new Matrix4().lookAt({eye: [0, 0, 0], center, up});\n\n    super(\n      Object.assign({}, opts, {\n        zoom: null, // triggers meter level zoom\n        viewMatrix\n      })\n    );\n  }\n}\n"],"file":"first-person-viewport.js"}