{"version":3,"sources":["../../../src/transitions/transition-interpolator.js"],"names":["equals","assert","TransitionInterpolator","constructor","opts","Array","isArray","compare","extract","required","_propsToCompare","_propsToExtract","_requiredProps","arePropsEqual","currentProps","nextProps","key","Object","keys","initializeProps","startProps","endProps","result","startViewStateProps","endViewStateProps","start","end","_checkRequiredProps","interpolateProps","t","props","forEach","propName","value","Number","isFinite"],"mappings":"AAAA,SAAQA,MAAR,QAAqB,SAArB;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AAEA,eAAe,MAAMC,sBAAN,CAA6B;AAC1C;;;;;;;AAOAC,cAAYC,OAAO,EAAnB,EAAuB;AACrB,QAAIC,MAAMC,OAAN,CAAcF,IAAd,CAAJ,EAAyB;AACvBA,aAAO;AACLG,iBAASH,IADJ;AAELI,iBAASJ,IAFJ;AAGLK,kBAAUL;AAHL,OAAP;AAKD;;AAPoB,kBAQgBA,IARhB;AAAA,UAQdG,OARc,SAQdA,OARc;AAAA,UAQLC,OARK,SAQLA,OARK;AAAA,UAQIC,QARJ,SAQIA,QARJ;AAUrB,SAAKC,eAAL,GAAuBH,OAAvB;AACA,SAAKI,eAAL,GAAuBH,OAAvB;AACA,SAAKI,cAAL,GAAsBH,QAAtB;AACD;AAED;;;;;;;;AAMAI,gBAAcC,YAAd,EAA4BC,SAA5B,EAAuC;AACrC,SAAK,MAAMC,GAAX,IAAkB,KAAKN,eAAL,IAAwBO,OAAOC,IAAP,CAAYH,SAAZ,CAA1C,EAAkE;AAChE,UAAI,CAACf,OAAOc,aAAaE,GAAb,CAAP,EAA0BD,UAAUC,GAAV,CAA1B,CAAL,EAAgD;AAC9C,eAAO,KAAP;AACD;AACF;;AACD,WAAO,IAAP;AACD;AAED;;;;;;;;;AAOAG,kBAAgBC,UAAhB,EAA4BC,QAA5B,EAAsC;AACpC,QAAIC,MAAJ;;AAEA,QAAI,KAAKX,eAAT,EAA0B;AACxB,YAAMY,sBAAsB,EAA5B;AACA,YAAMC,oBAAoB,EAA1B;;AAEA,WAAK,MAAMR,GAAX,IAAkB,KAAKL,eAAvB,EAAwC;AACtCY,4BAAoBP,GAApB,IAA2BI,WAAWJ,GAAX,CAA3B;AACAQ,0BAAkBR,GAAlB,IAAyBK,SAASL,GAAT,CAAzB;AACD;;AACDM,eAAS;AAACG,eAAOF,mBAAR;AAA6BG,aAAKF;AAAlC,OAAT;AACD,KATD,MASO;AACLF,eAAS;AAACG,eAAOL,UAAR;AAAoBM,aAAKL;AAAzB,OAAT;AACD;;AAED,SAAKM,mBAAL,CAAyBL,OAAOG,KAAhC;;AACA,SAAKE,mBAAL,CAAyBL,OAAOI,GAAhC;;AAEA,WAAOJ,MAAP;AACD;AAED;;;;;;;;;AAOAM,mBAAiBR,UAAjB,EAA6BC,QAA7B,EAAuCQ,CAAvC,EAA0C;AACxC5B,WAAO,KAAP,EAAc,qCAAd;AACD;;AAED0B,sBAAoBG,KAApB,EAA2B;AACzB,QAAI,CAAC,KAAKlB,cAAV,EAA0B;AACxB;AACD;;AAED,SAAKA,cAAL,CAAoBmB,OAApB,CAA4BC,YAAY;AACtC,YAAMC,QAAQH,MAAME,QAAN,CAAd;AACA/B,aACEiC,OAAOC,QAAP,CAAgBF,KAAhB,KAA0B5B,MAAMC,OAAN,CAAc2B,KAAd,CAD5B,EAEG,GAAED,QAAS,6BAFd;AAID,KAND;AAOD;;AA1FyC","sourcesContent":["import {equals} from 'math.gl';\nimport assert from '../utils/assert';\n\nexport default class TransitionInterpolator {\n  /**\n   * @param opts {array|object}\n   * @param opts.compare {array} - prop names used in equality check\n   * @param opts.extract {array} - prop names needed for interpolation\n   * @param opts.required {array} - prop names that must be supplied\n   * alternatively, supply one list of prop names as `opts` if all of the above are the same.\n   */\n  constructor(opts = {}) {\n    if (Array.isArray(opts)) {\n      opts = {\n        compare: opts,\n        extract: opts,\n        required: opts\n      };\n    }\n    const {compare, extract, required} = opts;\n\n    this._propsToCompare = compare;\n    this._propsToExtract = extract;\n    this._requiredProps = required;\n  }\n\n  /**\n   * Checks if two sets of props need transition in between\n   * @param currentProps {object} - a list of viewport props\n   * @param nextProps {object} - a list of viewport props\n   * @returns {bool} - true if two props are equivalent\n   */\n  arePropsEqual(currentProps, nextProps) {\n    for (const key of this._propsToCompare || Object.keys(nextProps)) {\n      if (!equals(currentProps[key], nextProps[key])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Called before transition starts to validate/pre-process start and end props\n   * @param startProps {object} - a list of starting viewport props\n   * @param endProps {object} - a list of target viewport props\n   * @returns {Object} {start, end} - start and end props to be passed\n   *   to `interpolateProps`\n   */\n  initializeProps(startProps, endProps) {\n    let result;\n\n    if (this._propsToExtract) {\n      const startViewStateProps = {};\n      const endViewStateProps = {};\n\n      for (const key of this._propsToExtract) {\n        startViewStateProps[key] = startProps[key];\n        endViewStateProps[key] = endProps[key];\n      }\n      result = {start: startViewStateProps, end: endViewStateProps};\n    } else {\n      result = {start: startProps, end: endProps};\n    }\n\n    this._checkRequiredProps(result.start);\n    this._checkRequiredProps(result.end);\n\n    return result;\n  }\n\n  /**\n   * Returns viewport props in transition\n   * @param startProps {object} - a list of starting viewport props\n   * @param endProps {object} - a list of target viewport props\n   * @param t {number} - a time factor between [0, 1]\n   * @returns {object} - a list of interpolated viewport props\n   */\n  interpolateProps(startProps, endProps, t) {\n    assert(false, 'interpolateProps is not implemented');\n  }\n\n  _checkRequiredProps(props) {\n    if (!this._requiredProps) {\n      return;\n    }\n\n    this._requiredProps.forEach(propName => {\n      const value = props[propName];\n      assert(\n        Number.isFinite(value) || Array.isArray(value),\n        `${propName} is required for transition`\n      );\n    });\n  }\n}\n"],"file":"transition-interpolator.js"}