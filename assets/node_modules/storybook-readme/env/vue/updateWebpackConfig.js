'use strict';

var path = require('path');

var docsLoader = path.resolve(__dirname, 'docs-loader');

module.exports = function (storybookBaseConfig, configType) {
  console.log(storybookBaseConfig.module.rules);

  storybookBaseConfig.module.rules = storybookBaseConfig.module.rules.map(function (rule) {
    if (rule.loader && rule.loader.indexOf('vue-loader') !== -1) {
      return Object.assign({}, rule, {
        options: Object.assign({}, rule.options, {
          loaders: {
            docs: [
            // 'storybook-readme/env/vue/docs-loader',
            docsLoader, 'html-loader', 'markdown-loader']
          }
        })
      });
    }

    return rule;
  });

  return storybookBaseConfig;
};